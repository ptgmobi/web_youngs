var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;import{ad as s,r as o,h as d,c as n,f as r,x as m,g as u,o as b,y as p,t as c,F as h,i as f,q as g}from"./vendor.abf78dba.js";import{g as D}from"./role.852449f4.js";import{g as y,a as V,s as _,b as w}from"./station.90d528dd.js";import{m as v}from"./message.9010e90c.js";import{m as C}from"./self.16b94c1b.js";import{_ as k}from"./index.af8115b7.js";const j={mixins:[C],components:{},data:()=>({options:{role:[],pid:[],base_url:""},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",pid:"",role:[],base_url:""},choiceData:{}}}),computed:((e,s)=>{for(var o in s||(s={}))t.call(s,o)&&l(e,o,s[o]);if(a)for(var o of a(s))i.call(s,o)&&l(e,o,s[o]);return e})({},s(["element"])),created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await D();this.options.role=e},async getList(){const{data:e}=await y();this.data=e,this.list=e,this.options.pid=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:a}=await V(this.busData.item.id);this.busData.item.id=a.position.id,this.busData.item.name=a.position.name,this.busData.item.pid=a.position.pid.toString(),this.busData.item.role=a.position_role,this.dialogVisible=!0;const t=new Date;this.date=t.getTime()},handleDelete(e){},roleChangeChoice(e,a){this.busData.choiceData[e]=a},clearBusData(){this.busData={item:{id:"",name:"",pid:"",role:[]},choiceData:{}}},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,pid:this.busData.item.pid,role_id:this.busData.item.role},a=await _(e);a&&v(a),this.getList()}if("edit"===this.dialogType){const e={id:this.busData.item.id,name:this.busData.item.name,role_id:this.busData.item.role},a=await w(this.busData.item.id,e);a&&v(a)}this.clearBusData(),this.dialogVisible=!1}}},T={class:"app-container"},E=p("新建"),A=p("修改"),O=p("删除"),P={slot:"footer",class:"dialog-footer"},x=p("取 消"),F=p("确 定");var S=k(j,[["render",function(e,a,t,i,l,s){const D=o("el-button"),y=o("el-table-column"),V=o("el-table"),_=o("el-input"),w=o("el-form-item"),v=o("el-option"),C=o("el-select"),k=o("el-form"),j=o("el-dialog");return b(),d("div",T,[e.judgePermissionElementFn("A-AS-ADD-V")?(b(),n(D,{key:0,type:"primary",onClick:s.handleCreate},{default:r((()=>[E])),_:1},8,["onClick"])):m("v-if",!0),u(V,{data:l.list,style:{width:"100%","margin-top":"30px"},border:""},{default:r((()=>[u(y,{align:"center",label:"ID"},{default:r((e=>[p(c(e.row.id),1)])),_:1}),u(y,{align:"center",label:"Name"},{default:r((e=>[p(c(e.row.name),1)])),_:1}),u(y,{align:"center",label:"Operations"},{default:r((a=>[e.judgePermissionElementFn("A-AS-EDIT-V")?(b(),n(D,{key:0,type:"primary",size:"small",onClick:e=>s.handleEdit(a)},{default:r((()=>[A])),_:2},1032,["onClick"])):m("v-if",!0),e.judgePermissionElementFn("A-AS-DEL-V")?(b(),n(D,{key:1,type:"danger",size:"small",onClick:e=>s.handleDelete(a)},{default:r((()=>[O])),_:2},1032,["onClick"])):m("v-if",!0)])),_:1})])),_:1},8,["data"]),u(j,{modelValue:l.dialogVisible,"onUpdate:modelValue":a[4]||(a[4]=e=>l.dialogVisible=e),title:"edit"===l.dialogType?"Edit Role":"New Role",width:"90%"},{default:r((()=>[u(k,{"label-width":"150px","label-position":"left"},{default:r((()=>[u(w,{label:"Name"},{default:r((()=>[u(_,{modelValue:l.busData.item.name,"onUpdate:modelValue":a[0]||(a[0]=e=>l.busData.item.name=e),disabled:"edit"===l.dialogType,placeholder:""},null,8,["modelValue","disabled"])])),_:1}),u(w,{label:"PID"},{default:r((()=>[u(C,{modelValue:l.busData.item.pid,"onUpdate:modelValue":a[1]||(a[1]=e=>l.busData.item.pid=e),disabled:"edit"===l.dialogType,filterable:"",class:"w100",placeholder:"请选择"},{default:r((()=>[(b(!0),d(h,null,f(l.options.pid,(e=>(b(),n(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),u(w,{label:"Role"},{default:r((()=>[u(C,{modelValue:l.busData.item.role,"onUpdate:modelValue":a[2]||(a[2]=e=>l.busData.item.role=e),filterable:"",multiple:"",class:"w100",placeholder:"支持多选"},{default:r((()=>[(b(!0),d(h,null,f(l.options.role,(e=>(b(),n(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),g("div",P,[u(D,{onClick:a[3]||(a[3]=e=>l.dialogVisible=!1)},{default:r((()=>[x])),_:1}),u(D,{type:"primary",onClick:s.submitFn},{default:r((()=>[F])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{S as default};
