var e=Object.defineProperty,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(a,i,t)=>i in a?e(a,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[i]=t;import{ac as l,r as o,h as n,c as d,f as m,x as r,g as p,o as u,y as b,t as c,F as h,i as f,q as g}from"./vendor.107e8656.js";import{g as y}from"./power.9c21cd68.js";import{g as D,a as w,s as V,b as _}from"./role.d00ea24b.js";import{m as C}from"./message.96b00d49.js";import{m as j}from"./self.e8057f1b.js";import{_ as k}from"./index.783b7d78.js";const v={mixins:[j],components:{},data:()=>({options:{permissions:[]},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",permissions:[]},choiceData:{}}}),computed:((e,l)=>{for(var o in l||(l={}))i.call(l,o)&&s(e,o,l[o]);if(a)for(var o of a(l))t.call(l,o)&&s(e,o,l[o]);return e})({},l(["element"])),created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await y();this.options.permissions=e.permission},async getList(){const{data:e}=await D();this.data=e,this.list=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.busData.item.name="",this.busData.item.permissions=[],this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:a}=await w(this.busData.item.id);this.busData.item.name=a.role.name,this.busData.item.permissions=a.role_permission,this.dialogVisible=!0;const i=new Date;this.date=i.getTime()},handleDelete(e){},roleChangeChoice(e,a){this.busData.choiceData[e]=a},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,permission_id:this.busData.item.permissions},a=await V(e);a&&C(a),this.getList()}if("edit"===this.dialogType){const e={role_id:this.busData.item.id,permission_id:this.busData.item.permissions},a=await _(this.busData.item.id,e);a&&C(a)}this.dialogVisible=!1}}},T={class:"app-container"},E=b("新建"),A=b("修改"),O=b("删除"),P={slot:"footer",class:"dialog-footer"},x=b("取 消"),F=b("确 定");var R=k(v,[["render",function(e,a,i,t,s,l){const y=o("el-button"),D=o("el-table-column"),w=o("el-table"),V=o("el-input"),_=o("el-form-item"),C=o("el-option"),j=o("el-select"),k=o("el-form"),v=o("el-dialog");return u(),n("div",T,[e.judgePermissionElementFn("A-AR-ADD-V")?(u(),d(y,{key:0,type:"primary",onClick:l.handleCreate},{default:m((()=>[E])),_:1},8,["onClick"])):r("v-if",!0),p(w,{data:s.list,style:{width:"100%","margin-top":"30px"},border:""},{default:m((()=>[p(D,{align:"center",label:"ID"},{default:m((e=>[b(c(e.row.id),1)])),_:1}),p(D,{align:"center",label:"Name"},{default:m((e=>[b(c(e.row.name),1)])),_:1}),p(D,{align:"center",label:"Operations"},{default:m((a=>[e.judgePermissionElementFn("A-AR-EDIT-V")?(u(),d(y,{key:0,type:"primary",size:"small",onClick:e=>l.handleEdit(a)},{default:m((()=>[A])),_:2},1032,["onClick"])):r("v-if",!0),e.judgePermissionElementFn("A-AR-DEL-V")?(u(),d(y,{key:1,type:"danger",size:"small",onClick:e=>l.handleDelete(a)},{default:m((()=>[O])),_:2},1032,["onClick"])):r("v-if",!0)])),_:1})])),_:1},8,["data"]),p(v,{modelValue:s.dialogVisible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.dialogVisible=e),title:"edit"===s.dialogType?"Edit Role":"New Role",width:"90%"},{default:m((()=>[p(k,{"label-width":"150px","label-position":"left"},{default:m((()=>[p(_,{label:"Name"},{default:m((()=>[p(V,{modelValue:s.busData.item.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.busData.item.name=e),placeholder:"",disabled:"edit"===s.dialogType},null,8,["modelValue","disabled"])])),_:1}),p(_,{label:"Permissions"},{default:m((()=>[p(j,{modelValue:s.busData.item.permissions,"onUpdate:modelValue":a[1]||(a[1]=e=>s.busData.item.permissions=e),filterable:"",multiple:"",clearable:"",class:"w100",placeholder:"支持多选"},{default:m((()=>[(u(!0),n(h,null,f(s.options.permissions,(e=>(u(),d(C,{key:e.id,label:e.type,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),g("div",P,[p(y,{onClick:a[2]||(a[2]=e=>s.dialogVisible=!1)},{default:m((()=>[x])),_:1}),p(y,{type:"primary",onClick:l.submitFn},{default:m((()=>[F])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{R as default};
