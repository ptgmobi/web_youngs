import{d as e,z as l,a,w as r,r as t,o,h as u,q as i,g as n,f as s,F as d,i as c,c as p,u as m,x as f,y as v,N as _,b,s as g,ah as h,P as V,t as y,k}from"./vendor.abf78dba.js";import{_ as F}from"./lodash.6df001c0.js";import{g as w,h as x,i as U,j as P}from"./fenix.bfcebe73.js";import{c as C}from"./clipboard.3b8c759c.js";import"./index.1b5e8f51.js";const j={class:"flex jc-end"},q=v("Add"),S={class:"flex"},A=v("Copy"),T=e({props:{list:{require:!0,default:[],type:Array}},emits:["kk","up"],setup(e,{emit:v}){const _=e,b=l({pub:[]});let g=a(_.list);const h={pub:"",slotid:"",payout:void 0,cap_daily:void 0,pub_status:2,pub_tracking_link:""},V=()=>{g.value.push(F.cloneDeep(h))};r((()=>g.value),((e,l)=>{v("kk",e)}),{immediate:!0,deep:!0});return(e,l)=>{const a=t("el-button"),r=t("el-option"),v=t("el-select"),_=t("el-table-column"),h=t("el-input"),y=t("el-switch"),k=t("el-table");return o(),u("div",null,[i("div",j,[n(a,{type:"primary",onClick:V},{default:s((()=>[q])),_:1})]),n(k,{class:"mt-10",data:m(g),style:{width:"100%"},border:""},{default:s((()=>[n(_,{label:"Pub Name",align:"center"},{default:s((e=>[n(v,{filterable:"",modelValue:e.row.pub,"onUpdate:modelValue":l=>e.row.pub=l,onChange:l=>(e=>{const{row:l}=e;l.pub_tracking_link="http://track.adsforward.com/api/track?offer=6011690&mid=95108831&pub_id={siteid}&gaid={gaid}&idfa={idfa}&click_id={clickid}&ip={ip}&ua={ua}&osv={osv}&lang={lang}"})(e),clearable:"",placeholder:""},{default:s((()=>[(o(!0),u(d,null,c(m(b).pub,(e=>(o(),p(r,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),n(_,{label:"Payout",align:"center"},{default:s((e=>[n(h,{modelValue:e.row.payout,"onUpdate:modelValue":l=>e.row.payout=l,type:"number",min:"0",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),n(_,{label:"Cap Daily",align:"center"},{default:s((e=>[n(h,{modelValue:e.row.cap_daily,"onUpdate:modelValue":l=>e.row.cap_daily=l,type:"number",min:"0",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),n(_,{label:"Operation",align:"center",width:"180px"},{default:s((e=>[i("div",S,[n(a,{class:"mr-10",type:"danger",icon:"Delete",circle:"",onClick:l=>(e=>{const l=e.$index;g.value.splice(l,1)})(e)},null,8,["onClick"]),n(y,{modelValue:e.row.status,"onUpdate:modelValue":l=>e.row.status=l,"active-value":1,"inactive-value":2,class:"mr-10",onChange:e=>{}},null,8,["modelValue","onUpdate:modelValue","onChange"]),e.row.pub_tracking_link?(o(),p(a,{key:0,class:"cp",type:"primary",onClick:l=>(({row:e})=>{const{pub_tracking_link:l}=e;C(l)})(e)},{default:s((()=>[A])),_:2},1032,["onClick"])):f("v-if",!0)])])),_:1})])),_:1},8,["data"])])}}}),O={class:"content-con flex column"},D={class:"flex jc-start ai-center form-one"},R=["textContent"],L={class:"flex jc-start ai-center form-one"},N=v("BUZZ"),E=v("SDK"),K={class:"flex jc-start ai-center form-one"},M={key:0},B={key:1},I={class:"flex jc-start ai-center form-one"},Z={class:"flex jc-start ai-center form-one"},$={class:"flex jc-start ai-center form-one"},z={class:"flex jc-start ai-center form-one"},G={class:"flex jc-start ai-center form-one"},H={class:"form-one"},J={class:"flex jc-start ai-center form-one"},Q={class:"flex jc-start ai-center form-one"},W={class:"flex jc-start ai-center form-one"},X={class:"flex jc-start ai-center form-one"},Y={class:"flex jc-start ai-center form-one"},ee={class:"flex jc-start ai-center form-one"},le={class:"flex jc-start ai-center form-one"},ae={class:"w100 flex"},re=v("Save"),te=e({setup(e){const v=_(),{proxy:C}=k(),j="此项必填";let q=a(!1);const S=l({options:{channel:[],country:["a","b","c"],conversion_flow:[{value:"cpi",label:"CPI"},{value:"cpa",label:"CPA"}],platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],site_type:[{value:"rule_sdkcvrlist",label:"匹配SDK CVR"},{value:"rule_pubredirect",label:"透传渠道ID"},{value:"rule_slotid",label:"渠道slotid"},{value:"rule_value",label:"固定值"}],attribute_provider:[{value:"appsflyer",label:"AppsFlyer"},{value:"branch",label:"Branch"},{value:"adjust",label:"Adjust"},{value:"singular",label:"Singular"},{value:"appmetrica",label:"AppMetrica"}]},rules:{no_required:[{required:!1}],channel:[{required:!0,message:j,trigger:["blur","change"]}],channel_type:[{required:!0,message:j,trigger:["blur","change"]}],status:[{required:!0,message:j,trigger:["blur","change"]}],title:[{required:!0,message:j,trigger:["blur","change"]}],pkg:[{required:!0,message:j,trigger:["blur","change"]}],platform:[{required:!0,message:j,trigger:["blur","change"]}],country:[{required:!0,message:j,trigger:["blur","change"]},{validator:(e,l,a)=>{0!==l.length?l.length>1?a(new Error("只能填选一个国家")):a(void 0):a(new Error(j))},trigger:["blur","change"]}],revenue:[{required:!0,message:j,trigger:["blur","change"]}],traffic:[{required:!1,validator:(e,l,a)=>{0!==l.length&&((e=>{let l=!0;return e.map((e=>{for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)){const r=e[a];if(""===r||void 0===r){l=!1;break}}})),l})(l)?a(void 0):a(new Error("不允许有空值")))},trigger:["blur","change"]}],adv_tracking_link:[{required:!0,message:j,trigger:["blur","change"]}],site_type:[{required:!0,message:j,trigger:["blur","change"]}],site_value:[{required:!0,message:j,trigger:["blur","change"]}],is_s2s:[{required:!0,message:j,trigger:["blur","change"]}],s2s_tracking_link:[{required:!0,message:j,trigger:["blur","change"]}],app_url:[{required:!0,message:j,trigger:["blur","change"]}]},ruleForm:{id:void 0,offer:void 0,adv_offer:"",create_type:1,channel:"",channel_type:1,adv_status:1,conversion_flow:"",status:1,title:"",pkg:"",attribute_provider:"",pid:"",platform:1,country:[],revenue:void 0,traffic:[],adtype:38,update_date:"",adv_tracking_link:"",target_cvr:"",cvr_status:2,is_s2s:2,s2s_tracking_link:"",app_url:"",site_type:"rule_value",site_value:"",description:""}});let A=a(""),te=a("");const oe=()=>{C.$refs.ruleForm.validate((e=>{if(!e)return!1}))},ue=async()=>{const e=await w();if(200===e.code){const{offer_id:l}=e;S.ruleForm.offer=l}else ue()};b((()=>{A.value=v.currentRoute.value.name,"fenix-offer-create"===A.value&&ue(),"fenix-offer-edit"===A.value&&(te.value=v.currentRoute.value.params.id)}));const ie=g((()=>"rule_value"===S.ruleForm.site_type));r((()=>S.ruleForm.traffic),((e,l)=>{}),{immediate:!0,deep:!0});const ne=e=>(S.ruleForm.traffic=F.cloneDeep(e),!0),se=async()=>{await x();const e=S.ruleForm.adv_offer;e&&e.includes("_")?await U():await P(),S.ruleForm.country=["a","c"]};return(e,l)=>{const a=t("el-form-item"),r=t("el-button"),v=t("el-input"),_=t("el-option"),b=t("el-select"),g=t("el-radio"),k=t("el-radio-group"),F=t("el-switch"),w=t("el-form"),x=h("loading");return V((o(),u("div",null,[f(" form "),n(w,{enctype:"multipart/form-data",ref:(e,l)=>{l.ruleForm=e},rules:m(S).rules,model:m(S).ruleForm,"label-width":"240px","label-position":"right"},{default:s((()=>[i("div",O,[f(" Offer "),n(a,{label:"Offer:",prop:"offer"},{default:s((()=>[i("div",D,[i("span",{textContent:y(m(S).ruleForm.offer)},null,8,R)])])),_:1}),f(" Adv Offer "),n(a,{label:"Adv Offer:",prop:"adv_offer"},{default:s((()=>[i("div",L,[n(v,{modelValue:m(S).ruleForm.adv_offer,"onUpdate:modelValue":l[0]||(l[0]=e=>m(S).ruleForm.adv_offer=e),placeholder:"Please input",class:"input-with-select"},{append:s((()=>[n(r,{type:"primary",icon:"Search",onClick:se})])),_:1},8,["modelValue"])])])),_:1}),f(" Channel "),n(a,{label:"Channel:",prop:"channel"},{default:s((()=>[n(b,{filterable:"",class:"form-one",modelValue:m(S).ruleForm.channel,"onUpdate:modelValue":l[1]||(l[1]=e=>m(S).ruleForm.channel=e),clearable:"",placeholder:""},{default:s((()=>[(o(!0),u(d,null,c(m(S).options.channel,(e=>(o(),p(_,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" Channel Type "),n(a,{label:"Channel Type:",prop:"channel_type"},{default:s((()=>[n(k,{class:"form-one",modelValue:m(S).ruleForm.channel_type,"onUpdate:modelValue":l[2]||(l[2]=e=>m(S).ruleForm.channel_type=e)},{default:s((()=>[n(g,{label:1},{default:s((()=>[N])),_:1}),n(g,{label:2},{default:s((()=>[E])),_:1})])),_:1},8,["modelValue"])])),_:1}),f(" Adv Status "),n(a,{label:"Adv Status:",prop:"adv_status"},{default:s((()=>[i("div",K,[1===m(S).ruleForm.adv_status?(o(),u("span",M,"开")):f("v-if",!0),2===m(S).ruleForm.adv_status?(o(),u("span",B,"关")):f("v-if",!0)])])),_:1}),f(" conversion_flow "),n(a,{label:"Conversion Flow:",prop:"conversion_flow"},{default:s((()=>[n(b,{filterable:"",class:"form-one",modelValue:m(S).ruleForm.conversion_flow,"onUpdate:modelValue":l[3]||(l[3]=e=>m(S).ruleForm.conversion_flow=e),clearable:"",placeholder:""},{default:s((()=>[(o(!0),u(d,null,c(m(S).options.conversion_flow,(e=>(o(),p(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" Status "),n(a,{label:"Status:",prop:"status"},{default:s((()=>[i("div",I,[n(F,{modelValue:m(S).ruleForm.status,"onUpdate:modelValue":l[4]||(l[4]=e=>m(S).ruleForm.status=e),"active-value":1,"inactive-value":2},null,8,["modelValue"])])])),_:1}),f(" Offer Title "),n(a,{label:"Offer Title:",prop:"title"},{default:s((()=>[i("div",Z,[n(v,{modelValue:m(S).ruleForm.title,"onUpdate:modelValue":l[5]||(l[5]=e=>m(S).ruleForm.title=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),f(" Package Name "),n(a,{label:"Package Name:",prop:"pkg"},{default:s((()=>[i("div",$,[n(v,{modelValue:m(S).ruleForm.pkg,"onUpdate:modelValue":l[6]||(l[6]=e=>m(S).ruleForm.pkg=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),f(" Attribute Provider "),n(a,{label:"Attribute Provider:",prop:"attribute_provider"},{default:s((()=>[n(b,{filterable:"",class:"form-one",modelValue:m(S).ruleForm.attribute_provider,"onUpdate:modelValue":l[7]||(l[7]=e=>m(S).ruleForm.attribute_provider=e),clearable:"",placeholder:""},{default:s((()=>[(o(!0),u(d,null,c(m(S).options.attribute_provider,(e=>(o(),p(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" Pid "),n(a,{label:"Pid:",prop:"pid"},{default:s((()=>[i("div",z,[n(v,{modelValue:m(S).ruleForm.pid,"onUpdate:modelValue":l[8]||(l[8]=e=>m(S).ruleForm.pid=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),f(" Platform "),n(a,{label:"Platform:",prop:"platform"},{default:s((()=>[n(b,{filterable:"",class:"form-one",modelValue:m(S).ruleForm.platform,"onUpdate:modelValue":l[9]||(l[9]=e=>m(S).ruleForm.platform=e),clearable:"",placeholder:""},{default:s((()=>[(o(!0),u(d,null,c(m(S).options.platform,(e=>(o(),p(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" Country "),n(a,{label:"Country:",prop:"country"},{default:s((()=>[n(b,{filterable:"",class:"form-one",modelValue:m(S).ruleForm.country,"onUpdate:modelValue":l[10]||(l[10]=e=>m(S).ruleForm.country=e),multiple:"",clearable:"",placeholder:""},{default:s((()=>[(o(!0),u(d,null,c(m(S).options.country,(e=>(o(),p(_,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" Revenue "),n(a,{label:"Revenue:",prop:"revenue"},{default:s((()=>[i("div",G,[n(v,{modelValue:m(S).ruleForm.revenue,"onUpdate:modelValue":l[11]||(l[11]=e=>m(S).ruleForm.revenue=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),f(" Manage Traffic "),n(a,{label:"Manage Traffic:",prop:"traffic"},{default:s((()=>[i("div",H,[n(m(T),{list:m(S).ruleForm.traffic,onKk:ne},null,8,["list"])])])),_:1}),f(" Adv Tracking Link "),n(a,{label:"Adv Tracking Link:",prop:"adv_tracking_link"},{default:s((()=>[i("div",J,[n(v,{rows:2,type:"textarea",modelValue:m(S).ruleForm.adv_tracking_link,"onUpdate:modelValue":l[12]||(l[12]=e=>m(S).ruleForm.adv_tracking_link=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),f(" Target CVR "),n(a,{label:"Target CVR:",prop:"target_cvr"},{default:s((()=>[i("div",Q,[n(v,{modelValue:m(S).ruleForm.target_cvr,"onUpdate:modelValue":l[13]||(l[13]=e=>m(S).ruleForm.target_cvr=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),f(" Site Type "),n(a,{label:"Site Type:",prop:"site_type"},{default:s((()=>[n(b,{filterable:"",class:"form-one",modelValue:m(S).ruleForm.site_type,"onUpdate:modelValue":l[14]||(l[14]=e=>m(S).ruleForm.site_type=e),clearable:"",placeholder:""},{default:s((()=>[(o(!0),u(d,null,c(m(S).options.site_type,(e=>(o(),p(_,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" Site Value "),n(a,{label:"Site Value:",prop:"site_value",rules:m(ie)?m(S).rules.site_value:m(S).rules.no_required},{default:s((()=>[i("div",W,[n(v,{modelValue:m(S).ruleForm.site_value,"onUpdate:modelValue":l[15]||(l[15]=e=>m(S).ruleForm.site_value=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1},8,["rules"]),f(" S2S Async "),n(a,{label:"S2S Async:",prop:"is_s2s"},{default:s((()=>[i("div",X,[n(F,{modelValue:m(S).ruleForm.is_s2s,"onUpdate:modelValue":l[16]||(l[16]=e=>m(S).ruleForm.is_s2s=e),"active-value":1,"inactive-value":2},null,8,["modelValue"])])])),_:1}),f(" S2S Tracking Link "),n(a,{label:"S2S Tracking Link:",prop:"s2s_tracking_link",rules:1===m(S).ruleForm.is_s2s?m(S).rules.s2s_tracking_link:m(S).rules.no_required},{default:s((()=>[i("div",Y,[n(v,{rows:2,type:"textarea",modelValue:m(S).ruleForm.s2s_tracking_link,"onUpdate:modelValue":l[17]||(l[17]=e=>m(S).ruleForm.s2s_tracking_link=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1},8,["rules"]),f(" Preview URL "),n(a,{label:"Preview URL:",prop:"app_url",rules:1===m(S).ruleForm.is_s2s?m(S).rules.app_url:m(S).rules.no_required},{default:s((()=>[i("div",ee,[n(v,{rows:2,type:"textarea",modelValue:m(S).ruleForm.app_url,"onUpdate:modelValue":l[18]||(l[18]=e=>m(S).ruleForm.app_url=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1},8,["rules"]),f(" Description "),n(a,{label:"Description:",prop:"description"},{default:s((()=>[i("div",le,[n(v,{rows:2,type:"textarea",modelValue:m(S).ruleForm.description,"onUpdate:modelValue":l[19]||(l[19]=e=>m(S).ruleForm.description=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),f(" end ")])])),_:1},8,["rules","model"]),f(" form "),f(" footer "),i("div",ae,[n(r,{type:"primary",onClick:oe},{default:s((()=>[re])),_:1})])],512)),[[x,m(q)]])}}});export{te as default};
