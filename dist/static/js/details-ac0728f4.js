import{_ as e,d as l,h as a,r as o,L as r,q as t,c as s,z as d,e as u,s as m,v as i,x as n,P as p,o as f,N as c,O as v,A as _,f as y,y as b,g as F}from"./main-ce43ffdd.js";import{s as g}from"./setting-3cff26af.js";import{b as V,c as h,d as x}from"./dsp-audience-manage-e845978e.js";import{A as j}from"./dsp-advertiser-ecff19f5.js";import{m as U}from"./message-1c1d9ef1.js";import{_ as w}from"./index-aa162cf4.js";import{u as k}from"./useUtils-d1805f03.js";import{d as C,e as q,i as M}from"./new-format-368dcfb0.js";import{_ as A}from"./lodash-6b3789ad.js";const D={class:"content-con from-one flex column"},L={class:"content-con from-one flex column"},N={class:"w100 flex"};var P=e(l({__name:"details",setup(e){const{adv_type:l,audience_manage_type:P}=g,{getRouterData:z,getCommonCountryList:I,goNewUrl:O}=k();let{proxy:R}=F();a(""),a(""),a(!1);let S=a("create");a([]),a([]),a([]),a([]);const $={id:void 0,name:"",adv_id:"",descs:"",adv_type:void 0,country:[],type:1,build_status:void 0,num_people:void 0,is_del:void 0},B=o({ruleForm:$,rules:{name:[{required:!0,message:"此项必填",trigger:["blur","change"]}]},options:{country:[{value:"",label:"",id:""}],advertiser:[{adv_id:"",name:""}],adv_type:l,audience_manage_type:P}}),E=()=>{R.$refs.ruleForm.validate((e=>{if(!e)return!1;J()}))},G=["id","adv_type","type","build_status","num_people"],H=["country"],J=async()=>{let e=p(B.ruleForm);if(e=C(e),e=q(e,G),e=M(e,H),S.value,"create"===S.value){delete e.id;const l=await V(e);U(l)&&K()}if("edit"===S.value){const l=await h(e);U(l)&&K()}},K=()=>{O({url:"/audienceManage/list"})},Q=()=>{var e,l;let{query:a,params:o}=z();if(S.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",S.value,(async()=>{Promise.all([I(),j({limit:1e4,page:1})]).then((e=>{let l=e[0];B.options.country=l;let a=e[1];B.options.advertiser=a.data.data}))})(),"create"===S.value&&(B.ruleForm=A.cloneDeep($)),"edit"===S.value){const{id:e}=o;(async(e,l)=>{const a=await x(e),{data:o}=a;o.country=o.country?o.country.split(","):[],B.ruleForm={...B.ruleForm,...o},B.ruleForm})(e)}};return r((()=>{Q()})),(e,l)=>{const a=t("el-input"),o=t("el-form-item"),r=t("el-option"),p=t("el-select"),F=t("el-radio"),g=t("el-radio-group"),V=t("el-form"),h=t("el-button");return f(),s("div",null,[d(" form "),u(V,{ref:"ruleForm",enctype:"multipart/form-data",rules:i(B).rules,model:i(B).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===i(S)&&2===i(B).ruleForm.is_del},{default:m((()=>[u(i(w),{title:"基础信息"}),n("div",D,[d(" 受众包名称 "),u(o,{class:"self-el-form-item",label:"受众包名称:",prop:"name"},{default:m((()=>[u(a,{modelValue:i(B).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>i(B).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),d(" 所属广告主 "),u(o,{class:"self-el-form-item",label:"广告主名称:",prop:"adv_name"},{default:m((()=>[u(p,{modelValue:i(B).ruleForm.adv_id,"onUpdate:modelValue":l[1]||(l[1]=e=>i(B).ruleForm.adv_id=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:m((()=>[(f(!0),s(c,null,v(i(B).options.advertiser,(e=>(f(),_(r,{key:e.adv_id,label:e.name,value:e.adv_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(" 描述 "),u(o,{class:"self-el-form-item",label:"描述:",prop:"descs"},{default:m((()=>[u(a,{modelValue:i(B).ruleForm.descs,"onUpdate:modelValue":l[2]||(l[2]=e=>i(B).ruleForm.descs=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),u(i(w),{title:"数据源"}),n("div",L,[d(" 广告主类型 "),u(o,{class:"self-el-form-item",label:"广告主名称:",prop:"adv_type"},{default:m((()=>[u(p,{modelValue:i(B).ruleForm.adv_type,"onUpdate:modelValue":l[3]||(l[3]=e=>i(B).ruleForm.adv_type=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:m((()=>[(f(!0),s(c,null,v(i(B).options.adv_type,(e=>(f(),_(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(" 国家 "),u(o,{label:"受众所在国家/地区",prop:"country",class:"self-el-form-item"},{default:m((()=>[u(p,{modelValue:i(B).ruleForm.country,"onUpdate:modelValue":l[4]||(l[4]=e=>i(B).ruleForm.country=e),filterable:"",clearable:"",placeholder:"",multiple:"",class:"form-one"},{default:m((()=>[(f(!0),s(c,null,v(i(B).options.country,(e=>(f(),_(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),d(" 受众包类型 "),u(o,{class:"self-el-form-item",label:"受众包类型:",prop:"type"},{default:m((()=>[u(g,{class:"form-one",modelValue:i(B).ruleForm.type,"onUpdate:modelValue":l[5]||(l[5]=e=>i(B).ruleForm.type=e)},{default:m((()=>[(f(!0),s(c,null,v(i(B).options.audience_manage_type,(e=>(f(),_(F,{label:e.value},{default:m((()=>[y(b(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),d(" form "),d(" footer "),n("div",N,[u(h,{type:"primary",onClick:E},{default:m((()=>[y(" 确认 ")])),_:1}),u(h,{type:"primary",onClick:K},{default:m((()=>[y(" 取消 ")])),_:1})])])}}}),[["__scopeId","data-v-17f66465"]]);export{P as default};
