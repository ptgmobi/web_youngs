var A=Object.defineProperty;var D=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var y=(t,e,s)=>e in t?A(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,V=(t,e)=>{for(var s in e||(e={}))B.call(e,s)&&y(t,s,e[s]);if(D)for(var s of D(e))S.call(e,s)&&y(t,s,e[s]);return t};import{af as N,r as n,i as _,c as r,f as i,g as f,v as o,o as d,x as u,t as w,F as C,j as k,s as L}from"./vendor-a4cb0bb5.js";import{g as P}from"./role-a21db74b.js";import{g as R,a as U,s as I,b as z}from"./station-92b95c47.js";import{m as v}from"./message-67f5983c.js";import{m as G}from"./self-26d919d8.js";import{_ as O}from"./index-a38da525.js";const q={mixins:[G],components:{},data(){return{options:{role:[],pid:[],base_url:""},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",pid:"",role:[],base_url:""},choiceData:{}}}},computed:V({},N(["element"])),created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:t}=await P();this.options.role=t},async getList(){const{data:t}=await R();this.data=t,this.list=t,this.options.pid=t},handleCreate(){this.dialogType="new",this.busData.item.type="",this.dialogVisible=!0;const t=new Date;this.date=t.getTime()},async handleEdit(t){this.dialogType="edit",this.busData.item.id=t.row.id;const{data:e}=await U(this.busData.item.id);console.log(e.position),this.busData.item.id=e.position.id,this.busData.item.name=e.position.name,e.position.pid&&(this.busData.item.pid=e.position.pid.toString()),this.busData.item.role=e.position_role,this.dialogVisible=!0;const s=new Date;this.date=s.getTime()},handleDelete(t){},roleChangeChoice(t,e){this.busData.choiceData[t]=e},clearBusData(){const t={item:{id:"",name:"",pid:"",role:[]},choiceData:{}};this.busData=t},async submitFn(){if(this.dialogType==="new"){const t={name:this.busData.item.name,pid:this.busData.item.pid,role_id:this.busData.item.role},e=await I(t);e&&v(e),this.getList()}if(this.dialogType==="edit"){const t={id:this.busData.item.id,name:this.busData.item.name,role_id:this.busData.item.role},e=await z(this.busData.item.id,t);e&&v(e)}this.clearBusData(),this.dialogVisible=!1}}},H={class:"app-container"},J=u("\u65B0\u5EFA"),K=u(" \u4FEE\u6539 "),M=u(" \u5220\u9664 "),Q={slot:"footer",class:"dialog-footer"},W=u("\u53D6 \u6D88"),X=u("\u786E \u5B9A");function Y(t,e,s,Z,l,p){const m=n("el-button"),c=n("el-table-column"),E=n("el-table"),j=n("el-input"),b=n("el-form-item"),h=n("el-option"),g=n("el-select"),F=n("el-form"),T=n("el-dialog");return d(),_("div",H,[t.judgePermissionElementFn("A-AS-ADD-V")?(d(),r(m,{key:0,type:"primary",onClick:p.handleCreate},{default:i(()=>[J]),_:1},8,["onClick"])):f("v-if",!0),o(E,{data:l.list,style:{width:"100%","margin-top":"30px"},border:""},{default:i(()=>[o(c,{align:"center",label:"ID"},{default:i(a=>[u(w(a.row.id),1)]),_:1}),o(c,{align:"center",label:"Name"},{default:i(a=>[u(w(a.row.name),1)]),_:1}),o(c,{align:"center",label:"Operations"},{default:i(a=>[t.judgePermissionElementFn("A-AS-EDIT-V")?(d(),r(m,{key:0,type:"primary",size:"small",onClick:x=>p.handleEdit(a)},{default:i(()=>[K]),_:2},1032,["onClick"])):f("v-if",!0),t.judgePermissionElementFn("A-AS-DEL-V")?(d(),r(m,{key:1,type:"danger",size:"small",onClick:x=>p.handleDelete(a)},{default:i(()=>[M]),_:2},1032,["onClick"])):f("v-if",!0)]),_:1})]),_:1},8,["data"]),o(T,{modelValue:l.dialogVisible,"onUpdate:modelValue":e[4]||(e[4]=a=>l.dialogVisible=a),title:l.dialogType==="edit"?"Edit Role":"New Role",width:"90%"},{default:i(()=>[o(F,{"label-width":"150px","label-position":"left"},{default:i(()=>[o(b,{label:"Name"},{default:i(()=>[o(j,{modelValue:l.busData.item.name,"onUpdate:modelValue":e[0]||(e[0]=a=>l.busData.item.name=a),disabled:l.dialogType==="edit",placeholder:""},null,8,["modelValue","disabled"])]),_:1}),o(b,{label:"PID"},{default:i(()=>[o(g,{modelValue:l.busData.item.pid,"onUpdate:modelValue":e[1]||(e[1]=a=>l.busData.item.pid=a),disabled:l.dialogType==="edit",filterable:"",class:"w100",placeholder:"\u8BF7\u9009\u62E9"},{default:i(()=>[(d(!0),_(C,null,k(l.options.pid,a=>(d(),r(h,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(b,{label:"Role"},{default:i(()=>[o(g,{modelValue:l.busData.item.role,"onUpdate:modelValue":e[2]||(e[2]=a=>l.busData.item.role=a),filterable:"",multiple:"",class:"w100",placeholder:"\u652F\u6301\u591A\u9009"},{default:i(()=>[(d(!0),_(C,null,k(l.options.role,a=>(d(),r(h,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),L("div",Q,[o(m,{onClick:e[3]||(e[3]=a=>l.dialogVisible=!1)},{default:i(()=>[W]),_:1}),o(m,{type:"primary",onClick:p.submitFn},{default:i(()=>[X]),_:1},8,["onClick"])])]),_:1},8,["modelValue","title"])])}var se=O(q,[["render",Y]]);export{se as default};
