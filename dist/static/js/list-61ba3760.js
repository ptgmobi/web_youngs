import{_ as e,d as a,$ as l,h as t,r as i,L as o,M as c,q as n,a0 as r,c as s,x as d,z as u,e as p,s as m,v as f,U as h,A as b,V as v,o as g,f as _,N as y,O as w,y as V}from"./main-ce43ffdd.js";import{P as k}from"./index-2d86919d.js";import{A as D,_ as x,a as C,b as F,c as U,d as z,e as j,f as A}from"./device-10aae116.js";import{m as S}from"./message-1c1d9ef1.js";import{_ as O}from"./lodash-6b3789ad.js";import{o as P,a as N}from"./new-format-368dcfb0.js";import{b as E}from"./format-00f0450d.js";import"./moment-56f006b0.js";const Q={class:"controlBox w100 mb-10"},$={class:"mb-10"},B={class:"flex jc-start flex-wrap w100"},I={class:"flex"},L={class:"flex"},M={class:"flex jc-start"},J={class:"flex jc-around"},T={class:"flex jc-around"},q={class:"flex jc-around"},K=["textContent"],G={class:"flex jc-around"},H={class:"w100 flex"},R={class:"dialog-footer"},W=a({name:"buzz-async"});var X=e(a({...W,setup(e){const a=l({attribute_provider:[],platform:[],package_name:"",channel:"",id:"",offer_title:"",country:"",pid:""});let W=t(!1),X=i({offer:{},index:null,cacheDevice:{},cacheDeviceCount:0}),Y=i({dialogVisible:!1,dialogVisibleDevice:!1,cache:{item:{},device:{}},searchForm:a.value,useData:a.value,loading:!0,options:{cutoff_start:[...new Array(20)].map(((e,a)=>{const l=5*a/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),cutoff_end:[...new Array(20)].map(((e,a)=>{const l=(5*a+5)/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],platform:[{value:"1",label:"Android"},{value:"2",label:"iOS"}]},list:[],pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});const Z=()=>{Y.useData=O.cloneDeep(Y.searchForm),le()},ee=()=>{P("/buzz/buzz-async-create")},ae=e=>`/buzz/buzz-async-edit/${e.id}`,le=async()=>{Y.loading=!0;let e={page:Y.pagination.listQuery.page,page_size:Y.pagination.listQuery.limit};Y.useData.attribute_provider&&(e.attribute_provider=Y.useData.attribute_provider),Y.useData.platform&&(e.platform=Y.useData.platform),Y.useData.package_name&&(e.pkg_name=Y.useData.package_name),Y.useData.channel&&(e.channel=Y.useData.channel),Y.useData.id&&(e.offer_id=Y.useData.id),Y.useData.offer_title&&(e.title=Y.useData.offer_title),Y.useData.country&&(e.country=Y.useData.country),Y.useData.pid&&(e.tracking_link=Y.useData.pid);const a=await D(e),{data:l}=a,{page:t}=l;Y.list=null==l?void 0:l.data,Y.pagination.total=Number(t.count),Y.loading=!1},te=async(e,a)=>{W.value=!1,Y.dialogVisibleDevice=!0,X.offer=a,X.index=e;const l={id:a.id,platform:a.platform,country:a.country},{data:t}=await z(l);X.cacheDevice.all=t.all,X.cacheDevice.select=t.select},ie=e=>{X.cacheDevice.select=e},oe=e=>{X.cacheDeviceCount=e},ce=async()=>{if(!0===W.value){let e=Y.list.map((e=>e.id)),a=0!==e.length?e.join(","):"";if(a){const e={ids:a,device:JSON.stringify(X.cacheDevice.select)},l=await j(e);S(l)&&(Y.dialogVisibleDevice=!1,le())}}else{const e={id:X.offer.id,device:JSON.stringify(X.cacheDevice.select)},a=await A(e);S(a)&&(Y.dialogVisibleDevice=!1,X.offer.device_count=X.cacheDeviceCount)}};return o((()=>{Z()})),c((()=>{})),(e,a)=>{const l=n("el-button"),t=n("el-option"),i=n("el-select"),o=n("el-form-item"),c=n("el-input"),D=n("el-form"),z=n("el-table-column"),j=n("el-switch"),A=n("el-table"),O=n("el-dialog"),ne=r("loading");return g(),s("div",null,[d("div",Q,[d("div",$,[u(' <router-link to="/buzz/buzz-async-create">\n          <el-button type="primary">\n            Offer Create\n          </el-button>\n        </router-link> '),p(l,{type:"primary",onClick:ee},{default:m((()=>[_("Offer Create")])),_:1})]),p(D,{modelValue:f(Y).searchForm,"onUpdate:modelValue":a[8]||(a[8]=e=>f(Y).searchForm=e),inline:!0,class:"flex jc-between w100 ai-end"},{default:m((()=>[d("div",B,[p(o,{label:""},{default:m((()=>[p(i,{modelValue:f(Y).searchForm.attribute_provider,"onUpdate:modelValue":a[0]||(a[0]=e=>f(Y).searchForm.attribute_provider=e),clearable:"",class:"search-con",placeholder:"Attribute Provider",style:{"min-width":"140px"}},{default:m((()=>[(g(!0),s(y,null,w(f(Y).options.attribute_provider,(e=>(g(),b(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(o,{label:""},{default:m((()=>[p(i,{modelValue:f(Y).searchForm.platform,"onUpdate:modelValue":a[1]||(a[1]=e=>f(Y).searchForm.platform=e),clearable:"",class:"search-con",placeholder:"Platform",style:{"min-width":"95px"}},{default:m((()=>[(g(!0),s(y,null,w(f(Y).options.platform,(e=>(g(),b(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(o,{label:""},{default:m((()=>[p(c,{modelValue:f(Y).searchForm.package_name,"onUpdate:modelValue":a[2]||(a[2]=e=>f(Y).searchForm.package_name=e),placeholder:"Package Name",class:"search-con",style:{"min-width":"120px"}},null,8,["modelValue"])])),_:1}),p(o,{label:""},{default:m((()=>[p(c,{modelValue:f(Y).searchForm.channel,"onUpdate:modelValue":a[3]||(a[3]=e=>f(Y).searchForm.channel=e),placeholder:"Channel",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),p(o,{label:""},{default:m((()=>[p(c,{modelValue:f(Y).searchForm.id,"onUpdate:modelValue":a[4]||(a[4]=e=>f(Y).searchForm.id=e),placeholder:"ID",class:"search-con"},null,8,["modelValue"])])),_:1}),p(o,{label:""},{default:m((()=>[p(c,{modelValue:f(Y).searchForm.offer_title,"onUpdate:modelValue":a[5]||(a[5]=e=>f(Y).searchForm.offer_title=e),placeholder:"Offer Title",class:"search-con",style:{"min-width":"90px"}},null,8,["modelValue"])])),_:1}),p(o,{label:""},{default:m((()=>[p(c,{modelValue:f(Y).searchForm.country,"onUpdate:modelValue":a[6]||(a[6]=e=>f(Y).searchForm.country=e),placeholder:"Country",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),p(o,{label:""},{default:m((()=>[p(c,{modelValue:f(Y).searchForm.pid,"onUpdate:modelValue":a[7]||(a[7]=e=>f(Y).searchForm.pid=e),placeholder:"Pid",class:"search-con"},null,8,["modelValue"])])),_:1})]),d("div",I,[p(o,{class:"mr-0",style:{"margin-right":"0px"}},{default:m((()=>[d("div",L,[p(l,{type:"primary",onClick:Z},{default:m((()=>[_(" 查询 ")])),_:1}),u(' <el-button type="primary" @click="handleExportSearch">导出</el-button> ')])])),_:1})])])),_:1},8,["modelValue"]),u(' <el-input placeholder="请输入内容" v-model="data.searchForm.data" class=\'search-input\'>\n        <el-button slot="append" icon="Search" @click=\'searchFun\'></el-button>\n      </el-input> '),u(" 批量修改设备信息 "),d("div",M,[p(l,{class:"cp",type:"primary",icon:"Edit",onClick:a[9]||(a[9]=e=>(()=>{let e=0!==Y.list.length?Y.list[0]:"";e&&(te(0,e),W.value=!0)})())},{default:m((()=>[_("批量修改当前页面内所有offer的device")])),_:1})])]),u(" table "),h((g(),b(A,{center:"",data:f(Y).list,class:"w100",height:"70vh",border:""},{default:m((()=>[p(z,{fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"70"}),p(z,{fixed:"",prop:"channel",label:"Channel",align:"center",width:"60"}),p(z,{prop:"pkg_name",label:"Package Name",align:"center",width:"110"}),p(z,{prop:"title",label:"Offer Title",align:"center"}),p(z,{prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),p(z,{prop:"pid",label:"Pid",align:"center",width:"90"}),p(z,{prop:"platform",label:"Platform",align:"center",width:"65"},{default:m((e=>[_(V(1===Number(e.row.platform)?"Android":"iOS"),1)])),_:1}),p(z,{prop:"country",label:"Country",align:"center",width:"57"}),p(z,{prop:"payout",label:"Payout",align:"center",width:"55"}),p(z,{prop:"p_type",label:"Delivery mode",align:"center",width:"75"},{default:m((e=>[d("span",null,V(1==e.row.p_type?"算法":"标签"),1)])),_:1}),p(z,{label:"Click Limitation",width:"150",align:"center"},{default:m((e=>[d("div",J,[p(c,{modelValue:e.row.max_clk_num,"onUpdate:modelValue":a=>e.row.max_clk_num=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),p(l,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,max_clk_num:parseFloat(e.max_clk_num)},l=await C(a);S(l)})(e.row)},null,8,["onClick"])])])),_:1}),p(z,{label:"Site Click Limitation",width:"150",align:"center"},{default:m((e=>[d("div",T,[p(c,{modelValue:e.row.site_clk_limit,"onUpdate:modelValue":a=>e.row.site_clk_limit=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),p(l,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,site_clk_limit:parseFloat(e.site_clk_limit)},l=await F(a);S(l)})(e.row)},null,8,["onClick"])])])),_:1}),p(z,{label:"Select Device",width:"120",align:"center"},{default:m((e=>[d("div",q,[e.row.device_count?(g(),s("span",{key:0,textContent:V(e.row.device_count?f(E)(e.row.device_count):"")},null,8,K)):u("v-if",!0),p(l,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>te(e.$index,e.row)},null,8,["onClick"])])])),_:1}),p(z,{label:"Operation",align:"center"},{default:m((e=>[d("div",G,[u(' <router-link :to="getEditUrl(scope.row)">\n              <el-button\n                class="cp mr-10"\n                type="primary"\n                icon="Edit"\n                circle\n              ></el-button>\n            </router-link> '),p(l,{class:"cp mr-10",type:"primary",icon:"Edit",circle:"",onClick:a=>(e=>{let a=ae(e);P(a)})(e.row)},null,8,["onClick"]),p(j,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,onChange:a=>(async e=>{let a={id:e.id,status:e.status};a=N(a);const l=await U(a);S(l)})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),_:1})])),_:1},8,["data"])),[[ne,f(Y).loading]]),u(" 分页 "),d("div",H,[h(p(f(k),{page:f(Y).pagination.listQuery.page,"onUpdate:page":a[10]||(a[10]=e=>f(Y).pagination.listQuery.page=e),limit:f(Y).pagination.listQuery.limit,"onUpdate:limit":a[11]||(a[11]=e=>f(Y).pagination.listQuery.limit=e),total:f(Y).pagination.total,"page-sizes":f(Y).pagination.pageSizes,onPagination:le},null,8,["page","limit","total","page-sizes"]),[[v,f(Y).pagination.total]])]),u(" device "),p(O,{modelValue:f(Y).dialogVisibleDevice,"onUpdate:modelValue":a[14]||(a[14]=e=>f(Y).dialogVisibleDevice=e),title:"Device"},{default:m((()=>[f(Y).dialogVisibleDevice?(g(),b(x,{key:0,all:f(X).cacheDevice.all,"onUpdate:all":a[12]||(a[12]=e=>f(X).cacheDevice.all=e),select:f(X).cacheDevice.select,"onUpdate:select":a[13]||(a[13]=e=>f(X).cacheDevice.select=e),onKk:ie,onCount:oe},null,8,["all","select"])):u("v-if",!0),d("span",R,[u(' <el-button @click="cancleDevice">取 消</el-button> '),p(l,{type:"primary",onClick:ce},{default:m((()=>[_("确 定")])),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-0fe780f4"]]);export{X as default};
