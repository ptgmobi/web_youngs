var z=Object.defineProperty,L=Object.defineProperties;var R=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var H=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var Y=(c,n,o)=>n in c?z(c,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):c[n]=o,C=(c,n)=>{for(var o in n||(n={}))H.call(n,o)&&Y(c,o,n[o]);if(T)for(var o of T(n))W.call(n,o)&&Y(c,o,n[o]);return c},O=(c,n)=>L(c,R(n));import{d as B,z as A,C as I,af as G,r as y,o as u,k as h,v as g,x as s,h as f,j as a,F as j,l as w,i as F,y as P,ag as K,c as V,w as $,t as N,q as J,s as Q,b as U}from"./vendor-f1931894.js";import{f as X,h as Z,i as ee,j as ae}from"./overview-e6f16366.js";import{g as S,a as te,t as E}from"./format-b76f9697.js";import{_ as le}from"./lodash-43532635.js";import{h as M}from"./new-format-e3b038cd.js";import{_ as oe}from"./index-482e3000.js";import{_ as ne}from"./index-640a0a05.js";import{W as re}from"./index-a9963ce6.js";import"./moment-1cf83a0b.js";const se={class:"white-bg control-box flex jc-between ai-start p0-0"},ue={class:"flex jc-start flex-wrap ai-start"},ce={class:"flex"},de=P(" \u67E5\u8BE2 "),ie=B({emits:["emitParent"],setup(c,{emit:n}){const o={adtype:"",channel_type:"",user_name:"",slot:"",country:"",date:S(6,"day")},e=A({shortcuts:[{text:"\u4ECA\u5929",value:S(0,"day")},{text:"\u6628\u5929",value:()=>te(1,1,"day")},{text:"\u6700\u8FD17\u5929",value:()=>S(6,"day")},{text:"\u6700\u8FD130\u5929",value:()=>S(29,"day")}],options:{adtype:["ssp","fenix"],channel_type:[{value:1,label:"\u4EE3\u7406"},{value:2,label:"API"},{value:3,label:"\u76F4\u5BA2"}],country:[{value:"",label:""}],user_name:[{label:"",value:""}],slot:[{value:"",label:""}]},data:o}),d=async()=>{const{data:i}=await X();e.options.user_name=i==null?void 0:i.user_name,e.options.slot=i==null?void 0:i.slot,e.options.country=i==null?void 0:i.country},x=()=>{},v=()=>{console.warn("set search data"),n("emitParent",le.cloneDeep(K(e.data)))};return I(()=>{console.log("onMounted"),d(),v()}),G(()=>{console.log("onActivated"),d(),v()}),(i,p)=>{const r=y("el-date-picker"),l=y("el-form-item"),_=y("el-option"),b=y("el-select"),m=y("el-button"),D=y("el-form");return u(),h("div",null,[g("div",se,[s(D,{inline:!0,model:a(e).data,class:"flex jc-between ai-start w100"},{default:f(()=>[g("div",ue,[s(l,{label:"\u65E5\u671F\u9009\u62E9"},{default:f(()=>[s(r,{modelValue:a(e).data.date,"onUpdate:modelValue":p[0]||(p[0]=t=>a(e).data.date=t),class:"search-con",type:"daterange","unlink-panels":"",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",shortcuts:a(e).shortcuts,clearable:!1},null,8,["modelValue","shortcuts"])]),_:1}),s(l,{label:"\u5206\u6210\u65B9\u6CD5"},{default:f(()=>[s(b,{modelValue:a(e).data.adtype,"onUpdate:modelValue":p[1]||(p[1]=t=>a(e).data.adtype=t),class:"search-con",clearable:"",placeholder:"\u641C\u7D22",onChange:x},{default:f(()=>[(u(!0),h(j,null,w(a(e).options.adtype,t=>(u(),V(_,{key:t,label:t,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(l,{label:"\u4E1A\u52A1\u7C7B\u578B"},{default:f(()=>[s(b,{modelValue:a(e).data.channel_type,"onUpdate:modelValue":p[2]||(p[2]=t=>a(e).data.channel_type=t),class:"search-con",clearable:"",placeholder:"\u641C\u7D22",filterable:"",onChange:x},{default:f(()=>[F(` <div class="flex jc-between p10 pt-0">
                <el-button type="primary" plain size="mini" @click="selectAllProduct()">\u5168\u9009</el-button>
                <el-button size="mini" type="danger" plain @click="unSelectedAllProduct()">\u6E05\u7A7A</el-button>
              </div> `),(u(!0),h(j,null,w(a(e).options.channel_type,(t,k)=>(u(),V(_,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(l,{label:"User Name"},{default:f(()=>[s(b,{modelValue:a(e).data.user_name,"onUpdate:modelValue":p[3]||(p[3]=t=>a(e).data.user_name=t),class:"search-con",clearable:"",placeholder:"\u641C\u7D22",filterable:"",onChange:x},{default:f(()=>[(u(!0),h(j,null,w(a(e).options.user_name,(t,k)=>(u(),V(_,{key:t.toString(),label:t.toString(),value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(l,{label:"Slot"},{default:f(()=>[s(b,{modelValue:a(e).data.slot,"onUpdate:modelValue":p[4]||(p[4]=t=>a(e).data.slot=t),class:"search-con",clearable:"",placeholder:"\u641C\u7D22","collapse-tags":"",filterable:"",onChange:x},{default:f(()=>[(u(!0),h(j,null,w(a(e).options.slot,(t,k)=>(u(),V(_,{key:t.toString(),label:t.toString(),value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),s(l,{label:"\u56FD\u5BB6"},{default:f(()=>[s(b,{modelValue:a(e).data.country,"onUpdate:modelValue":p[5]||(p[5]=t=>a(e).data.country=t),class:"search-con",clearable:"",placeholder:"\u641C\u7D22","collapse-tags":"",filterable:"",onChange:x},{default:f(()=>[(u(!0),h(j,null,w(a(e).options.country,(t,k)=>(u(),V(_,{key:t.toString(),label:t.toString(),value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),g("div",null,[g("div",ce,[s(m,{type:"primary",onClick:v},{default:f(()=>[de]),_:1})])])]),_:1},8,["model"])])])}}});const q=c=>(J("data-v-422fd230"),c=c(),Q(),c),pe={class:"flex flex-wrap jc-between"},_e={class:"flex jc-between"},me={key:0,class:"color_primary"},fe=q(()=>g("span",{class:"small_icon"},"$",-1)),be={key:1,class:"color_primary"},he=q(()=>g("span",{class:"small_icon"},"%",-1)),ve=B({props:{json:{require:!0,default:{},type:Object}},setup(c){const n=c,o={profit:"\u6BDB\u5229\u5408\u8BA1",revenue:"\u6536\u5165\u5408\u8BA1",cost:"\u652F\u51FA\u5408\u8BA1",profit_rate:"\u6BDB\u5229\u7387"},e={},d=A({baseData:n.json,data:e,titleMap:o,groupVal:["profit","revenue","cost"],groupRate:["profit_rate"]}),x=async()=>{let v=C({},d.baseData.data);v=M(v);const{data:i}=await Z(v);if(Array.isArray(i)&&i.length!==0)d.data=i[0];else for(const p in d.data)Object.prototype.hasOwnProperty.call(d.data,p)&&(d.data[p]=0)};return $(()=>d.baseData,(v,i)=>{console.warn("get card data"),x()},{deep:!0}),I(()=>{}),(v,i)=>{const p=y("el-card");return u(),h("div",null,[g("div",pe,[(u(!0),h(j,null,w(a(d).titleMap,(r,l)=>(u(),V(p,{class:"box-card m10"},{default:f(()=>[g("div",_e,[g("h3",null,N(a(d).titleMap[l]),1),a(d).groupVal.includes(l)?(u(),h("h2",me,[fe,P(" "+N(a(d).data[l]),1)])):F("v-if",!0),a(d).groupRate.includes(l)?(u(),h("h2",be,[P(N(a(E)(a(d).data[l]*100))+" ",1),he])):F("v-if",!0)])]),_:2},1024))),256))])])}}});var ye=oe(ve,[["__scopeId","data-v-422fd230"]]);const ge=B({props:{json:{require:!0,default:{},type:Object}},setup(c){const n=c,o=A({data:{target:"cost"},options:{target:[{value:"profit",label:"\u6BDB\u5229"},{value:"revenue",label:"\u6536\u5165"},{value:"cost",label:"\u652F\u51FA"},{value:"profit_rate",label:"\u6BDB\u5229\u7387"}]}}),e=A({data:n.json,baseCharData:{},chartData:{tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{show:!0,backgroundColor:"#6a7985"}}},legend:{show:!0,data:["all"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:[]}],yAxis:[{type:"value"}],series:[{name:"",type:"line",stack:"Total",emphasis:{focus:"series"},data:[]}]}});$(()=>e.data,(r,l)=>{console.warn("get chart data"),p()},{deep:!0});const d=()=>{var l;let r=o.options.target.find(_=>_.value===o.data.target);return(l=r==null?void 0:r.label)!=null?l:""},x=["6"],v=()=>{i()},i=()=>{var _;let r=o.data.target;console.log(r);let l=(_=e.baseCharData[r])!=null?_:[];if(x.includes(o.data.target.toString())){let b=l.map(m=>E(m*100,2));e.chartData.series[0].data=b}else{let b=l.map(m=>E(m,2));e.chartData.series[0].data=b}e.chartData.series[0].name=d()},p=async()=>{var _;let r=C({},e.data.data);r=M(r),e.chartData.xAxis[0].data=[],e.chartData.series[0].data=[];const{data:l}=await ee(r);console.log(l),e.baseCharData=l,e.chartData.xAxis[0].data=(_=l==null?void 0:l.date)!=null?_:[],e.chartData.series[0].name=d(),i()};return(r,l)=>{const _=y("el-option"),b=y("el-select"),m=y("el-form-item"),D=y("el-form");return u(),h("div",null,[g("div",null,[s(D,{inline:!0,model:a(o).data,class:"flex jc-between w100"},{default:f(()=>[s(m,{label:"\u6307\u6807"},{default:f(()=>[s(b,{modelValue:a(o).data.target,"onUpdate:modelValue":l[0]||(l[0]=t=>a(o).data.target=t),placeholder:"Select",onChange:v},{default:f(()=>[(u(!0),h(j,null,w(a(o).options.target,t=>(u(),V(_,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),g("div",null,[s(a(ne),{"chart-data":a(e).chartData},null,8,["chart-data"])])])}}}),xe={class:"mt-20"},De={class:"flex jc-end mb-10"},je=B({props:{json:{require:!0,default:{},type:Object}},setup(c){let o=A({data:c.json,list:[],exportExcel:{buttonName:"\u5BFC\u51FA",tHeader:["\u65E5\u671F"],filterVal:["date"],fileName:"profit"}}),e=A([{value:"user_id",label:"User ID"},{value:"account_email",label:"Account Email"},{value:"user_name",label:"User Name"},{value:"profit",label:"\u6BDB\u5229"},{value:"revenue",label:"\u6536\u5165"},{value:"cost",label:"\u652F\u51FA"},{value:"profit_rate",label:"\u6BDB\u5229\u7387"}]);$(()=>o.data,(r,l)=>{console.warn("get table data"),d()},{deep:!0});const d=async()=>{let r=C({},o.data.data);r=M(r),o.list=[];const{data:l}=await ae(r);o.list=l};let x=["profit_rate"],v=U(()=>{let r=[];return o.list.map(l=>{let _={},b=C({},l);for(const m in b)if(Object.prototype.hasOwnProperty.call(b,m)){const D=b[m];x.includes(m)?_[m]=`${E(D*100,2)}%`:_[m]=D}r.push(_)}),r});const i=U(()=>e.map(r=>r.label)),p=U(()=>e.map(r=>r.value));return(r,l)=>{const _=y("el-table-column"),b=y("el-table");return u(),h("div",xe,[g("div",De,[s(re,{"button-name":a(o).exportExcel.buttonName,list:a(v),"t-header":a(i),"filter-val":a(p),filename:a(o).exportExcel.fileName},null,8,["button-name","list","t-header","filter-val","filename"])]),F(" table "),s(b,{center:"",data:a(v),class:"w100",border:""},{default:f(()=>[(u(!0),h(j,null,w(a(e),m=>{var D;return u(),V(_,{key:m.value,prop:m.value,label:m.label,fixed:(D=m==null?void 0:m.fixed)!=null?D:!1,align:"center"},null,8,["prop","label","fixed"])}),128))]),_:1},8,["data"])])}}}),we={class:"app-container"},Ve=B({name:"Profit"}),Ue=B(O(C({},Ve),{setup(c){let n=A({data:{adtype:"",channel_type:"",user_name:"",slot:"",country:"",st:"",et:""}});const o=e=>{n.data.adtype=e.adtype,n.data.channel_type=e.channel_type,n.data.user_name=e.user_name,n.data.slot=e.slot,n.data.country=e.country,n.data.st=e.date[0],n.data.et=e.date[1]};return(e,d)=>(u(),h("div",we,[s(a(ie),{onEmitParent:o}),s(a(ye),{json:a(n)},null,8,["json"]),s(a(ge),{json:a(n)},null,8,["json"]),s(a(je),{json:a(n)},null,8,["json"])]))}}));export{Ue as default};
