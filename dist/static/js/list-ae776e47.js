var a=Object.defineProperty,e=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(e,l,t)=>l in e?a(e,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[l]=t;import{d as n,y as r,w as s,B as i,r as u,o as d,i as c,v as p,f,h as m,N as b,a as v,ak as h,e as _,al as w,s as g,g as y,P as V,Q as D,aa as C,F as k,j as U,t as x,x as O,c as j}from"./vendor-691ef2b9.js";import{g as P,h as S,i as A,j as Q,k as I,l as E,m as N,n as T,o as $}from"./fenix-577de6ce.js";import{P as z}from"./index-92f89119.js";import{m as B}from"./message-00de5233.js";import{h as F}from"./new-format-e267a6f6.js";import{_ as R}from"./index-a5aa88b7.js";const M=n({props:{busData:{require:!0,default:()=>({}),type:Object}},setup(a){const e=a,l=r({tableData:[{}]});return s((()=>e.busData.offer.offer_id),((a,t)=>{(async()=>{const a={offer_id:e.busData.offer.offer_id};l.tableData=[];const{data:t}=await P(a);l.tableData=t})()}),{immediate:!0}),i((()=>{})),(a,e)=>{const t=u("el-table-column"),o=u("el-table");return d(),c("div",null,[p(o,{data:m(l).tableData,style:{width:"100%"},border:""},{default:f((()=>[p(t,{fixed:"",prop:"date",label:"Date",align:"center"}),p(t,{fixed:"",prop:"record",label:"Record",align:"center"}),p(t,{fixed:"",prop:"email",label:"User",align:"center"})])),_:1},8,["data"])])}}});const Z={class:"control-box w100 mb-10"},q={class:"mb-10"},J=O("Offer Create"),K={class:"flex jc-start flex-wrap w100"},G={class:"flex"},H={class:"flex"},L=O("查询"),W={class:"body-box mt-10"},X={class:"flex"},Y={key:0},aa=O(" . "),ea=O(" . "),la=O(" . "),ta={class:"flex"},oa={class:"w100 flex"};var na=R(n({setup(a){b(),v(!0);let n=v(!1);v(!1);const s=r({searchData:{adv_status:void 0,status:void 0,cvr_status:void 0,platform:void 0,attribute_provider:"",pub_name:"",offer_id:"",adv_offer:"",pkg:"",title:"",channel:"",country:"",channel_type:void 0},tableData:[],options:{status:[{value:1,label:"开"},{value:2,label:"关"}],platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],pub:[{id:"",pub_name:""}],channel_type:[{value:"1",label:"BUZZ"},{value:"2",label:"SDK"}],dailyCapCount:{},cvr:{}},pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});let O=r({});h(s,"tableData");const P=({row:a})=>`/fenix/offer/edit/${a.id}`,R=async()=>{const{data:a}=await E();s.options.pub=a},na=async()=>{const{data:a}=await N(),e={};for(const l in a)if(Object.prototype.hasOwnProperty.call(a,l)){const t=a[l].split("_"),o={click_w:t[0],installs:t[1],cvr_w:t[2]};e[l]=o}s.options.cvr=e},ra=async()=>{const{data:a}=await T();s.options.dailyCapCount=a},sa=async()=>{let a={page:s.pagination.listQuery.page,limit:s.pagination.listQuery.limit};const n=((a,n)=>{for(var r in n||(n={}))l.call(n,r)&&o(a,r,n[r]);if(e)for(var r of e(n))t.call(n,r)&&o(a,r,n[r]);return a})({},s.searchData);for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e)){const l=n[e];l&&(a[e]=l)}const r=await S(a);s.tableData=r.data.data,s.pagination.total=r.data.paging.count},ia=()=>{sa()},ua=(a,e)=>{let l="";l=`${a.offer_id}_${e.slotid}`;const t=s.options.dailyCapCount[l];return t?`: ${t}`:""};_((()=>{})),i((()=>{(async()=>{Promise.all([R(),ra(),na()])})(),sa(),window.onpopstate=()=>{}})),w((()=>{}));return(a,e)=>{const l=u("el-button"),t=u("router-link"),o=u("el-option"),r=u("el-select"),i=u("el-form-item"),b=u("el-input"),v=u("el-form"),h=u("el-table-column"),_=u("el-switch"),w=u("el-popconfirm"),S=u("el-table"),E=u("el-dialog");return d(),c("div",null,[g("div",Z,[g("div",q,[p(t,{to:"/fenix/offer/create"},{default:f((()=>[p(l,{type:"primary"},{default:f((()=>[J])),_:1})])),_:1})]),p(v,{inline:!0,modelValue:m(s).searchData,"onUpdate:modelValue":e[12]||(e[12]=a=>m(s).searchData=a),class:"flex jc-between w100 ai-end"},{default:f((()=>[g("div",K,[p(i,{label:""},{default:f((()=>[p(r,{modelValue:m(s).searchData.adv_status,"onUpdate:modelValue":e[0]||(e[0]=a=>m(s).searchData.adv_status=a),clearable:"",class:"search-con",placeholder:"Adv Status"},{default:f((()=>[(d(!0),c(k,null,U(m(s).options.status,(a=>(d(),j(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(r,{modelValue:m(s).searchData.status,"onUpdate:modelValue":e[1]||(e[1]=a=>m(s).searchData.status=a),clearable:"",class:"search-con",placeholder:"Status"},{default:f((()=>[(d(!0),c(k,null,U(m(s).options.status,(a=>(d(),j(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),y(' <el-form-item label="">\n            <el-select v-model="state.searchData.cvr_status" clearable class="search-con" placeholder="Cvr Status">\n              <el-option\n                v-for="item in state.options.status"\n                :key="item.value"\n                :label="item.label"\n                :value="item.value"\n              />\n            </el-select>\n          </el-form-item> '),p(i,{label:""},{default:f((()=>[p(r,{modelValue:m(s).searchData.platform,"onUpdate:modelValue":e[2]||(e[2]=a=>m(s).searchData.platform=a),clearable:"",class:"search-con",placeholder:"Platform"},{default:f((()=>[(d(!0),c(k,null,U(m(s).options.platform,(a=>(d(),j(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(r,{modelValue:m(s).searchData.attribute_provider,"onUpdate:modelValue":e[3]||(e[3]=a=>m(s).searchData.attribute_provider=a),clearable:"",class:"search-con",placeholder:"Attribute Provider"},{default:f((()=>[(d(!0),c(k,null,U(m(s).options.attribute_provider,(a=>(d(),j(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(r,{modelValue:m(s).searchData.pub_name,"onUpdate:modelValue":e[4]||(e[4]=a=>m(s).searchData.pub_name=a),clearable:"",class:"search-con",placeholder:"Pub Name"},{default:f((()=>[(d(!0),c(k,null,U(m(s).options.pub,(a=>(d(),j(o,{key:a.id,label:a.pub_name,value:a.pub_name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(b,{placeholder:"Offer ID",modelValue:m(s).searchData.offer_id,"onUpdate:modelValue":e[5]||(e[5]=a=>m(s).searchData.offer_id=a),class:"search-con"},null,8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(b,{placeholder:"Adv Offer",modelValue:m(s).searchData.adv_offer,"onUpdate:modelValue":e[6]||(e[6]=a=>m(s).searchData.adv_offer=a),class:"search-con"},null,8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(b,{placeholder:"Pachage Name",modelValue:m(s).searchData.pkg,"onUpdate:modelValue":e[7]||(e[7]=a=>m(s).searchData.pkg=a),class:"search-con"},null,8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(b,{placeholder:"Offer Title",modelValue:m(s).searchData.title,"onUpdate:modelValue":e[8]||(e[8]=a=>m(s).searchData.title=a),class:"search-con"},null,8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(b,{placeholder:"Channel",modelValue:m(s).searchData.channel,"onUpdate:modelValue":e[9]||(e[9]=a=>m(s).searchData.channel=a),class:"search-con"},null,8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(b,{placeholder:"Country",modelValue:m(s).searchData.country,"onUpdate:modelValue":e[10]||(e[10]=a=>m(s).searchData.country=a),class:"search-con"},null,8,["modelValue"])])),_:1}),p(i,{label:""},{default:f((()=>[p(r,{modelValue:m(s).searchData.channel_type,"onUpdate:modelValue":e[11]||(e[11]=a=>m(s).searchData.channel_type=a),clearable:"",class:"search-con",placeholder:"Channel Type"},{default:f((()=>[(d(!0),c(k,null,U(m(s).options.channel_type,(a=>(d(),j(o,{key:a.value,label:a.label,value:a.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})]),g("div",G,[p(i,{class:"mr-0",style:{"margin-right":"0px"}},{default:f((()=>[g("div",H,[p(l,{type:"primary",onClick:ia},{default:f((()=>[L])),_:1}),y(' <el-button type="primary" @click="handleExportSearch">导出</el-button> ')])])),_:1})])])),_:1},8,["modelValue"]),y(' <el-input placeholder="请输入内容" v-model="searchData.data" class=\'search-input\'>\n        <el-button slot="append" icon="Search" @click=\'searchFun\'></el-button>\n      </el-input> ')]),y(" table "),g("div",W,[p(S,{data:m(s).tableData,height:"600",style:{width:"100%"},border:""},{default:f((()=>[p(h,{fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"60"}),p(h,{fixed:"",prop:"adv_offer",label:"Adv Offer",align:"center",width:"87"}),p(h,{fixed:"",prop:"channel",label:"Channel",align:"center",width:"42"}),p(h,{prop:"revenue",label:"Revenue",align:"center",width:"45"}),p(h,{prop:"pkg",label:"Package Name",align:"center",width:"100"}),p(h,{prop:"title",label:"Offer Title",align:"center",width:"90"}),p(h,{prop:"pid",label:"Pid",align:"center",width:"77"}),p(h,{prop:"country",label:"Country",align:"center",width:"40"}),p(h,{label:"Adv Status",align:"center",width:"47"},{default:f((a=>[g("div",null,[g("span",null,x(1===a.row.adv_status?"开":"关"),1)])])),_:1}),p(h,{prop:"offer_id",label:"Click*w",align:"center",width:"55"},{default:f((a=>{var e;return[g("div",null,[g("span",null,x(null==(e=m(s).options.cvr[a.row.offer_id])?void 0:e.click_w),1)])]})),_:1}),p(h,{prop:"offer_id",label:"Installs",align:"center",width:"50"},{default:f((a=>{var e;return[g("div",null,[g("span",null,x(null==(e=m(s).options.cvr[a.row.offer_id])?void 0:e.installs),1)])]})),_:1}),p(h,{prop:"offer_id",label:"Cvr*w",align:"center",width:"48"},{default:f((a=>{var e;return[g("div",null,[g("span",null,x(null==(e=m(s).options.cvr[a.row.offer_id])?void 0:e.cvr_w),1)])]})),_:1}),p(h,{label:"Target Cvr*w",align:"center",width:"150"},{default:f((a=>[g("div",X,[p(b,{modelValue:a.row.target_cvr,"onUpdate:modelValue":e=>a.row.target_cvr=e,placeholder:"Please input",class:"input-with-select mr-5"},null,8,["modelValue","onUpdate:modelValue"]),p(l,{class:"mr-5 scale-button",type:"default",icon:"Edit",circle:"",onClick:e=>(async({row:a})=>{let e={id:a.id,target_cvr:a.target_cvr};e=F(e);const l=await I(e);B(l)})(a)},null,8,["onClick"]),p(_,{class:"scale-button",modelValue:a.row.cvr_status,"onUpdate:modelValue":e=>a.row.cvr_status=e,"active-value":1,"inactive-value":2,onChange:e=>(async({row:a})=>{let e={id:a.id,cvr_status:a.cvr_status};e=F(e);const l=await Q(e);B(l)||(a.cvr_status=1===a.cvr_status?2:1)})(a)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),_:1}),p(h,{label:"Traffic Data",align:"left",width:"200"},{default:f((a=>[a.row.traffic?(d(),c("div",Y,[(d(!0),c(k,null,U(JSON.parse(a.row.traffic),(e=>(d(),c("div",{key:e},[g("div",null,[g("span",null,x(1===e.pub_status?"开":"关"),1),aa,g("span",null,x(e.pub),1),ea,g("span",null,x(e.payout),1),la,g("span",null,x(e.cap_daily),1),g("span",null,x(ua(a.row,e)),1)])])))),128))])):y("v-if",!0)])),_:1}),p(h,{label:"Operation",align:"center",width:"130"},{default:f((a=>[p(t,{to:P(a)},{default:f((()=>[p(l,{class:"cp mr-5",type:"primary",icon:"Edit",circle:""})])),_:2},1032,["to"]),p(_,{modelValue:a.row.status,"onUpdate:modelValue":e=>a.row.status=e,"active-value":1,"inactive-value":2,class:"mr-5",onChange:e=>(async({row:a})=>{const e={id:a.id,status:a.status},l=await A(e);B(l)||(a.status=1===a.status?2:1)})(a)},null,8,["modelValue","onUpdate:modelValue","onChange"]),p(w,{title:"删除后无法再生成该Offer ID，请谨慎操作！",onConfirm:e=>(async a=>{const{row:e}=a,l=await $(e.id);B(l)&&s.tableData.splice(a.$index,1)})(a)},{reference:f((()=>[p(l,{type:"danger",icon:"Delete",circle:""})])),_:2},1032,["onConfirm"])])),_:1}),p(h,{label:"Platform",align:"center",width:"55"},{default:f((a=>[g("div",null,[g("span",null,x(1===a.row.platform?"Android":"iOS"),1)])])),_:1}),p(h,{prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),p(h,{label:"Record",align:"center",width:"52"},{default:f((({row:a})=>[p(l,{class:"scale-button",icon:"View",onClick:e=>(a=>{O.offer=a,n.value=!0})(a),circle:""},null,8,["onClick"])])),_:1}),p(h,{label:"Comment",align:"center",width:"150"},{default:f((a=>[g("div",ta,[p(b,{modelValue:a.row.description,"onUpdate:modelValue":e=>a.row.description=e,placeholder:"Please input",class:"input-with-select mr-5"},null,8,["modelValue","onUpdate:modelValue"]),p(l,{class:"scale-button",type:"default",icon:"Edit",circle:""})])])),_:1})])),_:1},8,["data"])]),y(" 分页 "),g("div",oa,[V(p(m(z),{total:m(s).pagination.total,"page-sizes":m(s).pagination.pageSizes,page:m(s).pagination.listQuery.page,"onUpdate:page":e[13]||(e[13]=a=>m(s).pagination.listQuery.page=a),limit:m(s).pagination.listQuery.limit,"onUpdate:limit":e[14]||(e[14]=a=>m(s).pagination.listQuery.limit=a),onPagination:sa},null,8,["total","page-sizes","page","limit"]),[[D,m(s).pagination.total]])]),y(" record "),p(E,{title:"日志",width:"80%",modelValue:m(n),"onUpdate:modelValue":e[16]||(e[16]=a=>C(n)?n.value=a:n=a)},{default:f((()=>[p(M,{modelValue:m(n),"onUpdate:modelValue":e[15]||(e[15]=a=>C(n)?n.value=a:n=a),busData:m(O)},null,8,["modelValue","busData"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-ec68c14e"]]);export{na as default};
