!function(){function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function r(r){for(var n=1;n<arguments.length;n++){var i=null!=arguments[n]?arguments[n]:{};n%2?e(Object(i),!0).forEach((function(e){t(r,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))}))}return r}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e,r,t,n,i,o,a){try{var l=e[o](a),u=l.value}catch(c){return void t(c)}l.done?r(u):Promise.resolve(u).then(n,i)}function i(e){return function(){var r=this,t=arguments;return new Promise((function(i,o){var a=e.apply(r,t);function l(e){n(a,i,o,l,u,"next",e)}function u(e){n(a,i,o,l,u,"throw",e)}l(void 0)}))}}function o(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(!e)return;if("string"==typeof e)return a(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return a(e,r)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}var l=document.createElement("style");l.innerHTML=".num-circle{width:20px;height:20px;color:#1a8eff;border:2px solid #1a8eff;border-radius:50%;text-align:center;line-height:17px;margin-right:20px}.content-li-title{margin:20px}\n",document.head.appendChild(l),System.register(["./index-legacy-0ae7a762.js","./message-legacy-b0c8d7a7.js"],(function(e){"use strict";var t,n,a,l,u,c,f,d,s,p,m,g,v,_,h,y,b,F,w,k,O,x,A;return{setters:[function(e){t=e.d,n=e.a,a=e.r,l=e.e,u=e.w,c=e.I,f=e.a1,d=e.M,s=e.m,p=e.s,m=e.n,g=e.z,v=e.c,_=e.p,h=e.v,y=e.x,b=e.q,F=e.O,w=e.P,k=e.b,O=e.A,x=e.L},function(e){A=e.m}],execute:function(){var j={class:"container"},D=h("div",{class:"flex jc-start content-li-title"},[h("div",{class:"num-circle"},"1"),h("h5",null,"Offer Basic Info")],-1),S={class:"content-con flex column"},q={class:"flex jc-start form-one radio-box"},E=["textContent"],V={class:"w100 flex"},P=k(" Save "),C=k(" 123 "),N={slot:"footer",class:"dialog-footer"},I=k("确 定");e("default",t({setup:function(e){var t=x().proxy;n();var k="此项必填",R=function(e,r,t){"AppsFlyer"===$.ruleForm.attribute_provider?$.ruleForm.tracking_link.includes($.ruleForm.pkg_name)?t(void 0):t(new Error("Attribute Provider:为Appsflyer时Package Name的值必须包含在Traking Link中")):t(void 0)},M=a({offer_id:"",channel:"",copy_offer:"",offer_open_type:""}),U=a({channel:[{required:!0,message:k,trigger:["blur","change"]}],offer_open_type:[{required:!0,message:k,trigger:["blur","change"]}]}),J=a({channel:[],attribute_provider:["AppsFlyer","Branch","Adjust","Singular","AppMetrica"],time:[-1].concat(o(o(new Array(24)).map((function(e,r){return r})))),platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],country:[],site_id:["0.2","0.4","0.6","1","2","4","8","24","72","168"],category:[],devices:[]}),T=a({offer:{},index:null,cacheDevice:{}});l("");var B=l(0),L=l([0,100]),$=a({dialogVisibleDevice:!1,dialogVisibleSite:!1,search:{id:"",baseDeviceSelect:{},deviceData:{all:[],select:[],count:0}},type:"1",params:"",loading:!0,options:{channel:[],attribute_provider:["AppsFlyer","Branch","Adjust","Singular","AppMetrica"],time:[-1].concat(o(o(new Array(24)).map((function(e,r){return r})))),platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],country:[],site_id:["0.2","0.4","0.6","1","2","4","8","24","72","168"],category:[],devices:[]},ruleForm:{type:"",id:"",offer_id:void 0,operation_type:"",channel:"",copy_offer:"",attribute_provider:"AppsFlyer",title:"",tracking_link:"",pid:"",pkg_name:"",conversion_flow:"",event_name:"",payout:void 0,platform:"",country:"",max_clk_num:void 0,site_clk_limit:void 0,site_install_limitation:void 0,start_hour:"-1",end_hour:"-1",device:[],cutoff_start:void 0,cutoff_end:void 0,diy_siteid:"",site_id:"",hour:void 0,clk_id:"",site_clk_id:"",note:""},rules:{channel:[{required:!0,message:k,trigger:["blur","change"]}],attribute_provider:[{required:!0,message:k,trigger:["blur","change"]}],title:[{required:!0,message:k,trigger:["blur","change"]}],tracking_link:[{required:!0,message:k,trigger:["blur","change"]},{validator:function(e,r,t){new RegExp("\\s+","g").test(r)?t(new Error("链接中有空格")):t(void 0),t(void 0)}},{validator:function(e,r,t){/^http/.test(r)?t(void 0):t(new Error("必须为有效链接")),t(void 0)}},{validator:function(e,r,t){if("AppsFlyer"===$.ruleForm.attribute_provider){["af_sub_siteid","af_installpostback"].map((function(e){r.includes(e)&&t(new Error("链接有错误，不能包含".concat(e)))}))}t(void 0)}},{validator:R}],pkg_name:[{required:!0,message:k,trigger:["blur","change"]},{validator:R}],conversion_flow:[{required:!0,message:k,trigger:["blur","change"]}],event_name:[{required:!0,message:k,trigger:["blur","change"]},{validator:function(e,r,t){"1"===$.ruleForm.conversion_flow?t(void 0):t(r?void 0:new Error(k))}}],payout:[{required:!0,message:k,trigger:["blur","change"]}],platform:[{required:!0,message:k,trigger:["blur","change"]}],country:[{required:!0,message:k,trigger:["blur","change"]}],max_clk_num:[{required:!0,message:k,trigger:["blur","change"]}],device:[{required:!0,validator:function(e,r,t){t(void 0)},trigger:["blur","change"]}],site_id:[{required:!0,validator:function(e,r,t){r?1===r||$.ruleForm.hour?t(void 0):t(new Error("请选择具体数值")):t(new Error(k))},trigger:["blur","change"]}],clk_id:[{required:!0,message:k,trigger:["blur","change"]}],start_hour:[{required:!1,validator:function(e,r,t){""!==r&&(""===$.ruleForm.end_hour?t(new Error(k)):t(void 0))},trigger:["blur","change"]}],end_hour:[{required:!1,validator:function(e,r,t){""!==r&&(""===$.ruleForm.start_hour?t(new Error(k)):t(void 0))},trigger:["blur","change"]}],cutoff_start:[{required:!0,trigger:["blur","change"]}],cutoff_end:[{required:!0,trigger:["blur","change"]}]},siteData:[]}),z=function(){G("ruleForm")},G=function(e){t.$refs[e].validate((function(e){if(!e)return!1;H()}))},H=function(){var e=i(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if($.ruleForm,(n=r({},$.ruleForm)).clk_id=parseFloat(n.clk_id),n.conversion_flow=parseFloat(n.conversion_flow),n.cutoff_end=parseFloat(n.cutoff_end),n.cutoff_start=parseFloat(n.cutoff_start),n.end_hour=parseFloat(n.end_hour),n.start_hour=parseFloat(n.start_hour),n.hour=parseFloat(n.hour),n.max_clk_num=parseFloat(n.max_clk_num),n.payout=parseFloat(n.payout),n.platform=parseFloat(n.platform),n.site_clk_id=parseFloat(n.site_clk_id),n.site_clk_limit=parseFloat(n.site_clk_limit),n.site_id=parseFloat(n.site_id),n.site_install_limitation=parseFloat(n.site_install_limitation),n.diy_siteid=JSON.stringify(n.diy_siteid),n.device=JSON.stringify(n.device),"1"!==$.ruleForm.type){e.next=26;break}return delete n.id,delete n.offer_id,e.next=25,ApiOperationOfferCreate(n);case 25:t=e.sent;case 26:if("2"!==$.ruleForm.type){e.next=30;break}return e.next=29,ApiOperationOfferEdit(n);case 29:t=e.sent;case 30:A(t)&&window.close();case 31:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){$.ruleForm.device=T.cacheDevice.select,$.dialogVisibleDevice=!1};u(L,(function(e,r){!function(e){$.ruleForm.cutoff_start=e[0]/100,$.ruleForm.cutoff_end=e[1]/100}(e)}),{immediate:!0});var Q=function(){var e=i(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:$.ruleForm.pkg_name,$.ruleForm.country,$.ruleForm.platform;case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();c((function(){var e=B.value,r=$.ruleForm.cutoff_start,t=$.ruleForm.cutoff_end;return{judge:((Number(t)-Number(r))*Number(e)).toFixed(0),all:Number(e).toFixed(0)}})),f((function(){Q()}));var W=function(e,t){var n={};return t.type,e.device&&(e.device=JSON.parse(e.device)),e.diy_siteid&&(e.diy_siteid=JSON.parse(e.diy_siteid)),"2"===t.type&&(n.id=e.id,n.offer_id=e.offer_id),n=r(r({},e),t),"1"===t.type&&(delete n.id,delete n.offer_id),n},X=function(){var e=i(regeneratorRuntime.mark((function e(t){var n,i,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ApiGetCopyOfferData({offer_id:t});case 2:n=e.sent,i=n.data,o=W(i,{type:$.ruleForm.type,isCopy:!0}),$.ruleForm=r(r({},$.ruleForm),o);case 6:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),Y=function(){var e=$.ruleForm.copy_offer;X(e)};return c((function(){var e=$.ruleForm.tracking_link,r=$.ruleForm.attribute_provider,t="";if("AppsFlyer"===r){var n=o(e.matchAll(/pid=([\s\S]*)_int/g));if(0!==n.length)return t=n[0][1],$.ruleForm.pid=t,t}if("Adjust"===r){var i=o(e.matchAll(/https:\/\/app.adjust.com\/([\s\S]*)\?/g));if(0!==i.length)return t=i[0][1],$.ruleForm.pid=t,t}return $.ruleForm.pid=t,t})),c((function(){var e,r=0;if(T.cacheDevice,T.cacheDevice.hasOwnProperty("all")&&T.cacheDevice.hasOwnProperty("select")){var t=T.cacheDevice.all,n=T.cacheDevice.select;0!==t.length&&0!==n.length&&t.forEach((function(e){n.forEach((function(t){e.source===t.source&&e.label===t.label&&(r+=parseInt(e.device_count))}))})),$.search.deviceData.count=r}return null!==(e=r)&&void 0!==e?e:$.search.deviceData.count})),d((function(){})),function(e,r){var t=s("el-form-item"),n=s("el-option"),i=s("el-select"),o=s("el-button"),a=s("el-input"),l=s("el-form"),u=s("el-dialog");return p(),m("div",j,[g(" form "),v(l,{ref_key:"ruleForm",ref:M,enctype:"multipart/form-data",rules:b(U),model:b(M),"label-width":"240px","label-position":"right"},{default:_((function(){return[D,h("div",S,[g(" id "),v(t,{label:"ID:",prop:"offer_id"},{default:_((function(){return[h("div",q,[h("span",{textContent:y(b(M).offer_id)},null,8,E)])]})),_:1}),g(" channel "),v(t,{label:"Channel:",prop:"channel"},{default:_((function(){return[v(i,{modelValue:b(M).channel,"onUpdate:modelValue":r[0]||(r[0]=function(e){return b(M).channel=e}),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:_((function(){return[(p(!0),m(F,null,w(b(J).channel,(function(e){return p(),O(n,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),g(" copy_offer "),v(t,{label:"Copy Offer:",prop:"copy_offer"},{default:_((function(){return[v(a,{modelValue:b(M).copy_offer,"onUpdate:modelValue":r[1]||(r[1]=function(e){return b(M).copy_offer=e}),modelModifiers:{trim:!0},class:"form-one copy-btn search-input",placeholder:""},{append:_((function(){return[v(o,{slot:"append",type:"primary",icon:"Search",onClick:Y})]})),_:1},8,["modelValue"])]})),_:1}),g(" offer_open_type "),v(t,{label:"Open Type:",prop:"offer_open_type"},{default:_((function(){return[v(i,{modelValue:b(M).offer_open_type,"onUpdate:modelValue":r[2]||(r[2]=function(e){return b(M).offer_open_type=e}),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:_((function(){return[(p(!0),m(F,null,w(b($).options.channel,(function(e){return p(),O(n,{key:e,label:e,value:e},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1})])]})),_:1},8,["rules","model"]),g(" form "),g(" footer "),h("div",V,[v(o,{type:"primary",onClick:z},{default:_((function(){return[P]})),_:1})]),g(" footer "),g(" dialog "),g(" device "),v(u,{modelValue:b($).dialogVisibleDevice,"onUpdate:modelValue":r[3]||(r[3]=function(e){return b($).dialogVisibleDevice=e}),title:"Device",width:"90%"},{default:_((function(){return[C,h("span",N,[g(' <el-button @click="cancleDevice">取 消</el-button> '),v(o,{type:"primary",onClick:K},{default:_((function(){return[I]})),_:1})])]})),_:1},8,["modelValue"])])}}}))}}}))}();
