var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{d as n,ah as c,z as s,C as d,ad as u,r as p,ai as m,k as b,v as f,i as h,x as v,h as g,j as y,O as _,c as w,P as V,o as k,F as D,l as x,y as F,t as C}from"./vendor-ede5cb5d.js";import{P as j}from"./index-4572c4a3.js";import{A as U,_ as z,a as O,b as P,c as A,d as S,e as E}from"./device-7ca54280.js";import{m as N}from"./message-980c806a.js";import{_ as Q}from"./lodash-79cb6bd1.js";import{o as I,a as $}from"./new-format-6b24aa44.js";import{b as B}from"./format-15e3f823.js";import{_ as L}from"./index-8cc29931.js";import"./moment-9bd84dc2.js";const M={class:"controlBox w100 mb-10"},T={class:"mb-10"},J=F("Offer Create"),K={class:"flex jc-start flex-wrap w100"},q={class:"flex"},G={class:"flex"},H=F(" 查询 "),R={class:"flex jc-around"},W={class:"flex jc-around"},X={class:"flex jc-between"},Y=["textContent"],Z={class:"flex jc-around"},ee={class:"w100 flex"},ae={class:"dialog-footer"},le=F("确 定"),te=n({name:"old-buzz"}),ie=n((oe=((e,a)=>{for(var l in a||(a={}))i.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e})({},te),a(oe,l({setup(e){const a=c({attribute_provider:[],platform:[],package_name:"",channel:"",id:"",offer_title:"",country:"",pid:""});let l=s({offer:{},index:null,cacheDevice:{},cacheDeviceCount:0}),t=s({dialogVisible:!1,dialogVisibleDevice:!1,cache:{item:{},device:{}},searchForm:a.value,useData:a.value,loading:!0,options:{cutoff_start:[...new Array(20)].map(((e,a)=>{const l=5*a/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),cutoff_end:[...new Array(20)].map(((e,a)=>{const l=(5*a+5)/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],platform:[{value:"1",label:"Android"},{value:"2",label:"iOS"}]},list:[],pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});const i=()=>{t.useData=Q.cloneDeep(t.searchForm),n()},o=()=>{I("/buzz/old-buzz-create")},r=e=>`/buzz/old-buzz-edit/${e.id}`,n=async()=>{t.loading=!0;let e={page:t.pagination.listQuery.page,page_size:t.pagination.listQuery.limit};t.useData.attribute_provider&&(e.attribute_provider=t.useData.attribute_provider),t.useData.platform&&(e.platform=t.useData.platform),t.useData.package_name&&(e.pkg_name=t.useData.package_name),t.useData.channel&&(e.channel=t.useData.channel),t.useData.id&&(e.offer_id=t.useData.id),t.useData.offer_title&&(e.title=t.useData.offer_title),t.useData.country&&(e.country=t.useData.country),t.useData.pid&&(e.tracking_link=t.useData.pid);const a=await U(e),{data:l}=a,{page:i}=l;t.list=null==l?void 0:l.data,t.pagination.total=Number(i.count),t.loading=!1},L=e=>{l.cacheDevice.select=e},te=e=>{l.cacheDeviceCount=e},ie=async()=>{const e={id:l.offer.id,device:JSON.stringify(l.cacheDevice.select)},a=await E(e);N(a),t.dialogVisibleDevice=!1,l.offer.device_count=l.cacheDeviceCount};return d((()=>{i()})),u((()=>{})),(e,a)=>{const c=p("el-button"),s=p("el-option"),d=p("el-select"),u=p("el-form-item"),U=p("el-input"),E=p("el-form"),Q=p("el-table-column"),oe=p("el-switch"),re=p("el-table"),ne=p("el-dialog"),ce=m("loading");return k(),b("div",null,[f("div",M,[f("div",T,[h(' <router-link to="/buzz/old-buzz-create">\n          <el-button type="primary">\n            Offer Create\n          </el-button>\n        </router-link> '),v(c,{type:"primary",onClick:o},{default:g((()=>[J])),_:1})]),v(E,{modelValue:y(t).searchForm,"onUpdate:modelValue":a[8]||(a[8]=e=>y(t).searchForm=e),inline:!0,class:"flex jc-between w100 ai-end"},{default:g((()=>[f("div",K,[v(u,{label:""},{default:g((()=>[v(d,{modelValue:y(t).searchForm.attribute_provider,"onUpdate:modelValue":a[0]||(a[0]=e=>y(t).searchForm.attribute_provider=e),clearable:"",class:"search-con",placeholder:"Attribute Provider",style:{"min-width":"140px"}},{default:g((()=>[(k(!0),b(D,null,x(y(t).options.attribute_provider,(e=>(k(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(u,{label:""},{default:g((()=>[v(d,{modelValue:y(t).searchForm.platform,"onUpdate:modelValue":a[1]||(a[1]=e=>y(t).searchForm.platform=e),clearable:"",class:"search-con",placeholder:"Platform",style:{"min-width":"95px"}},{default:g((()=>[(k(!0),b(D,null,x(y(t).options.platform,(e=>(k(),w(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(u,{label:""},{default:g((()=>[v(U,{modelValue:y(t).searchForm.package_name,"onUpdate:modelValue":a[2]||(a[2]=e=>y(t).searchForm.package_name=e),placeholder:"Package Name",class:"search-con",style:{"min-width":"120px"}},null,8,["modelValue"])])),_:1}),v(u,{label:""},{default:g((()=>[v(U,{modelValue:y(t).searchForm.channel,"onUpdate:modelValue":a[3]||(a[3]=e=>y(t).searchForm.channel=e),placeholder:"Channel",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),v(u,{label:""},{default:g((()=>[v(U,{modelValue:y(t).searchForm.id,"onUpdate:modelValue":a[4]||(a[4]=e=>y(t).searchForm.id=e),placeholder:"ID",class:"search-con"},null,8,["modelValue"])])),_:1}),v(u,{label:""},{default:g((()=>[v(U,{modelValue:y(t).searchForm.offer_title,"onUpdate:modelValue":a[5]||(a[5]=e=>y(t).searchForm.offer_title=e),placeholder:"Offer Title",class:"search-con",style:{"min-width":"90px"}},null,8,["modelValue"])])),_:1}),v(u,{label:""},{default:g((()=>[v(U,{modelValue:y(t).searchForm.country,"onUpdate:modelValue":a[6]||(a[6]=e=>y(t).searchForm.country=e),placeholder:"Country",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),v(u,{label:""},{default:g((()=>[v(U,{modelValue:y(t).searchForm.pid,"onUpdate:modelValue":a[7]||(a[7]=e=>y(t).searchForm.pid=e),placeholder:"Pid",class:"search-con"},null,8,["modelValue"])])),_:1})]),f("div",q,[v(u,{class:"mr-0",style:{"margin-right":"0px"}},{default:g((()=>[f("div",G,[v(c,{type:"primary",onClick:i},{default:g((()=>[H])),_:1}),h(' <el-button type="primary" @click="handleExportSearch">导出</el-button> ')])])),_:1})])])),_:1},8,["modelValue"]),h(' <el-input placeholder="请输入内容" v-model="data.searchForm.data" class=\'search-input\'>\n        <el-button slot="append" icon="Search" @click=\'searchFun\'></el-button>\n      </el-input> ')]),h(" table "),_((k(),w(re,{center:"",data:y(t).list,class:"w100",height:"70vh",border:""},{default:g((()=>[v(Q,{fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"70"}),v(Q,{fixed:"",prop:"channel",label:"Channel",align:"center",width:"60"}),v(Q,{prop:"pkg_name",label:"Package Name",align:"center",width:"110"}),v(Q,{prop:"title",label:"Offer Title",align:"center"}),v(Q,{prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),v(Q,{prop:"pid",label:"Pid",align:"center",width:"90"}),v(Q,{prop:"platform",label:"Platform",align:"center",width:"65"},{default:g((e=>[F(C(1===Number(e.row.platform)?"Android":"iOS"),1)])),_:1}),v(Q,{prop:"country",label:"Country",align:"center",width:"57"}),v(Q,{prop:"payout",label:"Payout",align:"center",width:"55"}),v(Q,{label:"Click Limitation",width:"150",align:"center"},{default:g((e=>[f("div",R,[v(U,{modelValue:e.row.max_clk_num,"onUpdate:modelValue":a=>e.row.max_clk_num=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),v(c,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,max_clk_num:parseFloat(e.max_clk_num)},l=await O(a);N(l)})(e.row)},null,8,["onClick"])])])),_:1}),v(Q,{label:"Site Click Limitation",width:"150",align:"center"},{default:g((e=>[f("div",W,[v(U,{modelValue:e.row.site_clk_limit,"onUpdate:modelValue":a=>e.row.site_clk_limit=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),v(c,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,site_clk_limit:parseFloat(e.site_clk_limit)},l=await P(a);N(l)})(e.row)},null,8,["onClick"])])])),_:1}),v(Q,{label:"Select Device",width:"120",align:"center"},{default:g((e=>[f("div",X,[f("span",{textContent:C(y(B)(e.row.device_count))},null,8,Y),v(c,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async(e,a)=>{t.dialogVisibleDevice=!0,l.offer=a,l.index=e;const i={id:a.id,platform:a.platform,country:a.country},{data:o}=await S(i);l.cacheDevice.all=o.all,l.cacheDevice.select=o.select})(e.$index,e.row)},null,8,["onClick"])])])),_:1}),v(Q,{label:"Operation",align:"center"},{default:g((e=>[f("div",Z,[h(' <router-link :to="getEditUrl(scope.row)">\n              <el-button\n                class="cp mr-10"\n                type="primary"\n                icon="Edit"\n                circle\n              ></el-button>\n            </router-link> '),v(c,{class:"cp mr-10",type:"primary",icon:"Edit",circle:"",onClick:a=>(e=>{let a=r(e);I(a)})(e.row)},null,8,["onClick"]),v(oe,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,onChange:a=>(async e=>{let a={id:e.id,status:e.status};a=$(a);const l=await A(a);N(l)})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),_:1})])),_:1},8,["data"])),[[ce,y(t).loading]]),h(" 分页 "),f("div",ee,[_(v(y(j),{page:y(t).pagination.listQuery.page,"onUpdate:page":a[9]||(a[9]=e=>y(t).pagination.listQuery.page=e),limit:y(t).pagination.listQuery.limit,"onUpdate:limit":a[10]||(a[10]=e=>y(t).pagination.listQuery.limit=e),total:y(t).pagination.total,"page-sizes":y(t).pagination.pageSizes,onPagination:n},null,8,["page","limit","total","page-sizes"]),[[V,y(t).pagination.total]])]),h(" device "),v(ne,{modelValue:y(t).dialogVisibleDevice,"onUpdate:modelValue":a[13]||(a[13]=e=>y(t).dialogVisibleDevice=e),title:"Device"},{default:g((()=>[y(t).dialogVisibleDevice?(k(),w(z,{key:0,all:y(l).cacheDevice.all,"onUpdate:all":a[11]||(a[11]=e=>y(l).cacheDevice.all=e),select:y(l).cacheDevice.select,"onUpdate:select":a[12]||(a[12]=e=>y(l).cacheDevice.select=e),onKk:L,onCount:te},null,8,["all","select"])):h("v-if",!0),f("span",ae,[h(' <el-button @click="cancleDevice">取 消</el-button> '),v(c,{type:"primary",onClick:ie},{default:g((()=>[le])),_:1})])])),_:1},8,["modelValue"])])}}}))));var oe,re=L(ie,[["__scopeId","data-v-0b56db22"]]);export{re as default};
