var e=Object.defineProperty,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,o=(l,r,a)=>r in l?e(l,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[r]=a,t=(e,t)=>{for(var s in t||(t={}))r.call(t,s)&&o(e,s,t[s]);if(l)for(var s of l(t))a.call(t,s)&&o(e,s,t[s]);return e};import{_ as s,d,n as m,h as u,r as i,L as n,q as c,o as p,c as f,z as _,e as v,s as b,v as g,x as y,P as h,A as F,y as V,N as w,O as x,f as U,g as k}from"./main-77664c91.js";import{u as j,s as q}from"./useUtils-28f81788.js";import{c as z,d as M,e as O}from"./dsp-advertiser-56f26069.js";import{m as P}from"./message-8851d7ea.js";import{_ as L}from"./index-47856ebd.js";import{e as C,g as I}from"./new-format-983f47e1.js";import{_ as R}from"./lodash-5c8c0787.js";const D={class:"content-con from-one flex column"},S=["src"],E={class:"content-con from-one flex column"},N={class:"content-con from-one flex column"},$={class:"content-con from-one flex column"},A={class:"w100 flex"},B=U(" 确认 "),G=U(" 取消 ");var H=s(d({setup(e){const{adv_type:l,ind_cla:r,third_party:a,return_mode:o,time_zone:s}=q,{getRouterData:d,getCommonCountryList:U,goNewUrl:H}=j();let{proxy:J}=k();const K="此项必填";let Q={token:m()},T=u("/prod-api/d/dv/pic"),W=u("create");const X={id:void 0,adv_id:"",name:"",desc:"",adv_type:"",adv_address:"",ind_cla:"",logo:"",time_zone:"",price:void 0,spend_limit:void 0,flow_rate:void 0,third_party:"",click_url:"",impression_url:"",return_mode:"",is_del:0},Y=(e,l,r)=>{const{max:a}=e;var o,t;t=a,!(o=l)||o.toString().length<t?r(void 0):r(new Error("值的长度不能大于${}"))},Z=i({ruleForm:X,rules:{name:[{required:!0,message:K,trigger:["blur","change"]},{validator:Y,max:100,trigger:["blur","change"]}],desc:[{validator:Y,max:200,trigger:["blur","change"]}],adv_type:[{required:!0,message:K,trigger:["blur","change"]}],adv_address:[{required:!0,message:K,trigger:["blur","change"]}],ind_cla:[{required:!0,message:K,trigger:["blur","change"]}],price:[{required:!0,message:K,trigger:["blur","change"]}],spend_limit:[{required:!0,message:K,trigger:["blur","change"]}],third_party:[{required:!0,message:K,trigger:["blur","change"]}]},options:{adv_type:l,ind_cla:r,time_zone:s,third_party:a,return_mode:o}}),ee=()=>{J.$refs.ruleForm.validate((e=>{if(!e)return!1;ae()}))},le=["id","price","spend_limit","flow_rate"],re=[],ae=async()=>{let e=h(Z.ruleForm);if(e=C(e,le),e=I(e,re),"create"===W.value){delete e.id;const l=await z(e);P(l)&&oe()}if("edit"===W.value){const l=await M(e);P(l)&&oe()}},oe=()=>{H({url:"/advertiser/list"})},te=(e,l)=>{Z.ruleForm.logo=e.data},se=e=>{const l="image/png"===e.type,r=e.size/1048576<100,a=new Promise((function(l,r){let a=window.URL||window.webkitURL,o=new Image;o.onload=function(){let e=o.width<=100&&o.height<=100;e=!0,l(null)},o.src=a.createObjectURL(e)})).then((()=>e),(()=>(console.error("图片尺寸过大,请上传100*100尺寸的图片"),Promise.reject())));return l||console.error("格式错误，请上传png格式图片"),r||console.error("文件过大，文件大小不超过100M"),l&&r&&a},de=()=>{var e,l;let{query:r,params:a}=d();if(W.value=null!=(l=null==(e=r.type)?void 0:e.toString())?l:"",(async()=>{})(),"create"===W.value&&(Z.ruleForm=R.cloneDeep(X)),"edit"===W.value){const{id:e}=a;(async e=>{const l=await O(e),{data:r}=l;Z.ruleForm=t(t({},Z.ruleForm),r),Z.ruleForm})(e)}};return n((()=>{de()})),(e,l)=>{const r=c("el-form-item"),a=c("el-input"),o=c("el-option"),t=c("el-select"),s=c("Plus"),d=c("el-icon"),m=c("el-upload"),u=c("el-form"),i=c("el-button");return p(),f("div",null,[_(" form "),v(u,{ref:"ruleForm",enctype:"multipart/form-data",rules:g(Z).rules,model:g(Z).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===g(W)&&2===g(Z).ruleForm.is_del},{default:b((()=>[v(g(L),{title:"基础信息"}),y("div",D,["edit"===g(W)?(p(),F(r,{key:0,class:"self-el-form-item",label:"广告主ID:",prop:"adv_id"},{default:b((()=>[y("span",null,V(g(Z).ruleForm.adv_id),1)])),_:1})):_("v-if",!0),v(r,{class:"self-el-form-item",label:"广告主名称:",prop:"name"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>g(Z).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"描述:",prop:"desc"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.desc,"onUpdate:modelValue":l[1]||(l[1]=e=>g(Z).ruleForm.desc=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"广告主类型:",prop:"adv_type"},{default:b((()=>[v(t,{modelValue:g(Z).ruleForm.adv_type,"onUpdate:modelValue":l[2]||(l[2]=e=>g(Z).ruleForm.adv_type=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:b((()=>[(p(!0),f(w,null,x(g(Z).options.adv_type,(e=>(p(),F(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"广告主地址:",prop:"adv_address"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.adv_address,"onUpdate:modelValue":l[3]||(l[3]=e=>g(Z).ruleForm.adv_address=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"行业分类:",prop:"ind_cla"},{default:b((()=>[v(t,{modelValue:g(Z).ruleForm.ind_cla,"onUpdate:modelValue":l[4]||(l[4]=e=>g(Z).ruleForm.ind_cla=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:b((()=>[(p(!0),f(w,null,x(g(Z).options.ind_cla,(e=>(p(),F(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"Logo:",prop:"logo"},{default:b((()=>[v(m,{class:"avatar-uploader",name:"logo_url",action:g(T),"show-file-list":!1,"on-success":te,"before-upload":se,headers:g(Q)},{default:b((()=>[g(Z).ruleForm.logo?(p(),f("img",{key:0,src:g(Z).ruleForm.logo,class:"avatar"},null,8,S)):(p(),F(d,{key:1,class:"avatar-uploader-icon"},{default:b((()=>[v(s)])),_:1}))])),_:1},8,["action","headers"])])),_:1})]),v(g(L),{title:"Offer信息"}),y("div",E,[v(r,{class:"self-el-form-item",label:"选择时区:",prop:"time_zone"},{default:b((()=>[v(t,{modelValue:g(Z).ruleForm.time_zone,"onUpdate:modelValue":l[5]||(l[5]=e=>g(Z).ruleForm.time_zone=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:b((()=>[(p(!0),f(w,null,x(g(Z).options.time_zone,(e=>(p(),F(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"转化单价（美元）:",prop:"price"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.price,"onUpdate:modelValue":l[6]||(l[6]=e=>g(Z).ruleForm.price=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number",step:"0.001"},null,8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"日花费上限（美元）:",prop:"spend_limit"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.spend_limit,"onUpdate:modelValue":l[7]||(l[7]=e=>g(Z).ruleForm.spend_limit=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"强制流量占比%:",prop:"flow_rate"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.flow_rate,"onUpdate:modelValue":l[8]||(l[8]=e=>g(Z).ruleForm.flow_rate=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1})]),v(g(L),{title:"追踪信息"}),y("div",N,[v(r,{class:"self-el-form-item",label:"第三方监测平台:",prop:"third_party"},{default:b((()=>[v(t,{modelValue:g(Z).ruleForm.third_party,"onUpdate:modelValue":l[9]||(l[9]=e=>g(Z).ruleForm.third_party=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:b((()=>[(p(!0),f(w,null,x(g(Z).options.third_party,(e=>(p(),F(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"点击监测链接:",prop:"click_url"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.click_url,"onUpdate:modelValue":l[10]||(l[10]=e=>g(Z).ruleForm.click_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),v(r,{class:"self-el-form-item",label:"曝光监测链接:",prop:"impression_url"},{default:b((()=>[v(a,{modelValue:g(Z).ruleForm.impression_url,"onUpdate:modelValue":l[11]||(l[11]=e=>g(Z).ruleForm.impression_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),v(g(L),{title:"数据回传"}),y("div",$,[v(r,{class:"self-el-form-item",label:"回传方式:",prop:"return_mode"},{default:b((()=>[v(t,{modelValue:g(Z).ruleForm.return_mode,"onUpdate:modelValue":l[12]||(l[12]=e=>g(Z).ruleForm.return_mode=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:b((()=>[(p(!0),f(w,null,x(g(Z).options.return_mode,(e=>(p(),F(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),_(" form "),_(" footer "),y("div",A,[v(i,{type:"primary",onClick:ee},{default:b((()=>[B])),_:1}),v(i,{type:"primary",onClick:oe},{default:b((()=>[G])),_:1})])])}}}),[["__scopeId","data-v-f702f7e8"]]);export{H as default};
