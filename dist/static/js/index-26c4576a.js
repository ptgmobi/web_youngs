var F=Object.defineProperty;var f=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var h=(t,e,a)=>e in t?F(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,g=(t,e)=>{for(var a in e||(e={}))T.call(e,a)&&h(t,a,e[a]);if(f)for(var a of f(e))A.call(e,a)&&h(t,a,e[a]);return t};import{af as R,r as n,i as D,c,f as s,g as _,v as o,o as d,x as m,t as y,F as N,j as B,s as L}from"./vendor-a4cb0bb5.js";import{g as P}from"./power-722de63b.js";import{g as U,a as z,s as I,b as G}from"./role-46c11521.js";import{m as V}from"./message-67f5983c.js";import{m as O}from"./self-26d919d8.js";import{_ as S}from"./index-b990cc85.js";const q={mixins:[O],components:{},data(){return{options:{permissions:[]},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",permissions:[]},choiceData:{}}}},computed:g({},R(["element"])),created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:t}=await P();this.options.permissions=t.permission},async getList(){const{data:t}=await U();this.data=t,this.list=t},handleCreate(){this.dialogType="new",this.busData.item.type="",this.busData.item.name="",this.busData.item.permissions=[],this.dialogVisible=!0;const t=new Date;this.date=t.getTime()},async handleEdit(t){this.dialogType="edit",this.busData.item.id=t.row.id;const{data:e}=await z(this.busData.item.id);this.busData.item.name=e.role.name,this.busData.item.permissions=e.role_permission,this.dialogVisible=!0;const a=new Date;this.date=a.getTime()},handleDelete(t){},roleChangeChoice(t,e){this.busData.choiceData[t]=e},async submitFn(){if(this.dialogType==="new"){const t={name:this.busData.item.name,permission_id:this.busData.item.permissions},e=await I(t);e&&V(e),this.getList()}if(this.dialogType==="edit"){const t={role_id:this.busData.item.id,permission_id:this.busData.item.permissions},e=await G(this.busData.item.id,t);e&&V(e)}this.dialogVisible=!1}}},H={class:"app-container"},J=m("\u65B0\u5EFA"),K=m(" \u4FEE\u6539 "),M=m(" \u5220\u9664 "),Q={slot:"footer",class:"dialog-footer"},W=m("\u53D6 \u6D88"),X=m("\u786E \u5B9A");function Y(t,e,a,Z,l,u){const r=n("el-button"),p=n("el-table-column"),w=n("el-table"),C=n("el-input"),b=n("el-form-item"),k=n("el-option"),v=n("el-select"),E=n("el-form"),j=n("el-dialog");return d(),D("div",H,[t.judgePermissionElementFn("A-AR-ADD-V")?(d(),c(r,{key:0,type:"primary",onClick:u.handleCreate},{default:s(()=>[J]),_:1},8,["onClick"])):_("v-if",!0),o(w,{data:l.list,style:{width:"100%","margin-top":"30px"},border:""},{default:s(()=>[o(p,{align:"center",label:"ID"},{default:s(i=>[m(y(i.row.id),1)]),_:1}),o(p,{align:"center",label:"Name"},{default:s(i=>[m(y(i.row.name),1)]),_:1}),o(p,{align:"center",label:"Operations"},{default:s(i=>[t.judgePermissionElementFn("A-AR-EDIT-V")?(d(),c(r,{key:0,type:"primary",size:"small",onClick:x=>u.handleEdit(i)},{default:s(()=>[K]),_:2},1032,["onClick"])):_("v-if",!0),t.judgePermissionElementFn("A-AR-DEL-V")?(d(),c(r,{key:1,type:"danger",size:"small",onClick:x=>u.handleDelete(i)},{default:s(()=>[M]),_:2},1032,["onClick"])):_("v-if",!0)]),_:1})]),_:1},8,["data"]),o(j,{modelValue:l.dialogVisible,"onUpdate:modelValue":e[3]||(e[3]=i=>l.dialogVisible=i),title:l.dialogType==="edit"?"Edit Role":"New Role",width:"90%"},{default:s(()=>[o(E,{"label-width":"150px","label-position":"left"},{default:s(()=>[o(b,{label:"Name"},{default:s(()=>[o(C,{modelValue:l.busData.item.name,"onUpdate:modelValue":e[0]||(e[0]=i=>l.busData.item.name=i),placeholder:"",disabled:l.dialogType==="edit"},null,8,["modelValue","disabled"])]),_:1}),o(b,{label:"Permissions"},{default:s(()=>[o(v,{modelValue:l.busData.item.permissions,"onUpdate:modelValue":e[1]||(e[1]=i=>l.busData.item.permissions=i),filterable:"",multiple:"",clearable:"",class:"w100",placeholder:"\u652F\u6301\u591A\u9009"},{default:s(()=>[(d(!0),D(N,null,B(l.options.permissions,i=>(d(),c(k,{key:i.id,label:i.type,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),L("div",Q,[o(r,{onClick:e[2]||(e[2]=i=>l.dialogVisible=!1)},{default:s(()=>[W]),_:1}),o(r,{type:"primary",onClick:u.submitFn},{default:s(()=>[X]),_:1},8,["onClick"])])]),_:1},8,["modelValue","title"])])}var le=S(q,[["render",Y]]);export{le as default};
