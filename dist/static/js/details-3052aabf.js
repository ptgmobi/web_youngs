import{d as e,h as l,r as a,L as o,q as r,c as t,z as s,e as m,s as d,v as i,x as u,P as f,o as n,y as c,f as p,g as _}from"./main-ce43ffdd.js";import{b as F,c as b,d as y}from"./tool-149ce53d.js";import{m as g}from"./message-1c1d9ef1.js";import{_ as v}from"./index-aa162cf4.js";import{u as w}from"./useUtils-d1805f03.js";import{d as V,e as h,f as x}from"./new-format-368dcfb0.js";import{_ as j}from"./lodash-6b3789ad.js";const U={class:"content-con from-one flex column"},q={class:"content-con from-one flex column"},C={class:"w100 flex"},D=e({__name:"details",setup(e){const{getRouterData:D,getCommonCountryList:M,goNewUrl:k}=w();let{proxy:I}=_();const L="此项必填";let z=l("create");const N={id:"",ad_id:"",ad_name:"",desc:"",flow_rate:""},P=a({ruleForm:N,rules:{ad_name:[{required:!0,message:L,trigger:["blur","change"]}],flow_rate:[{required:!0,message:L,trigger:["blur","change"]}]},options:{}}),R=()=>{I.$refs.ruleForm.validate((e=>{if(!e)return!1;A()}))},S=["flow_rate"],$=[],A=async()=>{let e=f(P.ruleForm);if(e=V(e),e=h(e,S),"create"===z.value){delete e.id;const l=await F(e);g(l)&&B()}if("edit"===z.value){const l=await b(e);g(l)&&B()}},B=()=>{let e="";"create"===z.value&&(e="./list"),"edit"===z.value&&(e="../list"),k({url:e})},E=()=>{var e,l;let{query:a,params:o}=D();if(a.type,z.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",(async()=>{})(),"create"===z.value&&(P.ruleForm=j.cloneDeep(N)),"edit"===z.value){const{id:e}=o;(async e=>{const l=await y(e),{data:a}=l;P.ruleForm=x(a,$)})(e)}};return o((()=>{E()})),(e,l)=>{const a=r("el-form-item"),o=r("el-input"),f=r("el-form"),_=r("el-button");return n(),t("div",null,[s(" form "),m(f,{ref:"ruleForm",enctype:"multipart/form-data",rules:i(P).rules,model:i(P).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===i(z)&&2===i(P).ruleForm.is_del},{default:d((()=>[m(i(v),{title:"基本信息"}),u("div",U,[m(a,{class:"self-el-form-item",label:"ID:",prop:"id"},{default:d((()=>[u("span",null,c(i(P).ruleForm.id),1)])),_:1}),m(a,{class:"self-el-form-item",label:"广告主名称:",prop:"ad_name"},{default:d((()=>[m(o,{modelValue:i(P).ruleForm.ad_name,"onUpdate:modelValue":l[0]||(l[0]=e=>i(P).ruleForm.ad_name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"广告主ID:",prop:"ad_id"},{default:d((()=>[m(o,{modelValue:i(P).ruleForm.ad_id,"onUpdate:modelValue":l[1]||(l[1]=e=>i(P).ruleForm.ad_id=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"描述:",prop:"desc"},{default:d((()=>[m(o,{modelValue:i(P).ruleForm.desc,"onUpdate:modelValue":l[2]||(l[2]=e=>i(P).ruleForm.desc=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),m(i(v),{title:"广告主配置"}),u("div",q,[m(a,{class:"self-el-form-item",label:"强制流量占比(%):",prop:"flow_rate"},{default:d((()=>[m(o,{modelValue:i(P).ruleForm.flow_rate,"onUpdate:modelValue":l[3]||(l[3]=e=>i(P).ruleForm.flow_rate=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number"},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),s(" form "),s(" footer "),u("div",C,[m(_,{type:"primary",onClick:R},{default:d((()=>[p(" 确认 ")])),_:1}),m(_,{type:"primary",onClick:B},{default:d((()=>[p(" 取消 ")])),_:1})])])}}});export{D as default};
