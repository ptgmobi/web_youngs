var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(l,a,r)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[a]=r,t=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&o(e,s,t[s]);if(l)for(var s of l(t))r.call(t,s)&&o(e,s,t[s]);return e};import{_ as s,d,h as u,r as m,L as i,q as n,o as c,c as p,z as f,e as _,s as v,v as b,x as g,P as y,A as h,y as F,N as V,O as w,K as U,f as x,g as j}from"./main-c289050e.js";import{u as k,s as q}from"./useUtils-034ffd86.js";import{b as z,c as M,d as O}from"./dsp-advertiser-d95bf0ce.js";import{m as P}from"./message-7c571a95.js";import{_ as L}from"./index-0855a96e.js";import{d as C,e as R}from"./new-format-0cb28217.js";import{s as I}from"./validate-31aaa08c.js";import{_ as D}from"./lodash-6a3426b2.js";import{u as E}from"./upload-55b5b058.js";const N={class:"content-con from-one flex column"},S=["src"],$={class:"content-con from-one flex column"},A={class:"content-con from-one flex column"},H={class:"content-con from-one flex column"},K={class:"w100 flex"},T=x(" 确认 "),B=x(" 取消 ");var G=s(d({setup(e){const{validate:l,uploadHttpRequest:a}=E,{uploadUrl:r,adv_type:o,ind_cla:s,third_party:d,return_mode:x,time_zone:G}=q,{getRouterData:J,getCommonCountryList:Q,goNewUrl:W}=k();let{proxy:X}=j();const Y="此项必填";let Z=u("create"),ee=u([]);const le={id:void 0,adv_id:"",name:"",descs:"",adv_type:"",adv_address:"",ind_cla:"",logo:"",time_zone:"UTC+8",price:void 0,spend_limit:void 0,flow_rate:void 0,third_party:"",click_url:"",impression_url:"",return_mode:"",is_del:0},ae=(e,l,a)=>{const{max:r}=e;I(l,r)?a(void 0):a(new Error("值的长度不能大于${}"))},re=m({ruleForm:le,rules:{name:[{required:!0,message:Y,trigger:["blur","change"]},{validator:ae,max:100,trigger:["blur","change"]}],descs:[{validator:ae,max:200,trigger:["blur","change"]}],adv_type:[{required:!0,message:Y,trigger:["blur","change"]}],adv_address:[{required:!0,message:Y,trigger:["blur","change"]}],ind_cla:[{required:!0,message:Y,trigger:["blur","change"]}],price:[{required:!0,message:Y,trigger:["blur","change"]}],spend_limit:[{required:!0,message:Y,trigger:["blur","change"]}],third_party:[{required:!0,message:Y,trigger:["blur","change"]}]},options:{adv_type:o,ind_cla:s,time_zone:G,third_party:d,return_mode:x}}),oe=()=>{X.$refs.ruleForm.validate((e=>{if(!e)return!1;se()}))},te=["id","price","spend_limit","flow_rate"],se=async()=>{let e=y(re.ruleForm);if(e=C(e),e=R(e,te),"create"===Z.value){delete e.id;const l=await z(e);P(l)&&de()}if("edit"===Z.value){const l=await M(e);P(l)&&de()}},de=()=>{W({url:"/advertiser/list"})},ue=(e,l)=>{re.ruleForm.logo=e.data},me=async e=>{const l="image/png"===e.type,a=e.size/1048576<100,r=new Promise((function(l,a){let r=window.URL||window.webkitURL,o=new Image;o.onload=function(){let e=o.width<=100&&o.height<=100;e=!0,l(null)},o.src=r.createObjectURL(e)})).then((()=>e),(()=>(console.error("图片尺寸过大,请上传100*100尺寸的图片"),Promise.reject())));return l||console.error("格式错误，请上传png格式图片"),a||console.error("文件过大，文件大小不超过100M"),r},ie=()=>{var e,l;let{query:a,params:r}=J();if(Z.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",(async()=>{})(),"create"===Z.value&&(re.ruleForm=D.cloneDeep(le)),"edit"===Z.value){const{id:e}=r;(async e=>{const l=await O(e),{data:a}=l;re.ruleForm=t(t({},re.ruleForm),a),ee.value=[{name:"logo_url",url:re.ruleForm.logo}],re.ruleForm})(e)}};return i((()=>{ie()})),(e,l)=>{const r=n("el-form-item"),o=n("el-input"),t=n("el-option"),s=n("el-select"),d=n("Plus"),u=n("el-icon"),m=n("el-upload"),i=n("el-form"),y=n("el-button");return c(),p("div",null,[f(" form "),_(i,{ref:"ruleForm",enctype:"multipart/form-data",rules:b(re).rules,model:b(re).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===b(Z)&&2===b(re).ruleForm.is_del},{default:v((()=>[_(b(L),{title:"基础信息"}),g("div",N,["edit"===b(Z)?(c(),h(r,{key:0,class:"self-el-form-item",label:"广告主ID:",prop:"adv_id"},{default:v((()=>[g("span",null,F(b(re).ruleForm.adv_id),1)])),_:1})):f("v-if",!0),_(r,{class:"self-el-form-item",label:"广告主名称:",prop:"name"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>b(re).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"描述:",prop:"descs"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.descs,"onUpdate:modelValue":l[1]||(l[1]=e=>b(re).ruleForm.descs=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"广告主类型:",prop:"adv_type"},{default:v((()=>[_(s,{modelValue:b(re).ruleForm.adv_type,"onUpdate:modelValue":l[2]||(l[2]=e=>b(re).ruleForm.adv_type=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:v((()=>[(c(!0),p(V,null,w(b(re).options.adv_type,(e=>(c(),h(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"广告主地址:",prop:"adv_address"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.adv_address,"onUpdate:modelValue":l[3]||(l[3]=e=>b(re).ruleForm.adv_address=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"行业分类:",prop:"ind_cla"},{default:v((()=>[_(s,{modelValue:b(re).ruleForm.ind_cla,"onUpdate:modelValue":l[4]||(l[4]=e=>b(re).ruleForm.ind_cla=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:v((()=>[(c(!0),p(V,null,w(b(re).options.ind_cla,(e=>(c(),h(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"Logo:",prop:"logo"},{default:v((()=>[_(m,{class:"avatar-uploader",name:"logo_url",action:"","file-list":b(ee),"onUpdate:file-list":l[5]||(l[5]=e=>U(ee)?ee.value=e:ee=e),"show-file-list":!1,"on-success":ue,"before-upload":me,"http-request":b(a)},{default:v((()=>[b(re).ruleForm.logo?(c(),p("img",{key:0,src:b(re).ruleForm.logo,class:"avatar"},null,8,S)):(c(),h(u,{key:1,class:"avatar-uploader-icon"},{default:v((()=>[_(d)])),_:1}))])),_:1},8,["file-list","http-request"])])),_:1})]),_(b(L),{title:"Offer信息"}),g("div",$,[_(r,{class:"self-el-form-item",label:"选择时区:",prop:"time_zone"},{default:v((()=>[_(s,{modelValue:b(re).ruleForm.time_zone,"onUpdate:modelValue":l[6]||(l[6]=e=>b(re).ruleForm.time_zone=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:v((()=>[(c(!0),p(V,null,w(b(re).options.time_zone,(e=>(c(),h(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"转化单价（美元）:",prop:"price"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.price,"onUpdate:modelValue":l[7]||(l[7]=e=>b(re).ruleForm.price=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number",step:"0.001"},null,8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"日花费上限（美元）:",prop:"spend_limit"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.spend_limit,"onUpdate:modelValue":l[8]||(l[8]=e=>b(re).ruleForm.spend_limit=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"强制流量占比%:",prop:"flow_rate"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.flow_rate,"onUpdate:modelValue":l[9]||(l[9]=e=>b(re).ruleForm.flow_rate=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1})]),_(b(L),{title:"追踪信息"}),g("div",A,[_(r,{class:"self-el-form-item",label:"第三方监测平台:",prop:"third_party"},{default:v((()=>[_(s,{modelValue:b(re).ruleForm.third_party,"onUpdate:modelValue":l[10]||(l[10]=e=>b(re).ruleForm.third_party=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:v((()=>[(c(!0),p(V,null,w(b(re).options.third_party,(e=>(c(),h(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"点击监测链接:",prop:"click_url"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.click_url,"onUpdate:modelValue":l[11]||(l[11]=e=>b(re).ruleForm.click_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),_(r,{class:"self-el-form-item",label:"曝光监测链接:",prop:"impression_url"},{default:v((()=>[_(o,{modelValue:b(re).ruleForm.impression_url,"onUpdate:modelValue":l[12]||(l[12]=e=>b(re).ruleForm.impression_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),_(b(L),{title:"数据回传"}),g("div",H,[_(r,{class:"self-el-form-item",label:"回传方式:",prop:"return_mode"},{default:v((()=>[_(s,{modelValue:b(re).ruleForm.return_mode,"onUpdate:modelValue":l[13]||(l[13]=e=>b(re).ruleForm.return_mode=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:v((()=>[(c(!0),p(V,null,w(b(re).options.return_mode,(e=>(c(),h(t,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),f(" form "),f(" footer "),g("div",K,[_(y,{type:"primary",onClick:oe},{default:v((()=>[T])),_:1}),_(y,{type:"primary",onClick:de},{default:v((()=>[B])),_:1})])])}}}),[["__scopeId","data-v-f702f7e8"]]);export{G as default};
