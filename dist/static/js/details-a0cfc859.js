var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,r=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,o=(e,o)=>{for(var u in o||(o={}))a.call(o,u)&&r(e,u,o[u]);if(l)for(var u of l(o))t.call(o,u)&&r(e,u,o[u]);return e};import{d as u,z as i,w as s,C as n,r as d,o as c,k as m,v as p,x as f,h as _,F as v,l as g,c as b,j as y,i as h,y as F,a as V,b as w,aj as k,t as x,ac as U,q as j,s as C,m as q,f as S,ae as P,ai as O,O as A,K as R,S as D}from"./vendor-ede5cb5d.js";import{_ as T}from"./lodash-79cb6bd1.js";import{l as E,p as N,q as I,r as L,s as z,t as K,u as M,v as B,w as $}from"./fenix-af07bf23.js";import{c as J}from"./clipboard-d56e9819.js";import{m as Z}from"./message-e435e9f7.js";import{b as G,r as H}from"./new-format-6b24aa44.js";import{_ as Q}from"./index-d6905856.js";const W={class:"flex jc-end"},X=F(" Add "),Y={class:"flex"},ee=F(" Copy "),le=u({props:{list:{require:!0,default:()=>[],type:Array},offer:{require:!0,default:"",type:String}},emits:["kk","up"],setup(e,{emit:l}){const a=e,t=i({pub:[{id:"",pub_name:""}]}),r={55527824:.1,95108831:.1,95846929:.005,59845210:.005};let o=i({manage_traffic:[]});const u={pub:"",slotid:"",payout:void 0,cap_daily:void 0,pub_status:1,pub_tracking_link:""},F=()=>{o.manage_traffic.push(T.cloneDeep(u))};return s((()=>a.list),((e,l)=>{o.manage_traffic=e}),{immediate:!0,deep:!0}),s((()=>o.manage_traffic),((e,l)=>{}),{immediate:!0,deep:!0}),n((()=>{(async()=>{const{data:e}=await E();t.pub=e})(),F()})),(e,l)=>{const u=d("el-button"),i=d("el-option"),s=d("el-select"),n=d("el-table-column"),V=d("el-input"),w=d("el-switch"),k=d("el-table");return c(),m("div",null,[p("div",W,[f(u,{type:"primary",onClick:F},{default:_((()=>[X])),_:1})]),f(k,{class:"mt-10",data:y(o).manage_traffic,style:{width:"100%"},border:""},{default:_((()=>[f(n,{label:"Pub Name",align:"center"},{default:_((e=>[f(s,{modelValue:e.row.pub,"onUpdate:modelValue":l=>e.row.pub=l,filterable:"",clearable:"",placeholder:"",onChange:l=>(e=>{const{row:l}=e,o="http://track.adsforward.com/api/track?offer={offer}&mid={slot}&pub_id={siteid}&gaid={gaid}&idfa={idfa}&click_id={clickid}&ip={ip}&ua={ua}&osv={osv}&lang={lang}";l.pub_tracking_link=o;const u=t.pub.find((e=>e.pub_name===l.pub));l.slotid=u.slot_id,l.pub_status=u.status,l.pub_tracking_link=o.replace("{offer}",a.offer).replace("{slot}",u.slot_id),r[u.slot_id]&&(l.payout=r[u.slot_id])})(e)},{default:_((()=>[(c(!0),m(v,null,g(y(t).pub,(e=>{var l;return c(),b(i,{key:e.id,label:e.pub_name,value:null!=(l=e.pub_name)?l:e.id},null,8,["label","value"])})),128))])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),f(n,{label:"Payout",align:"center"},{default:_((e=>[f(V,{modelValue:e.row.payout,"onUpdate:modelValue":l=>e.row.payout=l,type:"number",min:"0",step:"0.001",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(n,{label:"Cap Daily",align:"center"},{default:_((e=>[f(V,{modelValue:e.row.cap_daily,"onUpdate:modelValue":l=>e.row.cap_daily=l,type:"number",min:"0",step:"0.001",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue","onUpdate:modelValue"])])),_:1}),f(n,{label:"Operation",align:"center",width:"180px"},{default:_((e=>[p("div",Y,[f(u,{class:"mr-10",type:"danger",icon:"Delete",circle:"",onClick:l=>(e=>{const l=e.$index;o.manage_traffic.splice(l,1)})(e)},null,8,["onClick"]),f(w,{modelValue:e.row.pub_status,"onUpdate:modelValue":l=>e.row.pub_status=l,"active-value":1,"inactive-value":2,class:"mr-10",onChange:e=>{}},null,8,["modelValue","onUpdate:modelValue","onChange"]),e.row.pub_tracking_link?(c(),b(u,{key:0,class:"cp",type:"primary",onClick:l=>(({row:e})=>{const{pub_tracking_link:l}=e;J(l)})(e)},{default:_((()=>[ee])),_:2},1032,["onClick"])):h("v-if",!0)])])),_:1})])),_:1},8,["data"])])}}}),ae={class:"w100"},te={class:"content-con flex column"},re={class:"flex jc-start ai-center form-one"},oe={class:"w100 flex mt-10"},ue=F("Save"),ie=u({emits:["update:visible","uploadData"],setup(e,{emit:l}){const a=V(),t=/\S/;const r=w((()=>G(o.ruleForm.site_list,1,t).data));let o=i({ruleForm:{site_list:""},rules:{site_list:[{required:!0,message:"必填项",trigger:["blur"]},{validator:(e,l,a)=>{if(""!==l){a(G(l,1,t).type?void 0:new Error("格式错误！"))}else a(new Error("必填项"))},trigger:["blur"]}]}});const u=()=>{l("uploadData",r.value),o.ruleForm.site_list="",l("update:visible",!1)};return(e,l)=>{const t=d("el-input"),r=d("el-form-item"),i=d("el-form"),s=d("el-button");return c(),m("div",ae,[f(i,{ref_key:"ruleFormRef",ref:a,enctype:"multipart/form-data",rules:y(o).rules,model:y(o).ruleForm,"label-width":"140px","label-position":"right"},{default:_((()=>[p("div",te,[h(" Offer "),f(r,{label:"Site:",prop:"site_list"},{default:_((()=>[p("div",re,[f(t,{modelValue:y(o).ruleForm.site_list,"onUpdate:modelValue":l[0]||(l[0]=e=>y(o).ruleForm.site_list=e),rows:4,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" end ")])])),_:1},8,["rules","model"]),p("div",oe,[f(s,{type:"primary",onClick:l[1]||(l[1]=e=>{var l;(l=a.value)&&l.validate((e=>{if(!e)return!1;u()}))})},{default:_((()=>[ue])),_:1})])])}}});const se={class:"w100"},ne=(e=>(j("data-v-661f6240"),e=e(),C(),e))((()=>p("div",{class:"mb-10"},null,-1))),de={class:"control-box flex jc-between ai-start w100"},ce=F("增量生成"),me=F("批量上传"),pe=F("清空"),fe={class:"body-box mt-10"},_e={class:"flex"};var ve=Q(u({props:{msg:{require:!0,default:()=>"",type:String}},emits:["update:msg"],setup(e,{emit:l}){const a=e;let t=V(!1);let r=i({ruleForm:{site_num:0,site_value:(o=a.msg,o?o.split(","):[])},rules:{}});var o;const u=w((()=>r.ruleForm.site_value));w((()=>r.ruleForm.site_value.length));const s=()=>{if(r.ruleForm.site_num>0){let e=Math.floor(r.ruleForm.site_num);for(let l=0;l<e;l++){const e=H(8);r.ruleForm.site_value.push(e)}}r.ruleForm.site_num=0},n=()=>{t.value=!0},v=()=>{r.ruleForm.site_value=[]},g=e=>{e.map((e=>{r.ruleForm.site_value.push(e[0])}))};return k((()=>{const e=r.ruleForm.site_value.join(",");l("update:msg",e)})),(e,l)=>{const a=d("el-button"),o=d("el-input"),i=d("el-table-column"),b=d("el-table"),F=d("el-dialog");return c(),m("div",se,[ne,h(" 操作 "),p("div",de,[f(o,{modelValue:y(r).ruleForm.site_num,"onUpdate:modelValue":l[0]||(l[0]=e=>y(r).ruleForm.site_num=e),placeholder:"Please input",type:"number",max:"1000",class:"input-with-select search-con"},{append:_((()=>[f(a,{onClick:s},{default:_((()=>[ce])),_:1})])),_:1},8,["modelValue"]),f(a,{class:"cp mb-10",onClick:n,type:"primary"},{default:_((()=>[me])),_:1}),f(a,{class:"cp mb-10",onClick:v,type:"primary"},{default:_((()=>[pe])),_:1})]),h(" table "),p("div",fe,[f(b,{data:y(u),class:"w100",height:"400px",border:""},{default:_((()=>[f(i,{label:"site_id",align:"center"},{default:_((e=>[p("div",null,[p("span",null,x(e.row),1)])])),_:1}),f(i,{label:"设置",align:"center"},{default:_((e=>[p("div",_e,[f(a,{type:"danger",icon:"Delete",circle:"",onClick:l=>(e=>{const{$index:l,row:a}=e;r.ruleForm.site_value.splice(l,1)})(e)},null,8,["onClick"])])])),_:1})])),_:1},8,["data"])]),h(" dialog "),f(F,{modelValue:y(t),"onUpdate:modelValue":l[2]||(l[2]=e=>U(t)?t.value=e:t=e),title:"site",width:"60%"},{default:_((()=>[f(ie,{visible:y(t),"onUpdate:visible":l[1]||(l[1]=e=>U(t)?t.value=e:t=e),onUploadData:g},null,8,["visible"])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-661f6240"]]);const ge={class:"content-con flex column"},be={class:"flex jc-start ai-center form-one"},ye=["textContent"],he={class:"flex jc-start ai-center form-one"},Fe=["textContent"],Ve={class:"flex jc-start ai-center form-one"},we={class:"ml-10"},ke={class:"flex jc-start ai-center form-one"},xe={class:"ml-10"},Ue={class:"flex jc-start ai-center form-one"},je=F("默认"),Ce=F("自定义"),qe={class:"ml-10"},Se={class:"flex jc-start ai-center form-one"},Pe={class:"flex jc-start ai-center form-one"},Oe={class:"ml-10"},Ae={class:"flex jc-start ai-center form-one"},Re={class:"flex jc-start ai-center form-one"},De={class:"w100 flex"},Te=F(" 提交 "),Ee=u({props:{msg:{require:!0,default:()=>({}),type:Object}},emits:["update:visible","updateData"],setup(e,{emit:l}){const a=e,t=V();let r="必填项";const o=(e,l,a)=>{if(l){a(l.split(",").length>1e3?new Error("site value 的值不可大于1000个"):void 0)}else a(void 0)},u=i({offer_id:[{required:!0,message:r,trigger:["blur","change"]}],adv_offer:[{required:!0,message:r,trigger:["blur","change"]}],status_day:[{required:!0,message:r,trigger:["blur","change"]}],day_limit:[{required:!0,message:r,trigger:["blur","change"]},{validator:(e,l,a)=>{if(l){let e=Number(l);Number.isInteger(e)&&Number.isSafeInteger(e)?a(e>5?void 0:new Error("必须为大于5的整数")):a(new Error("必须为整数"))}else a(void 0)},trigger:["blur","change"]}],day_limit_type:[{required:!0,message:r,trigger:["blur","change"]}],day_limit_value:[{required:!0,message:r,trigger:["blur","change"]}],status_hour:[{required:!0,message:r,trigger:["blur","change"]}]}),n=i({site_value_required:[{required:!0,message:r,trigger:["blur","change"]},{validator:o,trigger:["blur","change"]}],site_value_no_required:[{required:!1,message:r,trigger:["blur","change"]},{validator:o,trigger:["blur","change"]}]});let v=i({ruleForm:{offer_id:"",adv_offer:"",channel_type:2,status_day:2,day_limit:15,day_limit_type:1,day_limit_value:"",status_hour:2,site_value:""}});const g=w((()=>v.ruleForm.site_value?v.ruleForm.site_value.split(",").length:0)),k=w((()=>"rule_value"===a.msg.site_type));s((()=>a.msg),((e,l)=>{let t=a.msg.fenix_site,r=t.status_day||2,o=t.status_hour||2;2===a.msg.channel_type&&(r=2,o=2),v.ruleForm={offer_id:t.offer_id||a.msg.offer_id,adv_offer:t.adv_offer||a.msg.adv_offer,channel_type:a.msg.channel_type,status_day:r,day_limit:t.day_limit||15,day_limit_type:t.day_limit_type||1,day_limit_value:t.day_limit_value||"",status_hour:o,site_value:a.msg.site_value}}),{deep:!0,immediate:!0});const j=()=>{l("updateData",v.ruleForm),l("update:visible",!1)};return(e,l)=>{const r=d("el-form-item"),o=d("el-switch"),i=d("info-filled"),s=d("el-icon"),V=d("el-tooltip"),w=d("el-input"),C=d("el-radio"),S=d("el-radio-group"),P=d("el-form"),O=d("el-button");return c(),m("div",null,[f(P,{ref_key:"ruleFormRef",ref:t,enctype:"multipart/form-data",rules:y(u),model:y(v).ruleForm,"label-width":"150px","label-position":"right"},{default:_((()=>[p("div",ge,[h(" Offer "),f(r,{label:"Offer:",prop:"offer_id"},{default:_((()=>[p("div",be,[p("span",{textContent:x(y(v).ruleForm.offer_id)},null,8,ye)])])),_:1}),h(" Offer "),f(r,{label:"Adv Offer:",prop:"adv_offer"},{default:_((()=>[p("div",he,[p("span",{textContent:x(y(v).ruleForm.adv_offer)},null,8,Fe)])])),_:1}),h(" Offer "),f(r,{label:"分天优选:",prop:"status_day"},{default:_((()=>[p("div",Ve,[f(o,{disabled:2==a.msg.channel_type,modelValue:y(v).ruleForm.status_day,"onUpdate:modelValue":l[0]||(l[0]=e=>y(v).ruleForm.status_day=e),"active-value":1,"inactive-value":2},null,8,["disabled","modelValue"]),p("span",we,[f(V,{content:"根据昨天数据筛选符合条件的site_id使用",placement:"right-start"},{default:_((()=>[f(s,null,{default:_((()=>[f(i)])),_:1})])),_:1})])])])),_:1}),f(r,{label:"分天优选启动条件:",prop:"day_limit"},{default:_((()=>[p("div",ke,[f(w,{modelValue:y(v).ruleForm.day_limit,"onUpdate:modelValue":l[1]||(l[1]=e=>y(v).ruleForm.day_limit=e),placeholder:"默认值为15",min:"5",step:"1",class:"input-with-select",type:"number"},null,8,["modelValue"]),p("span",xe,[f(V,{content:"当昨天site_id的平均install数大于等于设定值时才启动自动优选，默认设置为15",placement:"bottom"},{default:_((()=>[f(s,null,{default:_((()=>[f(i)])),_:1})])),_:1})])])])),_:1}),f(r,{label:"分天优选install限制:",prop:"day_limit_type"},{default:_((()=>[p("div",Ue,[f(S,{class:"flex",modelValue:y(v).ruleForm.day_limit_type,"onUpdate:modelValue":l[2]||(l[2]=e=>y(v).ruleForm.day_limit_type=e)},{default:_((()=>[f(C,{label:1},{default:_((()=>[je])),_:1}),f(C,{label:2},{default:_((()=>[Ce])),_:1})])),_:1},8,["modelValue"]),p("span",qe,[f(V,{content:"根据site_id的install数筛选，仅使用大于等于设定值的site_id，默认值为昨天均值除以5",placement:"right-start"},{default:_((()=>[f(s,null,{default:_((()=>[f(i)])),_:1})])),_:1})])])])),_:1}),2===y(v).ruleForm.day_limit_type?(c(),b(r,{key:0,label:"分天优选install限制值:",prop:"day_limit_value"},{default:_((()=>[p("div",Se,[f(w,{type:"number",modelValue:y(v).ruleForm.day_limit_value,"onUpdate:modelValue":l[3]||(l[3]=e=>y(v).ruleForm.day_limit_value=e),placeholder:"",class:"input-with-select"},null,8,["modelValue"])])])),_:1})):h("v-if",!0),f(r,{label:"分时优选:",prop:"status_hour"},{default:_((()=>[p("div",Pe,[f(o,{disabled:2==a.msg.channel_type,modelValue:y(v).ruleForm.status_hour,"onUpdate:modelValue":l[4]||(l[4]=e=>y(v).ruleForm.status_hour=e),"active-value":1,"inactive-value":2},null,8,["disabled","modelValue"]),p("span",Oe,[f(V,{content:"根据前6小时和前2小时数据筛选符合条件的site_id使用，暂不支持自定义",placement:"right-start"},{default:_((()=>[f(s,null,{default:_((()=>[f(i)])),_:1})])),_:1})])])])),_:1}),f(r,{label:"当前渠道数:",prop:"site_value",rules:y(k)?y(n).site_value_required:y(n).site_value_no_required},{default:_((()=>[p("div",Ae,[f(w,{type:"hidden",modelValue:y(g),"onUpdate:modelValue":l[5]||(l[5]=e=>U(g)?g.value=e:null),disabled:""},null,8,["modelValue"]),F(" "+x(y(g)),1)])])),_:1},8,["rules"]),f(r,{label:""},{default:_((()=>[p("div",Re,[f(ve,{msg:y(v).ruleForm.site_value,"onUpdate:msg":l[6]||(l[6]=e=>y(v).ruleForm.site_value=e)},null,8,["msg"])])])),_:1}),h(" end ")])])),_:1},8,["rules","model"]),h(" form "),h(" footer "),p("div",De,[f(O,{type:"primary",onClick:l[7]||(l[7]=q((e=>{var l;(l=t.value)&&l.validate((e=>{if(!e)return!1;j()}))}),["prevent"]))},{default:_((()=>[Te])),_:1})])])}}});const Ne={class:"content-con flex column"},Ie={class:"flex jc-start ai-center form-one"},Le=["textContent"],ze={class:"flex jc-start ai-center form-one"},Ke=F(" BUZZ "),Me=F(" SDK "),Be={class:"flex jc-start ai-center form-one"},$e={key:0},Je={key:1},Ze={class:"flex jc-start ai-center form-one"},Ge={class:"flex jc-start ai-center form-one"},He={class:"flex jc-start ai-center form-one"},Qe={class:"flex jc-start ai-center form-one"},We={class:"flex jc-start ai-center form-one"},Xe={class:"form-one"},Ye={class:"flex jc-start ai-center form-one"},el={class:"flex jc-start ai-center form-one"},ll={class:"flex jc-start ai-center form-one"},al={class:"form-one"},tl={class:"flex ai-center jc-start mb-10"},rl={class:"text-wrap"},ol={class:"flex jc-start ai-center form-one"},ul={class:"flex jc-start ai-center form-one"},il={class:"flex jc-start ai-center form-one"},sl={class:"flex jc-start ai-center form-one"},nl={class:"w100 flex"},dl=F(" Save ");var cl=Q(u({setup(e){let{proxy:l}=D();const a=S(),t="此项必填";const r={id:void 0,offer_id:"",adv_offer:"",create_type:1,channel:"",channel_type:1,adv_status:1,conversion_flow:void 0,status:1,title:"",pkg:"",attribute_provider:"",pid:"",platform:1,country:[],revenue:void 0,traffic:[],adtype:38,update_date:"",adv_tracking_link:"",target_cvr:void 0,cvr_status:2,is_s2s:2,s2s_tracking_link:"",app_url:"",site_type:"rule_value",site_value:"",description:"",fenix_site:{}};let u=V(!1);const F=i({options:{channel:[{id:"",short_name:""}],country:[{id:"",short_name:"",zh_cn:""}],conversion_flow:[{value:1,label:"CPI"},{value:2,label:"CPA"},{value:9,label:"SDK"}],platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],site_type:[{value:"rule_sdkindex",label:"匹配SDK自定义"},{value:"rule_pubredirect",label:"透传渠道ID"},{value:"rule_slotid",label:"渠道slotid"},{value:"rule_value",label:"固定值"}],attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}]},rules:{channel:[{required:!0,message:t,trigger:["blur","change"]}],channel_type:[{required:!0,message:t,trigger:["blur","change"]}],status:[{required:!0,message:t,trigger:["blur","change"]}],title:[{required:!0,message:t,trigger:["blur","change"]}],pkg:[{required:!0,message:t,trigger:["blur","change"]}],platform:[{required:!0,message:t,trigger:["blur","change"]}],country:[{required:!0,message:t,trigger:["blur","change"]},{validator:(e,l,a)=>{0!==l.length?l.length>1?a(new Error("只能填选一个国家")):a(void 0):a(new Error(t))},trigger:["blur","change"]}],revenue:[{required:!0,message:t,trigger:["blur","change"]}],traffic:[{required:!1,validator:(e,l,a)=>{0!==l.length?(e=>{let l=!0;return e.map((e=>{for(const a in e)if(Object.prototype.hasOwnProperty.call(e,a)){const t=e[a];if((""===t||void 0===t)&&0!==t){l=!1;break}}})),l})(l)?a(void 0):a(new Error("不允许有空值")):a(void 0)},trigger:["blur","change"]}],adv_tracking_link:[{required:!0,message:t,trigger:["blur","change"]}],site_type:[{required:!0,message:t,trigger:["blur","change"]}],is_s2s:[{required:!0,message:t,trigger:["blur","change"]}]},choiceRules:{no_required:[{required:!1}],s2s_tracking_link:[{required:!0,message:t,trigger:["blur","change"]}],app_url:[{required:!0,message:t,trigger:["blur","change"]}],site_value:[{required:!0,message:t,trigger:["blur","change"]},{validator:(e,l,a)=>{if(l){a(l.split(",").length>1e3?new Error("site value 的值不可大于1000个"):void 0)}else a(void 0)},trigger:["blur","change"]}]},ruleForm:r,search:{adv_offer:""}});let k=V(""),j=V(""),C=V(""),E=V(!1);const J=async()=>{u.value=!0;const e=T.cloneDeep(F.ruleForm);let l,a=o({},e);if(e.conversion_flow&&(a.conversion_flow=e.conversion_flow),a.country=e.country[0],a.revenue=parseFloat(a.revenue),a.target_cvr=parseFloat(a.target_cvr),a.fenix_site.day_limit&&(a.fenix_site.day_limit=parseFloat(a.fenix_site.day_limit)),a.fenix_site.day_limit_value?a.fenix_site.day_limit_value=parseFloat(a.fenix_site.day_limit_value):delete a.fenix_site.day_limit_value,0!==e.traffic.length){const l=(e=>{const l=[];return e.map((e=>{let a=o({},e);return e.payout&&(a.payout=Number(e.payout)),e.cap_daily&&(a.cap_daily=Number(e.cap_daily)),l.push(a),e})),l})(e.traffic);a.traffic=JSON.stringify(l)}else delete a.traffic;"create"===C.value&&(l=await B(a)),"edit"===C.value&&(l=await $(a)),u.value=!1,Z(l)&&window.close()},G=()=>{E.value=!0},H=()=>{l.$refs.ruleForm.validate((e=>{if(!e)return!1;J()}))},Q=async()=>{const e=await I();if(200===e.code){const{offer_id:l}=e;F.ruleForm.offer_id=l.toString()}else Q()},W=w((()=>F.ruleForm.site_value?F.ruleForm.site_value.split(",").length:0)),X=async()=>{const{data:e}=await L();return F.options.channel=e,e},Y=async()=>{const{data:e}=await z();return F.options.country=e,e};i({ruleForm:r}),n((async()=>{ee()}));const ee=async()=>{k.value=a.currentRoute.value.name,j.value=a.currentRoute.value.params.id,"fenix-offer-create"===k.value&&(Q(),C.value="create"),"fenix-offer-edit"===k.value&&(j.value=a.currentRoute.value.params.id,C.value="edit",ae()),await(async()=>await Promise.all([X(),Y()]))()},ae=async()=>{const{data:e}=await N(j.value);F.ruleForm=o({},e),F.ruleForm.country=[e.country],F.search.adv_offer=e.adv_offer,F.ruleForm.traffic=e.traffic?JSON.parse(e.traffic):[],P(F.ruleForm)},te=w((()=>"rule_value"===F.ruleForm.site_type));s((()=>F.ruleForm.traffic),((e,l)=>{}),{immediate:!0,deep:!0}),s((()=>F.ruleForm.adv_offer),((e,l)=>{F.ruleForm.create_type=e?2:1}),{immediate:!0,deep:!0});const re=e=>{},oe=async()=>{if("edit"===C.value)return!1;F.ruleForm.adv_offer=F.search.adv_offer;const e=F.ruleForm.adv_offer;if(!e)return!1;const l={adv_offer:e,platform:F.ruleForm.platform};if(e&&e.includes("_")){F.ruleForm.channel_type=2,F.ruleForm.adtype=39;const e=await K(l),{data:a}=e;200===e.status?(F.ruleForm.adv_status=1,ie(a)):F.ruleForm.adv_status=2}else{F.ruleForm.channel_type=1,F.ruleForm.adtype=38;const{data:e}=await M(l);F.ruleForm.adv_status=e.status,ue(e)}},ue=e=>{F.ruleForm.channel=e.channel,F.ruleForm.attribute_provider=e.attribute_provider,F.ruleForm.conversion_flow=e.conversion_flow,F.ruleForm.title=e.title,F.ruleForm.pkg=e.pkg_name,F.ruleForm.pid=e.pid,F.ruleForm.platform=e.platform,F.ruleForm.revenue=e.payout,F.ruleForm.adv_tracking_link=e.tracking_link,se(e.country)},ie=e=>{var l;F.ruleForm.pkg=e.app_pkg_name,F.ruleForm.channel=e.channel,F.ruleForm.country=e.country;const a=null==(l=F.options.platform.find((l=>l.label===e.platform)))?void 0:l.value;F.ruleForm.platform=a||1,F.ruleForm.revenue=e.revenue,F.ruleForm.title=e.title,F.ruleForm.adv_tracking_link=e.tracking_link,F.ruleForm.conversion_flow=9},se=e=>{Array.isArray(e)?F.ruleForm.country=e:F.ruleForm.country=[e]},ne=e=>{e.site_value.length,F.ruleForm.site_value=e.site_value,F.ruleForm.fenix_site=P(e)};return(e,l)=>{const a=d("el-form-item"),t=d("el-button"),r=d("el-input"),o=d("el-option"),i=d("el-select"),s=d("el-radio"),n=d("el-radio-group"),V=d("el-switch"),w=d("el-form"),k=d("el-dialog"),j=O("loading");return A((c(),m("div",null,[h(" form "),f(w,{ref:"ruleForm",enctype:"multipart/form-data",rules:y(F).rules,model:y(F).ruleForm,"label-width":"240px","label-position":"right"},{default:_((()=>[p("div",Ne,[h(" Offer "),f(a,{label:"Offer:",prop:"offer"},{default:_((()=>[p("div",Ie,[p("span",{textContent:x(y(F).ruleForm.offer_id)},null,8,Le)])])),_:1}),h(" Adv Offer "),f(a,{label:"Adv Offer:",prop:"adv_offer"},{default:_((()=>[p("div",ze,[f(r,{modelValue:y(F).search.adv_offer,"onUpdate:modelValue":l[0]||(l[0]=e=>y(F).search.adv_offer=e),placeholder:"Please input",class:"input-with-select",disabled:"edit"===y(C)},R({_:2},["create"===y(C)?{name:"append",fn:_((()=>[f(t,{type:"primary",icon:"Search",onClick:oe})]))}:void 0]),1032,["modelValue","disabled"])])])),_:1}),h(" Channel "),f(a,{label:"Channel:",prop:"channel"},{default:_((()=>[f(i,{modelValue:y(F).ruleForm.channel,"onUpdate:modelValue":l[1]||(l[1]=e=>y(F).ruleForm.channel=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:_((()=>[(c(!0),m(v,null,g(y(F).options.channel,(e=>(c(),b(o,{key:e.id,label:e.short_name,value:e.short_name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(" Channel Type "),f(a,{label:"Channel Type:",prop:"channel_type"},{default:_((()=>[f(n,{modelValue:y(F).ruleForm.channel_type,"onUpdate:modelValue":l[2]||(l[2]=e=>y(F).ruleForm.channel_type=e),class:"form-one"},{default:_((()=>[f(s,{label:1},{default:_((()=>[Ke])),_:1}),f(s,{label:2},{default:_((()=>[Me])),_:1})])),_:1},8,["modelValue"])])),_:1}),h(" Adv Status "),f(a,{label:"Adv Status:",prop:"adv_status"},{default:_((()=>[p("div",Be,[1===y(F).ruleForm.adv_status?(c(),m("span",$e,"开")):h("v-if",!0),2===y(F).ruleForm.adv_status?(c(),m("span",Je,"关")):h("v-if",!0)])])),_:1}),h(" conversion_flow "),f(a,{label:"Conversion Flow:",prop:"conversion_flow"},{default:_((()=>[f(i,{modelValue:y(F).ruleForm.conversion_flow,"onUpdate:modelValue":l[3]||(l[3]=e=>y(F).ruleForm.conversion_flow=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:_((()=>[(c(!0),m(v,null,g(y(F).options.conversion_flow,(e=>(c(),b(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(" Status "),f(a,{label:"Status:",prop:"status"},{default:_((()=>[p("div",Ze,[f(V,{modelValue:y(F).ruleForm.status,"onUpdate:modelValue":l[4]||(l[4]=e=>y(F).ruleForm.status=e),"active-value":1,"inactive-value":2},null,8,["modelValue"])])])),_:1}),h(" Offer Title "),f(a,{label:"Offer Title:",prop:"title"},{default:_((()=>[p("div",Ge,[f(r,{modelValue:y(F).ruleForm.title,"onUpdate:modelValue":l[5]||(l[5]=e=>y(F).ruleForm.title=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" Package Name "),f(a,{label:"Package Name:",prop:"pkg"},{default:_((()=>[p("div",He,[f(r,{modelValue:y(F).ruleForm.pkg,"onUpdate:modelValue":l[6]||(l[6]=e=>y(F).ruleForm.pkg=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" Attribute Provider "),f(a,{label:"Attribute Provider:",prop:"attribute_provider"},{default:_((()=>[f(i,{modelValue:y(F).ruleForm.attribute_provider,"onUpdate:modelValue":l[7]||(l[7]=e=>y(F).ruleForm.attribute_provider=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:_((()=>[(c(!0),m(v,null,g(y(F).options.attribute_provider,(e=>(c(),b(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(" Pid "),f(a,{label:"Pid:",prop:"pid"},{default:_((()=>[p("div",Qe,[f(r,{modelValue:y(F).ruleForm.pid,"onUpdate:modelValue":l[8]||(l[8]=e=>y(F).ruleForm.pid=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" Platform "),f(a,{label:"Platform:",prop:"platform"},{default:_((()=>[f(i,{modelValue:y(F).ruleForm.platform,"onUpdate:modelValue":l[9]||(l[9]=e=>y(F).ruleForm.platform=e),filterable:"",class:"form-one",placeholder:""},{default:_((()=>[(c(!0),m(v,null,g(y(F).options.platform,(e=>(c(),b(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(" Country "),f(a,{label:"Country:",prop:"country"},{default:_((()=>[f(i,{modelValue:y(F).ruleForm.country,"onUpdate:modelValue":l[10]||(l[10]=e=>y(F).ruleForm.country=e),filterable:"",class:"form-one",multiple:"",clearable:"",placeholder:""},{default:_((()=>[(c(!0),m(v,null,g(y(F).options.country,(e=>(c(),b(o,{key:e.id,label:e.short_name+"-"+e.zh_cn,value:e.short_name},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(" Revenue "),f(a,{label:"Revenue:",prop:"revenue"},{default:_((()=>[p("div",We,[f(r,{modelValue:y(F).ruleForm.revenue,"onUpdate:modelValue":l[11]||(l[11]=e=>y(F).ruleForm.revenue=e),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" Manage Traffic "),f(a,{label:"Manage Traffic:",prop:"traffic"},{default:_((()=>[p("div",Xe,[f(y(le),{ref:"traffic",list:y(F).ruleForm.traffic,"onUpdate:list":l[12]||(l[12]=e=>y(F).ruleForm.traffic=e),offer:y(F).ruleForm.offer_id,onKk:re},null,8,["list","offer"])])])),_:1}),h(" Adv Tracking Link "),f(a,{label:"Adv Tracking Link:",prop:"adv_tracking_link"},{default:_((()=>[p("div",Ye,[f(r,{modelValue:y(F).ruleForm.adv_tracking_link,"onUpdate:modelValue":l[13]||(l[13]=e=>y(F).ruleForm.adv_tracking_link=e),rows:4,autosize:"",type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" Target CVR "),f(a,{label:"Target CVR:",prop:"target_cvr"},{default:_((()=>[p("div",el,[f(r,{modelValue:y(F).ruleForm.target_cvr,"onUpdate:modelValue":l[14]||(l[14]=e=>y(F).ruleForm.target_cvr=e),type:"number",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" CVR Status "),f(a,{label:"CVR Status:",prop:"cvr_status"},{default:_((()=>[p("div",ll,[f(V,{modelValue:y(F).ruleForm.cvr_status,"onUpdate:modelValue":l[15]||(l[15]=e=>y(F).ruleForm.cvr_status=e),"active-value":1,"inactive-value":2},null,8,["modelValue"])])])),_:1}),h(" Site Type "),f(a,{label:"Site Type:",prop:"site_type"},{default:_((()=>[f(i,{modelValue:y(F).ruleForm.site_type,"onUpdate:modelValue":l[16]||(l[16]=e=>y(F).ruleForm.site_type=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:_((()=>[(c(!0),m(v,null,g(y(F).options.site_type,(e=>(c(),b(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(" Site Value "),f(a,{label:"Site Value:",prop:"site_value",rules:y(te)?y(F).choiceRules.site_value:y(F).choiceRules.no_required},{default:_((()=>[p("div",al,[p("div",tl,[f(t,{class:"cp mr-10",icon:"Tools",circle:"",onClick:G}),p("span",null,x(y(W)),1)]),p("div",null,[h(' <el-input\n                v-model="state.ruleForm.site_value"\n                type="textarea"\n                autosize\n                :rows="4"\n                placeholder="Please input"\n                class="input-with-select siteValue"\n              /> '),p("p",rl,x(y(F).ruleForm.site_value),1)])])])),_:1},8,["rules"]),h(" S2S Async "),f(a,{label:"S2S Async:",prop:"is_s2s"},{default:_((()=>[p("div",ol,[f(V,{modelValue:y(F).ruleForm.is_s2s,"onUpdate:modelValue":l[17]||(l[17]=e=>y(F).ruleForm.is_s2s=e),"active-value":1,"inactive-value":2},null,8,["modelValue"])])])),_:1}),h(" S2S Tracking Link "),f(a,{label:"S2S Tracking Link:",prop:"s2s_tracking_link",rules:1===y(F).ruleForm.is_s2s?y(F).choiceRules.s2s_tracking_link:y(F).choiceRules.no_required},{default:_((()=>[p("div",ul,[f(r,{modelValue:y(F).ruleForm.s2s_tracking_link,"onUpdate:modelValue":l[18]||(l[18]=e=>y(F).ruleForm.s2s_tracking_link=e),rows:2,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1},8,["rules"]),h(" Preview URL "),f(a,{label:"Preview URL:",prop:"app_url",rules:1===y(F).ruleForm.is_s2s?y(F).choiceRules.app_url:y(F).choiceRules.no_required},{default:_((()=>[p("div",il,[f(r,{modelValue:y(F).ruleForm.app_url,"onUpdate:modelValue":l[19]||(l[19]=e=>y(F).ruleForm.app_url=e),rows:2,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1},8,["rules"]),h(" Description "),f(a,{label:"Description:",prop:"description"},{default:_((()=>[p("div",sl,[f(r,{modelValue:y(F).ruleForm.description,"onUpdate:modelValue":l[20]||(l[20]=e=>y(F).ruleForm.description=e),rows:2,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])])),_:1}),h(" end ")])])),_:1},8,["rules","model"]),h(" form "),h(" footer "),p("div",nl,[f(t,{type:"primary",onClick:q(H,["prevent"])},{default:_((()=>[dl])),_:1},8,["onClick"])]),h(" dialog "),f(k,{modelValue:y(E),"onUpdate:modelValue":l[22]||(l[22]=e=>U(E)?E.value=e:E=e),title:"site",width:"70%"},{default:_((()=>[f(Ee,{msg:y(F).ruleForm,onUpdateData:ne,visible:y(E),"onUpdate:visible":l[21]||(l[21]=e=>U(E)?E.value=e:E=e)},null,8,["msg","visible"])])),_:1},8,["modelValue"])])),[[j,y(u)]])}}}),[["__scopeId","data-v-2659fc52"]]);export{cl as default};
