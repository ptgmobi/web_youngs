import{a as n}from"./index-30657850.js";import{d as k,z as M,w as V,C as P,r as g,o as D,k as y,v as d,x as u,h as p,j as c,y as B,t as _}from"./vendor-bf64253d.js";import{b as w}from"./format-b76f9697.js";import{_ as C}from"./lodash-05c10b51.js";function J(a){return n({url:"/obuzz",data:a,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function R(a){return n({url:"/obuzz/offer-max-clk",data:a,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function H(a){return n({url:"/obuzz/edit-clk-limit",data:a,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function K(a){return n({url:"/obuzz/status",data:a,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function Q(a){return n({url:"/obuzz",data:a,method:"post",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function W(a){return n({url:"/obuzz",data:a,method:"put",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function X(a){return n({url:`/obuzz/view/${a}`,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function Y(a){return n({url:"/obuzz/copy",method:"get",data:a,bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function Z(){return n({url:"/obuzz/edit-config",method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function ee(a){return n({url:"/obuzz/offer-device",data:a,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function te(a){return n({url:"/obuzz/device",data:a,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}const G={class:"full"},U={class:"w100 flex mt-20"},q=d("span",null,"\u9009\u4E2D\u5408\u8BA1\uFF1A",-1),F=["textContent"],se=k({props:{all:{require:!0,default:()=>({}),type:Object},select:{require:!0,default:()=>({}),type:Object}},emits:["kk","count","up"],setup(a,{emit:A}){const i=a;let b=[];const t=M({search:{id:""},test:"",set:new Set,setObj:{},spanArr:b,all:b,select:b,statisticsCount:0}),O=()=>{i.all&&i.all.length>0&&(t.all=C.cloneDeep(i.all),t.select=C.cloneDeep(i.select),t.set=new Set,t.all.map(e=>(e.select_status=!1,t.set.add(e.source),t.select.map(s=>(e.source===s.source&&e.label===s.label&&(e.select_status=!0),e)),e)),t.all.sort((e,s)=>e.label>s.label?1:e.label<s.label?-1:1),t.all.sort((e,s)=>e.source>s.source?1:e.source<s.source?-1:1),x(t.all,"source"),j())},j=()=>{let s=[...t.set].map(r=>(r=[r,!1],r));t.setObj=Object.fromEntries(s),h()},v=(e,s)=>{console.log("change all"),t.all.map(r=>{r.source===e&&(r.select_status=s)}),h(),z()},E=e=>{console.log("change one"),h(),z()},h=()=>{Object.keys(t.setObj).forEach(s=>{let r=[];t.all.forEach(o=>{o.source===s&&r.push(o.select_status)}),t.setObj[s]=!0,r.includes(!1)&&(t.setObj[s]=!1)}),S()},S=()=>{let e=t.all.reduce((s,r)=>r.select_status?s+parseInt(r.device_count):s,0);t.statisticsCount=w(e),A("count",e)},z=()=>{let e=[],s=0;t.all.forEach(r=>{r.select_status&&(e.push({source:r.source,label:r.label}),s+=parseInt(r.device_count))}),console.log(e),A("kk",e)},x=(e,s)=>{t.spanArr=[];let r=0;for(var o=0;o<e.length;o++)o===0?t.spanArr.push(1):e[o][s]===e[o-1][s]?(t.spanArr[r]+=1,t.spanArr.push(0)):(t.spanArr.push(1),r=o)},L=({row:e,column:s,rowIndex:r,columnIndex:o})=>{if(o===0){const m=t.spanArr[r],l=m>0?1:0;return{rowspan:m,colspan:l}}};return V(()=>i.all,(e,s)=>{O()},{immediate:!0}),P(()=>{}),(e,s)=>{const r=g("el-checkbox"),o=g("el-table-column"),m=g("el-table");return D(),y("div",null,[d("div",G,[u(m,{data:c(t).all,"span-method":L,border:"",style:{width:"100%","margin-top":"20px"}},{default:p(()=>[u(o,{prop:"source",label:"Source",width:"180"},{default:p(l=>[u(r,{modelValue:c(t).setObj[l.row.source],"onUpdate:modelValue":f=>c(t).setObj[l.row.source]=f,onChange:f=>v(l.row.source,c(t).setObj[l.row.source])},{default:p(()=>[B(_(l.row.source),1)]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),u(o,{prop:"label",label:"Label"}),u(o,{prop:"slot_id",label:"Slot ID"}),u(o,{prop:"device_count",label:"Count"},{default:p(l=>[d("span",null,_(c(w)(l.row.device_count)),1)]),_:1}),u(o,{prop:"select",label:"Select"},{default:p(l=>[u(r,{modelValue:l.row.select_status,"onUpdate:modelValue":f=>l.row.select_status=f,onChange:f=>E(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1})]),_:1},8,["data"]),d("div",U,[q,d("span",{textContent:_(c(t).statisticsCount)},null,8,F)])])])}}});export{J as A,se as _,R as a,H as b,K as c,ee as d,te as e,Q as f,W as g,Z as h,X as i,Y as j};
