var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t;import{_ as c,d as n,Z as s,h as d,r as u,L as p,M as m,q as f,$ as b,o as h,c as v,x as y,z as g,e as _,s as w,v as V,U as D,A as k,V as x,N as C,O as F,f as j,y as U}from"./main-10c8b00d.js";import{P as z}from"./index-d89862df.js";import{A as O,_ as P,a as A,b as S,c as E,d as N,e as Q,f as $}from"./device-dfd40846.js";import{m as I}from"./message-83da0e90.js";import{_ as B}from"./lodash-081287e7.js";import{o as L,a as M}from"./new-format-c9dfc3b7.js";import{b as J}from"./format-7f997de4.js";import"./moment-9bd84dc2.js";const T={class:"controlBox w100 mb-10"},q={class:"mb-10"},K=j("Offer Create"),Z={class:"flex jc-start flex-wrap w100"},G={class:"flex"},H={class:"flex"},R=j(" 查询 "),W={class:"flex jc-start"},X=j("批量修改当前页面内所有offer的device"),Y={class:"flex jc-around"},ee={class:"flex jc-around"},ae={class:"flex jc-around"},le=["textContent"],te={class:"flex jc-around"},ie={class:"w100 flex"},oe={class:"dialog-footer"},re=j("确 定"),ce=n({name:"buzz-async"}),ne=n((se=((e,a)=>{for(var l in a||(a={}))i.call(a,l)&&r(e,l,a[l]);if(t)for(var l of t(a))o.call(a,l)&&r(e,l,a[l]);return e})({},ce),a(se,l({setup(e){const a=s({attribute_provider:[],platform:[],package_name:"",channel:"",id:"",offer_title:"",country:"",pid:""});let l=d(!1),t=u({offer:{},index:null,cacheDevice:{},cacheDeviceCount:0}),i=u({dialogVisible:!1,dialogVisibleDevice:!1,cache:{item:{},device:{}},searchForm:a.value,useData:a.value,loading:!0,options:{cutoff_start:[...new Array(20)].map(((e,a)=>{const l=5*a/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),cutoff_end:[...new Array(20)].map(((e,a)=>{const l=(5*a+5)/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],platform:[{value:"1",label:"Android"},{value:"2",label:"iOS"}]},list:[],pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});const o=()=>{i.useData=B.cloneDeep(i.searchForm),n()},r=()=>{L("/buzz/buzz-async-create")},c=e=>`/buzz/buzz-async-edit/${e.id}`,n=async()=>{i.loading=!0;let e={page:i.pagination.listQuery.page,page_size:i.pagination.listQuery.limit};i.useData.attribute_provider&&(e.attribute_provider=i.useData.attribute_provider),i.useData.platform&&(e.platform=i.useData.platform),i.useData.package_name&&(e.pkg_name=i.useData.package_name),i.useData.channel&&(e.channel=i.useData.channel),i.useData.id&&(e.offer_id=i.useData.id),i.useData.offer_title&&(e.title=i.useData.offer_title),i.useData.country&&(e.country=i.useData.country),i.useData.pid&&(e.tracking_link=i.useData.pid);const a=await O(e),{data:l}=a,{page:t}=l;i.list=null==l?void 0:l.data,i.pagination.total=Number(t.count),i.loading=!1},ce=async(e,a)=>{l.value=!1,i.dialogVisibleDevice=!0,t.offer=a,t.index=e;const o={id:a.id,platform:a.platform,country:a.country},{data:r}=await N(o);t.cacheDevice.all=r.all,t.cacheDevice.select=r.select},ne=e=>{t.cacheDevice.select=e},se=e=>{t.cacheDeviceCount=e},de=async()=>{if(!0===l.value){let e=i.list.map((e=>e.id)),a=0!==e.length?e.join(","):"";if(a){const e={ids:a,device:JSON.stringify(t.cacheDevice.select)},l=await Q(e);I(l)&&(i.dialogVisibleDevice=!1,n())}}else{const e={id:t.offer.id,device:JSON.stringify(t.cacheDevice.select)},a=await $(e);I(a)&&(i.dialogVisibleDevice=!1,t.offer.device_count=t.cacheDeviceCount)}};return p((()=>{o()})),m((()=>{})),(e,a)=>{const s=f("el-button"),d=f("el-option"),u=f("el-select"),p=f("el-form-item"),m=f("el-input"),O=f("el-form"),N=f("el-table-column"),Q=f("el-switch"),$=f("el-table"),B=f("el-dialog"),ue=b("loading");return h(),v("div",null,[y("div",T,[y("div",q,[g(' <router-link to="/buzz/buzz-async-create">\n          <el-button type="primary">\n            Offer Create\n          </el-button>\n        </router-link> '),_(s,{type:"primary",onClick:r},{default:w((()=>[K])),_:1})]),_(O,{modelValue:V(i).searchForm,"onUpdate:modelValue":a[8]||(a[8]=e=>V(i).searchForm=e),inline:!0,class:"flex jc-between w100 ai-end"},{default:w((()=>[y("div",Z,[_(p,{label:""},{default:w((()=>[_(u,{modelValue:V(i).searchForm.attribute_provider,"onUpdate:modelValue":a[0]||(a[0]=e=>V(i).searchForm.attribute_provider=e),clearable:"",class:"search-con",placeholder:"Attribute Provider",style:{"min-width":"140px"}},{default:w((()=>[(h(!0),v(C,null,F(V(i).options.attribute_provider,(e=>(h(),k(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(p,{label:""},{default:w((()=>[_(u,{modelValue:V(i).searchForm.platform,"onUpdate:modelValue":a[1]||(a[1]=e=>V(i).searchForm.platform=e),clearable:"",class:"search-con",placeholder:"Platform",style:{"min-width":"95px"}},{default:w((()=>[(h(!0),v(C,null,F(V(i).options.platform,(e=>(h(),k(d,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),_(p,{label:""},{default:w((()=>[_(m,{modelValue:V(i).searchForm.package_name,"onUpdate:modelValue":a[2]||(a[2]=e=>V(i).searchForm.package_name=e),placeholder:"Package Name",class:"search-con",style:{"min-width":"120px"}},null,8,["modelValue"])])),_:1}),_(p,{label:""},{default:w((()=>[_(m,{modelValue:V(i).searchForm.channel,"onUpdate:modelValue":a[3]||(a[3]=e=>V(i).searchForm.channel=e),placeholder:"Channel",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),_(p,{label:""},{default:w((()=>[_(m,{modelValue:V(i).searchForm.id,"onUpdate:modelValue":a[4]||(a[4]=e=>V(i).searchForm.id=e),placeholder:"ID",class:"search-con"},null,8,["modelValue"])])),_:1}),_(p,{label:""},{default:w((()=>[_(m,{modelValue:V(i).searchForm.offer_title,"onUpdate:modelValue":a[5]||(a[5]=e=>V(i).searchForm.offer_title=e),placeholder:"Offer Title",class:"search-con",style:{"min-width":"90px"}},null,8,["modelValue"])])),_:1}),_(p,{label:""},{default:w((()=>[_(m,{modelValue:V(i).searchForm.country,"onUpdate:modelValue":a[6]||(a[6]=e=>V(i).searchForm.country=e),placeholder:"Country",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),_(p,{label:""},{default:w((()=>[_(m,{modelValue:V(i).searchForm.pid,"onUpdate:modelValue":a[7]||(a[7]=e=>V(i).searchForm.pid=e),placeholder:"Pid",class:"search-con"},null,8,["modelValue"])])),_:1})]),y("div",G,[_(p,{class:"mr-0",style:{"margin-right":"0px"}},{default:w((()=>[y("div",H,[_(s,{type:"primary",onClick:o},{default:w((()=>[R])),_:1}),g(' <el-button type="primary" @click="handleExportSearch">导出</el-button> ')])])),_:1})])])),_:1},8,["modelValue"]),g(' <el-input placeholder="请输入内容" v-model="data.searchForm.data" class=\'search-input\'>\n        <el-button slot="append" icon="Search" @click=\'searchFun\'></el-button>\n      </el-input> '),g(" 批量修改设备信息 "),y("div",W,[_(s,{class:"cp",type:"primary",icon:"Edit",onClick:a[9]||(a[9]=e=>(()=>{let e=0!==i.list.length?i.list[0]:"";e&&(ce(0,e),l.value=!0)})())},{default:w((()=>[X])),_:1})])]),g(" table "),D((h(),k($,{center:"",data:V(i).list,class:"w100",height:"70vh",border:""},{default:w((()=>[_(N,{fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"70"}),_(N,{fixed:"",prop:"channel",label:"Channel",align:"center",width:"60"}),_(N,{prop:"pkg_name",label:"Package Name",align:"center",width:"110"}),_(N,{prop:"title",label:"Offer Title",align:"center"}),_(N,{prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),_(N,{prop:"pid",label:"Pid",align:"center",width:"90"}),_(N,{prop:"platform",label:"Platform",align:"center",width:"65"},{default:w((e=>[j(U(1===Number(e.row.platform)?"Android":"iOS"),1)])),_:1}),_(N,{prop:"country",label:"Country",align:"center",width:"57"}),_(N,{prop:"payout",label:"Payout",align:"center",width:"55"}),_(N,{prop:"p_type",label:"Delivery mode",align:"center",width:"75"},{default:w((e=>[y("span",null,U(1==e.row.p_type?"算法":"标签"),1)])),_:1}),_(N,{label:"Click Limitation",width:"150",align:"center"},{default:w((e=>[y("div",Y,[_(m,{modelValue:e.row.max_clk_num,"onUpdate:modelValue":a=>e.row.max_clk_num=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),_(s,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,max_clk_num:parseFloat(e.max_clk_num)},l=await A(a);I(l)})(e.row)},null,8,["onClick"])])])),_:1}),_(N,{label:"Site Click Limitation",width:"150",align:"center"},{default:w((e=>[y("div",ee,[_(m,{modelValue:e.row.site_clk_limit,"onUpdate:modelValue":a=>e.row.site_clk_limit=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),_(s,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,site_clk_limit:parseFloat(e.site_clk_limit)},l=await S(a);I(l)})(e.row)},null,8,["onClick"])])])),_:1}),_(N,{label:"Select Device",width:"120",align:"center"},{default:w((e=>[y("div",ae,[e.row.device_count?(h(),v("span",{key:0,textContent:U(e.row.device_count?V(J)(e.row.device_count):"")},null,8,le)):g("v-if",!0),_(s,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>ce(e.$index,e.row)},null,8,["onClick"])])])),_:1}),_(N,{label:"Operation",align:"center"},{default:w((e=>[y("div",te,[g(' <router-link :to="getEditUrl(scope.row)">\n              <el-button\n                class="cp mr-10"\n                type="primary"\n                icon="Edit"\n                circle\n              ></el-button>\n            </router-link> '),_(s,{class:"cp mr-10",type:"primary",icon:"Edit",circle:"",onClick:a=>(e=>{let a=c(e);L(a)})(e.row)},null,8,["onClick"]),_(Q,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,onChange:a=>(async e=>{let a={id:e.id,status:e.status};a=M(a);const l=await E(a);I(l)})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),_:1})])),_:1},8,["data"])),[[ue,V(i).loading]]),g(" 分页 "),y("div",ie,[D(_(V(z),{page:V(i).pagination.listQuery.page,"onUpdate:page":a[10]||(a[10]=e=>V(i).pagination.listQuery.page=e),limit:V(i).pagination.listQuery.limit,"onUpdate:limit":a[11]||(a[11]=e=>V(i).pagination.listQuery.limit=e),total:V(i).pagination.total,"page-sizes":V(i).pagination.pageSizes,onPagination:n},null,8,["page","limit","total","page-sizes"]),[[x,V(i).pagination.total]])]),g(" device "),_(B,{modelValue:V(i).dialogVisibleDevice,"onUpdate:modelValue":a[14]||(a[14]=e=>V(i).dialogVisibleDevice=e),title:"Device"},{default:w((()=>[V(i).dialogVisibleDevice?(h(),k(P,{key:0,all:V(t).cacheDevice.all,"onUpdate:all":a[12]||(a[12]=e=>V(t).cacheDevice.all=e),select:V(t).cacheDevice.select,"onUpdate:select":a[13]||(a[13]=e=>V(t).cacheDevice.select=e),onKk:ne,onCount:se},null,8,["all","select"])):g("v-if",!0),y("span",oe,[g(' <el-button @click="cancleDevice">取 消</el-button> '),_(s,{type:"primary",onClick:de},{default:w((()=>[re])),_:1})])])),_:1},8,["modelValue"])])}}}))));var se,de=c(ne,[["__scopeId","data-v-0fe780f4"]]);export{de as default};
