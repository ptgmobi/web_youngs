var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,o=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;import{d as n,y as c,w as u,B as p,r as d,o as b,i,s as m,v as f,f as j,h as O,x as h,t as w}from"./vendor-691ef2b9.js";const v={class:"full"},_={class:"w100 flex mt-20"},y=m("span",null,"选中合计：",-1),g=["textContent"],C=n({props:{json:{require:!0,default:()=>({}),type:Object}},emits:["kk","up"],setup(e,{emit:n}){const C=e;let x=[];const S=c({search:{id:""},set:new Set,setObj:{},spanArr:x,arr:x,select:x,statisticsCount:0});u(C.json,((e,t)=>{}));const V=()=>{let e=[...S.set].map((e=>e=[e,!1]));S.setObj=Object.fromEntries(e),A()},A=()=>{Object.keys(S.setObj).forEach((e=>{let t=[];S.arr.forEach((s=>{s.source===e&&t.push(s.select_status)})),S.setObj[e]=!0,t.includes(!1)&&(S.setObj[e]=!1)})),k()},k=()=>{let e=S.arr.reduce(((e,t)=>t.select_status?e+parseInt(t.device_count):e),0);S.statisticsCount=e},I=()=>{let e=[],c=0;S.arr.forEach((n=>{var u,p;n.select_status&&(e.push((u=((e,t)=>{for(var s in t||(t={}))a.call(t,s)&&o(e,s,t[s]);if(r)for(var s of r(t))l.call(t,s)&&o(e,s,t[s]);return e})({},n),p={source:n.source,label:n.label},t(u,s(p)))),c+=parseInt(n.device_count))})),n("kk",e)},E=(e,t)=>{S.spanArr=[];let s=0;for(var r=0;r<e.length;r++)0===r?S.spanArr.push(1):e[r][t]===e[r-1][t]?(S.spanArr[s]+=1,S.spanArr.push(0)):(S.spanArr.push(1),s=r)},P=({row:e,column:t,rowIndex:s,columnIndex:r})=>{if(0===r){const e=S.spanArr[s];return{rowspan:e,colspan:e>0?1:0}}};return p((()=>{(()=>{if(0!==C.json.all.length){S.set=new Set;let e=C.json.all;return S.select=C.json.select,e.map((e=>{e.select_status=!1,S.set.add(e.source),S.select.map((t=>(e.source===t.source&&e.label===t.label&&(e.select_status=!0),e)))})),e.sort(((e,t)=>e.label>t.label?1:e.label<t.label?-1:1)),e.sort(((e,t)=>e.source>t.source?1:e.source<t.source?-1:1)),E(e,"source"),S.arr=e,V(),e}JSON.parse(JSON.stringify(S.arr))})()})),(e,t)=>{const s=d("el-checkbox"),r=d("el-table-column"),a=d("el-table");return b(),i("div",null,[m("div",v,[f(a,{data:O(S).arr,"span-method":P,border:"",style:{width:"100%","margin-top":"20px"}},{default:j((()=>[f(r,{prop:"source",label:"Source",width:"180"},{default:j((e=>[f(s,{modelValue:O(S).setObj[e.row.source],"onUpdate:modelValue":t=>O(S).setObj[e.row.source]=t,onChange:t=>{return s=e.row.source,r=O(S).setObj[e.row.source],S.arr.map((e=>{e.source===s&&(e.select_status=r)})),A(),void I();var s,r}},{default:j((()=>[h(w(e.row.source),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),f(r,{prop:"label",label:"Label"}),f(r,{prop:"slot_id",label:"Slot ID"}),f(r,{prop:"device_count",label:"Count"}),f(r,{prop:"select",label:"Select"},{default:j((e=>[f(s,{modelValue:e.row.select_status,"onUpdate:modelValue":t=>e.row.select_status=t,onChange:t=>(e.row,A(),void I())},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data"]),m("div",_,[y,m("span",{textContent:w(O(S).statisticsCount)},null,8,g)])])])}}});export{C as _};
