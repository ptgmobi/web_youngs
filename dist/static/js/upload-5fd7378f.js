import{e}from"./dsp-advertiser-4a2a0a9c.js";import{E as t}from"./main-0a777472.js";const i=e=>{let i=e.filter((e=>"rejected"===e.status)),n={};if(0!==i.length)n={status:!1,msg:i.map((e=>e.reason)).join(",")},t.error(n.msg);else{let t={};e.map((e=>{let i=e.value;for(const n in i)if(Object.prototype.hasOwnProperty.call(i,n)){const e=i[n];e&&(t[n]=e)}})),n={status:!0,msg:"success",data:t}}return n};var n={validate:async(e,t,n)=>{const{type_reg:o,size:a,limit:r,duration:s}=n;if("image"===t){let t={w:"",h:"",limit:e.size,type:e.type};const n=new Promise((function(t,i){let n=(window.URL||window.webkitURL).createObjectURL(e),o={},r=new Image;r.onload=function(){let e=r.width,n=r.height,s=a.find((t=>t.width===e&&t.height===n));o.w=e,o.h=n,s?t(o):i("图片尺寸错误")},r.src=n})),s=new Promise((function(i,n){let a=e.type,r=o.test(a);r?i(t):n("图片类型错误")})),l=new Promise((function(i,n){e.size<=r?i(t):n("图片大小错误")})),d=await Promise.allSettled([n,s,l]).then((e=>e));return new Promise(((e,t)=>{let n=i(d);n.status?e(n):t("error")}))}if("video"===t){let t={w:"",h:"",limit:e.size,type:e.type,duration:""};const n=new Promise((function(i,n){let o=URL.createObjectURL(e),r=document.createElement("video");r.onloadedmetadata=function(e){URL.revokeObjectURL(o);let l=r.duration,d=r.videoWidth,c=r.videoHeight;return a.find((e=>e.width===d&&e.height===c))?l<=s?(t.w=d,t.h=c,t.duration=l,i(t)):n("视频时长错误"):n("视频尺寸错误")},r.src=o,r.load()})),l=new Promise((function(i,n){let a=e.type;o.test(a)?i(t):n("视频类型错误")})),d=new Promise((function(i,n){e.size<=r?i(t):n("视频大小错误")})),c=await Promise.allSettled([n,l,d]).then((e=>e));return new Promise(((e,t)=>{let n=i(c);n.status?e(n):t("error")}))}},uploadHttpRequest:async t=>{const i=new FormData;i.append("logo_url",t.file),i.append("f",t.file),i.append("file_name",t.file.name);return await e(i)}};export{n as u};
