import{d as R,aj as q,z as C,C as H,r as p,ak as W,k as D,v as u,i as _,x as l,h as r,j as o,N as j,c as h,O as X,o as b,F as A,l as U,y as g,t as S}from"./vendor-f1931894.js";import{P as Y}from"./index-91887d2e.js";import{A as Z,_ as ee,a as ae,b as te,c as le,d as oe,e as ie}from"./device-662c4955.js";import{m as y}from"./message-c1123ca0.js";import{_ as ne}from"./lodash-43532635.js";import{a as re}from"./new-format-b98ea9a0.js";import{b as se}from"./format-b76f9697.js";import{_ as ce}from"./index-1abff6b8.js";import"./moment-1cf83a0b.js";const de={class:"controlBox w100 mb-10"},ue={class:"mb-10"},pe=g(" Offer Create "),me={class:"flex jc-start flex-wrap w100"},fe={class:"flex"},_e={class:"flex"},ve=g(" \u67E5\u8BE2 "),be={class:"flex jc-around"},he={class:"flex jc-around"},ge={class:"flex jc-between"},ye=["textContent"],De={class:"flex jc-around"},Ve={class:"w100 flex"},ke={class:"dialog-footer"},xe=g("\u786E \u5B9A"),we=R({setup(Fe){const V=q({attribute_provider:[],platform:[],package_name:"",channel:"",id:"",offer_title:"",country:"",pid:""}),z=()=>[...new Array(20)].map((t,n)=>{const d=n*5/100;return{value:d,label:`${(Number(d)*100).toFixed(0)}%`}}),O=()=>[...new Array(20)].map((t,n)=>{const d=(n*5+5)/100;return{value:d,label:`${(Number(d)*100).toFixed(0)}%`}});let s=C({offer:{},index:null,cacheDevice:{},cacheDeviceCount:0}),e=C({dialogVisible:!1,dialogVisibleDevice:!1,cache:{item:{},device:{}},searchForm:V.value,useData:V.value,loading:!0,options:{cutoff_start:z(),cutoff_end:O(),attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],platform:[{value:"1",label:"Android"},{value:"2",label:"iOS"}]},list:[],pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});const k=()=>{e.useData=ne.cloneDeep(e.searchForm),x()},B=async i=>{let t={id:i.id,max_clk_num:parseFloat(i.max_clk_num)},n=await ae(t);y(n)},N=async i=>{let t={id:i.id,site_clk_limit:parseFloat(i.site_clk_limit)},n=await te(t);y(n)},E=async i=>{let t={id:i.id,status:i.status};t=re(t);const n=await le(t);y(n)},P=i=>`/buzz/old-buzz/edit/${i.id}`,x=async()=>{e.loading=!0;let i={page:e.pagination.listQuery.page,page_size:e.pagination.listQuery.limit};e.useData.attribute_provider&&(i.attribute_provider=e.useData.attribute_provider),e.useData.platform&&(i.platform=e.useData.platform),e.useData.package_name&&(i.pkg_name=e.useData.package_name),e.useData.channel&&(i.channel=e.useData.channel),e.useData.id&&(i.offer_id=e.useData.id),e.useData.offer_title&&(i.title=e.useData.offer_title),e.useData.country&&(i.country=e.useData.country),e.useData.pid&&(i.tracking_link=e.useData.pid);const t=await Z(i),{data:n}=t,{page:d}=n;e.list=n==null?void 0:n.data,e.pagination.total=Number(d.count),e.loading=!1},$=async(i,t)=>{console.log("get device"),e.dialogVisibleDevice=!0,s.offer=t,s.index=i;const n={id:t.id,platform:t.platform,country:t.country},{data:d}=await oe(n);s.cacheDevice.all=d.all,s.cacheDevice.select=JSON.parse(t.device)},Q=i=>{s.cacheDevice.select=i},L=i=>{s.cacheDeviceCount=i},T=async()=>{const i={id:s.offer.id,device:JSON.stringify(s.cacheDevice.select)},t=await ie(i);y(t),e.dialogVisibleDevice=!1,s.offer.device_count=s.cacheDeviceCount};return H(()=>{k()}),(i,t)=>{const n=p("el-button"),d=p("router-link"),w=p("el-option"),F=p("el-select"),m=p("el-form-item"),v=p("el-input"),I=p("el-form"),c=p("el-table-column"),M=p("el-switch"),G=p("el-table"),J=p("el-dialog"),K=W("loading");return b(),D("div",null,[u("div",de,[u("div",ue,[_(` <el-button type="primary" @click='createFun'>Offer Create</el-button> `),l(d,{to:"/buzz/old-buzz/create"},{default:r(()=>[l(n,{type:"primary"},{default:r(()=>[pe]),_:1})]),_:1})]),l(I,{modelValue:o(e).searchForm,"onUpdate:modelValue":t[8]||(t[8]=a=>o(e).searchForm=a),inline:!0,class:"flex jc-between w100 ai-end"},{default:r(()=>[u("div",me,[l(m,{label:""},{default:r(()=>[l(F,{modelValue:o(e).searchForm.attribute_provider,"onUpdate:modelValue":t[0]||(t[0]=a=>o(e).searchForm.attribute_provider=a),clearable:"",class:"search-con",placeholder:"Attribute Provider",style:{"min-width":"140px"}},{default:r(()=>[(b(!0),D(A,null,U(o(e).options.attribute_provider,a=>(b(),h(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:""},{default:r(()=>[l(F,{modelValue:o(e).searchForm.platform,"onUpdate:modelValue":t[1]||(t[1]=a=>o(e).searchForm.platform=a),clearable:"",class:"search-con",placeholder:"Platform",style:{"min-width":"95px"}},{default:r(()=>[(b(!0),D(A,null,U(o(e).options.platform,a=>(b(),h(w,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:""},{default:r(()=>[l(v,{modelValue:o(e).searchForm.package_name,"onUpdate:modelValue":t[2]||(t[2]=a=>o(e).searchForm.package_name=a),placeholder:"Package Name",class:"search-con",style:{"min-width":"120px"}},null,8,["modelValue"])]),_:1}),l(m,{label:""},{default:r(()=>[l(v,{modelValue:o(e).searchForm.channel,"onUpdate:modelValue":t[3]||(t[3]=a=>o(e).searchForm.channel=a),placeholder:"Channel",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])]),_:1}),l(m,{label:""},{default:r(()=>[l(v,{modelValue:o(e).searchForm.id,"onUpdate:modelValue":t[4]||(t[4]=a=>o(e).searchForm.id=a),placeholder:"ID",class:"search-con"},null,8,["modelValue"])]),_:1}),l(m,{label:""},{default:r(()=>[l(v,{modelValue:o(e).searchForm.offer_title,"onUpdate:modelValue":t[5]||(t[5]=a=>o(e).searchForm.offer_title=a),placeholder:"Offer Title",class:"search-con",style:{"min-width":"90px"}},null,8,["modelValue"])]),_:1}),l(m,{label:""},{default:r(()=>[l(v,{modelValue:o(e).searchForm.country,"onUpdate:modelValue":t[6]||(t[6]=a=>o(e).searchForm.country=a),placeholder:"Country",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])]),_:1}),l(m,{label:""},{default:r(()=>[l(v,{modelValue:o(e).searchForm.pid,"onUpdate:modelValue":t[7]||(t[7]=a=>o(e).searchForm.pid=a),placeholder:"Pid",class:"search-con"},null,8,["modelValue"])]),_:1})]),u("div",fe,[l(m,{class:"mr-0",style:{"margin-right":"0px"}},{default:r(()=>[u("div",_e,[l(n,{type:"primary",onClick:k},{default:r(()=>[ve]),_:1}),_(' <el-button type="primary" @click="handleExportSearch">\u5BFC\u51FA</el-button> ')])]),_:1})])]),_:1},8,["modelValue"]),_(` <el-input placeholder="\u8BF7\u8F93\u5165\u5185\u5BB9" v-model="data.searchForm.data" class='search-input'>
        <el-button slot="append" icon="Search" @click='searchFun'></el-button>
      </el-input> `)]),_(" table "),j((b(),h(G,{center:"",data:o(e).list,class:"w100",height:"60vh",border:""},{default:r(()=>[l(c,{fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"70"}),l(c,{fixed:"",prop:"channel",label:"Channel",align:"center",width:"60"}),l(c,{prop:"pkg_name",label:"Package Name",align:"center",width:"110"}),l(c,{prop:"title",label:"Offer Title",align:"center"}),l(c,{prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),l(c,{prop:"pid",label:"Pid",align:"center",width:"90"}),l(c,{prop:"platform",label:"Platform",align:"center",width:"65"},{default:r(a=>[g(S(Number(a.row.platform)===1?"Android":"iOS"),1)]),_:1}),l(c,{prop:"country",label:"Country",align:"center",width:"57"}),l(c,{prop:"payout",label:"Payout",align:"center",width:"55"}),l(c,{label:"Click Limitation",width:"150",align:"center"},{default:r(a=>[u("div",be,[l(v,{modelValue:a.row.max_clk_num,"onUpdate:modelValue":f=>a.row.max_clk_num=f,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:f=>B(a.row)},null,8,["onClick"])])]),_:1}),l(c,{label:"Site Click Limitation",width:"150",align:"center"},{default:r(a=>[u("div",he,[l(v,{modelValue:a.row.site_clk_limit,"onUpdate:modelValue":f=>a.row.site_clk_limit=f,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:f=>N(a.row)},null,8,["onClick"])])]),_:1}),l(c,{label:"Select Device",width:"120",align:"center"},{default:r(a=>[u("div",ge,[u("span",{textContent:S(o(se)(a.row.device_count))},null,8,ye),l(n,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:f=>$(a.$index,a.row)},null,8,["onClick"])])]),_:1}),l(c,{label:"Operation",align:"center"},{default:r(a=>[u("div",De,[l(d,{to:P(a.row)},{default:r(()=>[l(n,{class:"cp mr-10",type:"primary",icon:"Edit",circle:""})]),_:2},1032,["to"]),_(` <el-button class='cp mr-10' type="primary" icon="Edit" circle @click='editFun(scope.row)'></el-button> `),l(M,{modelValue:a.row.status,"onUpdate:modelValue":f=>a.row.status=f,"active-value":1,"inactive-value":2,onChange:f=>E(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),_:1})]),_:1},8,["data"])),[[K,o(e).loading]]),_(" \u5206\u9875 "),u("div",Ve,[j(l(o(Y),{page:o(e).pagination.listQuery.page,"onUpdate:page":t[9]||(t[9]=a=>o(e).pagination.listQuery.page=a),limit:o(e).pagination.listQuery.limit,"onUpdate:limit":t[10]||(t[10]=a=>o(e).pagination.listQuery.limit=a),total:o(e).pagination.total,"page-sizes":o(e).pagination.pageSizes,onPagination:x},null,8,["page","limit","total","page-sizes"]),[[X,o(e).pagination.total]])]),_(" device "),l(J,{modelValue:o(e).dialogVisibleDevice,"onUpdate:modelValue":t[13]||(t[13]=a=>o(e).dialogVisibleDevice=a),title:"Device"},{default:r(()=>[o(e).dialogVisibleDevice?(b(),h(ee,{key:0,all:o(s).cacheDevice.all,"onUpdate:all":t[11]||(t[11]=a=>o(s).cacheDevice.all=a),select:o(s).cacheDevice.select,"onUpdate:select":t[12]||(t[12]=a=>o(s).cacheDevice.select=a),onKk:Q,onCount:L},null,8,["all","select"])):_("v-if",!0),u("span",ke,[_(' <el-button @click="cancleDevice">\u53D6 \u6D88</el-button> '),l(n,{type:"primary",onClick:T},{default:r(()=>[xe]),_:1})])]),_:1},8,["modelValue"])])}}});var Ee=ce(we,[["__scopeId","data-v-0b56db22"]]);export{Ee as default};
