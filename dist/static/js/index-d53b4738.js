import{_ as e,m as a,s as t,n as i,A as l,p as s,z as o,c as d,b as n,x as m,O as u,P as r,v as p}from"./index-b160a4d6.js";import{m as b}from"./vuex.esm-bundler-4d56da27.js";import{g as c}from"./role-dd0ab8c0.js";import{g as h,a as f,s as g,b as D}from"./station-1c9c4718.js";import{m as y}from"./message-6c553f21.js";import{m as V}from"./self-680a49e8.js";const _={components:{},mixins:[V],data:()=>({options:{role:[],pid:[],base_url:""},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",pid:"",role:[],base_url:""},choiceData:{}}}),computed:{...b(["element"])},created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await c();this.options.role=e},async getList(){const{data:e}=await h();this.data=e,this.list=e,this.options.pid=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:a}=await f(this.busData.item.id);a.position,this.busData.item.id=a.position.id,this.busData.item.name=a.position.name,a.position.pid&&(this.busData.item.pid=a.position.pid.toString()),this.busData.item.role=a.position_role,this.dialogVisible=!0;const t=new Date;this.date=t.getTime()},handleDelete(e){},roleChangeChoice(e,a){this.busData.choiceData[e]=a},clearBusData(){this.busData={item:{id:"",name:"",pid:"",role:[]},choiceData:{}}},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,pid:this.busData.item.pid,role_id:this.busData.item.role},a=await g(e);a&&y(a),this.getList()}if("edit"===this.dialogType){const e={id:this.busData.item.id,name:this.busData.item.name,role_id:this.busData.item.role},a=await D(this.busData.item.id,e);a&&y(a)}this.clearBusData(),this.dialogVisible=!1}}},w={class:"app-container"},C=n(" 新建 "),k=n(" 修改 "),v=n(" 删除 "),T={slot:"footer",class:"dialog-footer"},j=n(" 取 消 "),A=n(" 确 定 ");var E=e(_,[["render",function(e,b,c,h,f,g){const D=a("el-button"),y=a("el-table-column"),V=a("el-table"),_=a("el-input"),E=a("el-form-item"),x=a("el-option"),F=a("el-select"),P=a("el-form"),L=a("el-dialog");return t(),i("div",w,[e.judgePermissionElementFn("A-AS-ADD-V")?(t(),l(D,{key:0,type:"primary",onClick:g.handleCreate},{default:s((()=>[C])),_:1},8,["onClick"])):o("v-if",!0),d(V,{data:f.list,style:{width:"100%","margin-top":"30px"},border:""},{default:s((()=>[d(y,{align:"center",label:"ID"},{default:s((e=>[n(m(e.row.id),1)])),_:1}),d(y,{align:"center",label:"Name"},{default:s((e=>[n(m(e.row.name),1)])),_:1}),d(y,{align:"center",label:"Operations"},{default:s((a=>[e.judgePermissionElementFn("A-AS-EDIT-V")?(t(),l(D,{key:0,type:"primary",size:"small",onClick:e=>g.handleEdit(a)},{default:s((()=>[k])),_:2},1032,["onClick"])):o("v-if",!0),e.judgePermissionElementFn("A-AS-DEL-V")?(t(),l(D,{key:1,type:"danger",size:"small",onClick:e=>g.handleDelete(a)},{default:s((()=>[v])),_:2},1032,["onClick"])):o("v-if",!0)])),_:1})])),_:1},8,["data"]),d(L,{modelValue:f.dialogVisible,"onUpdate:modelValue":b[4]||(b[4]=e=>f.dialogVisible=e),title:"edit"===f.dialogType?"Edit Role":"New Role",width:"90%"},{default:s((()=>[d(P,{"label-width":"150px","label-position":"left"},{default:s((()=>[d(E,{label:"Name"},{default:s((()=>[d(_,{modelValue:f.busData.item.name,"onUpdate:modelValue":b[0]||(b[0]=e=>f.busData.item.name=e),disabled:"edit"===f.dialogType,placeholder:""},null,8,["modelValue","disabled"])])),_:1}),d(E,{label:"PID"},{default:s((()=>[d(F,{modelValue:f.busData.item.pid,"onUpdate:modelValue":b[1]||(b[1]=e=>f.busData.item.pid=e),disabled:"edit"===f.dialogType,filterable:"",class:"w100",placeholder:"请选择"},{default:s((()=>[(t(!0),i(u,null,r(f.options.pid,(e=>(t(),l(x,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),d(E,{label:"Role"},{default:s((()=>[d(F,{modelValue:f.busData.item.role,"onUpdate:modelValue":b[2]||(b[2]=e=>f.busData.item.role=e),filterable:"",multiple:"",class:"w100",placeholder:"支持多选"},{default:s((()=>[(t(!0),i(u,null,r(f.options.role,(e=>(t(),l(x,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),p("div",T,[d(D,{onClick:b[3]||(b[3]=e=>f.dialogVisible=!1)},{default:s((()=>[j])),_:1}),d(D,{type:"primary",onClick:g.submitFn},{default:s((()=>[A])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{E as default};
