import{d as e,h as l,r as a,L as o,q as r,o as t,c as s,z as m,e as d,s as i,v as u,x as f,P as n,y as c,f as p,g as _}from"./main-665d1af0.js";import{b as F,c as b,d as y}from"./tool-baad0d0c.js";import{m as g}from"./message-6257d60b.js";import{_ as v}from"./index-e6191d9f.js";import{u as w}from"./useUtils-761e0430.js";import{d as V,e as h,f as x}from"./new-format-478034c0.js";import{_ as j}from"./lodash-1f0c0f2f.js";const U={class:"content-con from-one flex column"},q={class:"content-con from-one flex column"},C={class:"w100 flex"},D=p(" 确认 "),M=p(" 取消 "),k=e({setup(e){const{getRouterData:p,getCommonCountryList:k,goNewUrl:I}=w();let{proxy:L}=_();const z="此项必填";let N=l("create");const P={id:"",ad_id:"",ad_name:"",desc:"",flow_rate:""},R=a({ruleForm:P,rules:{ad_name:[{required:!0,message:z,trigger:["blur","change"]}],flow_rate:[{required:!0,message:z,trigger:["blur","change"]}]},options:{}}),S=()=>{L.$refs.ruleForm.validate((e=>{if(!e)return!1;B()}))},$=["flow_rate"],A=[],B=async()=>{let e=n(R.ruleForm);if(e=V(e),e=h(e,$),"create"===N.value){delete e.id;const l=await F(e);g(l)&&E()}if("edit"===N.value){const l=await b(e);g(l)&&E()}},E=()=>{let e="";"create"===N.value&&(e="./list"),"edit"===N.value&&(e="../list"),I({url:e})},G=()=>{var e,l;let{query:a,params:o}=p();if(a.type,N.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",(async()=>{})(),"create"===N.value&&(R.ruleForm=j.cloneDeep(P)),"edit"===N.value){const{id:e}=o;(async e=>{const l=await y(e),{data:a}=l;R.ruleForm=x(a,A)})(e)}};return o((()=>{G()})),(e,l)=>{const a=r("el-form-item"),o=r("el-input"),n=r("el-form"),p=r("el-button");return t(),s("div",null,[m(" form "),d(n,{ref:"ruleForm",enctype:"multipart/form-data",rules:u(R).rules,model:u(R).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===u(N)&&2===u(R).ruleForm.is_del},{default:i((()=>[d(u(v),{title:"基本信息"}),f("div",U,[d(a,{class:"self-el-form-item",label:"ID:",prop:"id"},{default:i((()=>[f("span",null,c(u(R).ruleForm.id),1)])),_:1}),d(a,{class:"self-el-form-item",label:"广告主名称:",prop:"ad_name"},{default:i((()=>[d(o,{modelValue:u(R).ruleForm.ad_name,"onUpdate:modelValue":l[0]||(l[0]=e=>u(R).ruleForm.ad_name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),d(a,{class:"self-el-form-item",label:"广告主ID:",prop:"ad_id"},{default:i((()=>[d(o,{modelValue:u(R).ruleForm.ad_id,"onUpdate:modelValue":l[1]||(l[1]=e=>u(R).ruleForm.ad_id=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),d(a,{class:"self-el-form-item",label:"描述:",prop:"desc"},{default:i((()=>[d(o,{modelValue:u(R).ruleForm.desc,"onUpdate:modelValue":l[2]||(l[2]=e=>u(R).ruleForm.desc=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),d(u(v),{title:"广告主配置"}),f("div",q,[d(a,{class:"self-el-form-item",label:"强制流量占比(%):",prop:"flow_rate"},{default:i((()=>[d(o,{modelValue:u(R).ruleForm.flow_rate,"onUpdate:modelValue":l[3]||(l[3]=e=>u(R).ruleForm.flow_rate=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number"},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),m(" form "),m(" footer "),f("div",C,[d(p,{type:"primary",onClick:S},{default:i((()=>[D])),_:1}),d(p,{type:"primary",onClick:E},{default:i((()=>[M])),_:1})])])}}});export{k as default};
