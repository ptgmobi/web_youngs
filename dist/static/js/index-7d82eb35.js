import{_ as e,q as i,c as a,A as t,s,z as l,e as o,o as n,f as d,y as m,N as r,O as u,x as p}from"./main-0a777472.js";import{m as b}from"./vuex.esm-bundler-f200bff2.js";import{g as c}from"./power-442f088b.js";import{g as f,a as h,s as g,b as D}from"./role-fbefbe1a.js";import{m as y}from"./message-d6ce123e.js";import{m as V}from"./self-732f5551.js";const _={components:{},mixins:[V],data:()=>({options:{permissions:[]},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",permissions:[]},choiceData:{}}}),computed:{...b(["element"])},created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await c();this.options.permissions=e.permission},async getList(){const{data:e}=await f();this.data=e,this.list=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.busData.item.name="",this.busData.item.permissions=[],this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:i}=await h(this.busData.item.id);this.busData.item.name=i.role[0].name,this.busData.item.permissions=i.role_permission,this.dialogVisible=!0;const a=new Date;this.date=a.getTime()},handleDelete(e){},roleChangeChoice(e,i){this.busData.choiceData[e]=i},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,permission_id:this.busData.item.permissions},i=await g(e);i&&y(i),this.getList()}if("edit"===this.dialogType){const e={role_id:this.busData.item.id,permission_id:this.busData.item.permissions},i=await D(this.busData.item.id,e);i&&y(i)}this.dialogVisible=!1}}},w={class:"app-container"},C={slot:"footer",class:"dialog-footer"};var k=e(_,[["render",function(e,b,c,f,h,g){const D=i("el-button"),y=i("el-table-column"),V=i("el-table"),_=i("el-input"),k=i("el-form-item"),T=i("el-option"),j=i("el-select"),v=i("el-form"),A=i("el-dialog");return n(),a("div",w,[e.judgePermissionElementFn("A-AR-ADD-V")?(n(),t(D,{key:0,type:"primary",onClick:g.handleCreate},{default:s((()=>[d(" 新建 ")])),_:1},8,["onClick"])):l("v-if",!0),o(V,{data:h.list,style:{width:"100%","margin-top":"30px"},border:""},{default:s((()=>[o(y,{align:"center",label:"ID"},{default:s((e=>[d(m(e.row.id),1)])),_:1}),o(y,{align:"center",label:"Name"},{default:s((e=>[d(m(e.row.name),1)])),_:1}),o(y,{align:"center",label:"Operations"},{default:s((i=>[e.judgePermissionElementFn("A-AR-EDIT-V")?(n(),t(D,{key:0,type:"primary",size:"small",onClick:e=>g.handleEdit(i)},{default:s((()=>[d(" 修改 ")])),_:2},1032,["onClick"])):l("v-if",!0),e.judgePermissionElementFn("A-AR-DEL-V")?(n(),t(D,{key:1,type:"danger",size:"small",onClick:e=>g.handleDelete(i)},{default:s((()=>[d(" 删除 ")])),_:2},1032,["onClick"])):l("v-if",!0)])),_:1})])),_:1},8,["data"]),o(A,{modelValue:h.dialogVisible,"onUpdate:modelValue":b[3]||(b[3]=e=>h.dialogVisible=e),title:"edit"===h.dialogType?"Edit Role":"New Role",width:"90%"},{default:s((()=>[o(v,{"label-width":"150px","label-position":"left"},{default:s((()=>[o(k,{label:"Name"},{default:s((()=>[o(_,{modelValue:h.busData.item.name,"onUpdate:modelValue":b[0]||(b[0]=e=>h.busData.item.name=e),placeholder:"",disabled:"edit"===h.dialogType},null,8,["modelValue","disabled"])])),_:1}),o(k,{label:"Permissions"},{default:s((()=>[o(j,{modelValue:h.busData.item.permissions,"onUpdate:modelValue":b[1]||(b[1]=e=>h.busData.item.permissions=e),filterable:"",multiple:"",clearable:"",class:"w100",placeholder:"支持多选"},{default:s((()=>[(n(!0),a(r,null,u(h.options.permissions,(e=>(n(),t(T,{key:e.id,label:e.type,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),p("div",C,[o(D,{onClick:b[2]||(b[2]=e=>h.dialogVisible=!1)},{default:s((()=>[d(" 取 消 ")])),_:1}),o(D,{type:"primary",onClick:g.submitFn},{default:s((()=>[d(" 确 定 ")])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{k as default};
