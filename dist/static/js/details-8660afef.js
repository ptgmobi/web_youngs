import{_ as e,d as l,h as a,r,L as o,q as t,c as s,z as d,e as m,s as u,v as i,x as n,P as c,o as p,A as f,y as _,N as v,O as b,K as g,f as y,g as h}from"./main-0a777472.js";import{u as F,s as V}from"./useUtils-9816d64a.js";import{b as w,c as U,d as x}from"./dsp-advertiser-4a2a0a9c.js";import{m as k}from"./message-d6ce123e.js";import{_ as q}from"./index-1624392f.js";import{d as j,e as z}from"./new-format-7f959bed.js";import{s as M}from"./validate-31aaa08c.js";import{_ as L}from"./lodash-4786ff9c.js";import{u as C}from"./upload-5fd7378f.js";const R={class:"content-con from-one flex column"},P=["src"],D={class:"content-con from-one flex column"},I={class:"content-con from-one flex column"},O={class:"content-con from-one flex column"},N={class:"w100 flex"};var $=e(l({__name:"details",setup(e){const{validate:l,uploadHttpRequest:$}=C,{uploadUrl:A,adv_type:E,ind_cla:H,third_party:K,return_mode:S,time_zone:T}=V,{getRouterData:B,getCommonCountryList:G,goNewUrl:J}=F();let{proxy:Q}=h();const W="此项必填";let X=a("create"),Y=a([]);const Z={id:void 0,adv_id:"",name:"",descs:"",adv_type:"",adv_address:"",ind_cla:"",logo:"",time_zone:"UTC+8",price:void 0,spend_limit:void 0,flow_rate:void 0,third_party:"",click_url:"",impression_url:"",return_mode:"",is_del:0},ee=(e,l,a)=>{const{max:r}=e;M(l,r)?a(void 0):a(new Error("值的长度不能大于${}"))},le=r({ruleForm:Z,rules:{name:[{required:!0,message:W,trigger:["blur","change"]},{validator:ee,max:100,trigger:["blur","change"]}],descs:[{validator:ee,max:200,trigger:["blur","change"]}],adv_type:[{required:!0,message:W,trigger:["blur","change"]}],adv_address:[{required:!0,message:W,trigger:["blur","change"]}],ind_cla:[{required:!0,message:W,trigger:["blur","change"]}],price:[{required:!0,message:W,trigger:["blur","change"]}],spend_limit:[{required:!0,message:W,trigger:["blur","change"]}],third_party:[{required:!0,message:W,trigger:["blur","change"]}]},options:{adv_type:E,ind_cla:H,time_zone:T,third_party:K,return_mode:S}}),ae=()=>{Q.$refs.ruleForm.validate((e=>{if(!e)return!1;oe()}))},re=["id","price","spend_limit","flow_rate"],oe=async()=>{let e=c(le.ruleForm);if(e=j(e),e=z(e,re),"create"===X.value){delete e.id;const l=await w(e);k(l)&&te()}if("edit"===X.value){const l=await U(e);k(l)&&te()}},te=()=>{J({url:"/advertiser/list"})},se=(e,l)=>{le.ruleForm.logo=e.data},de=async e=>{const l="image/png"===e.type,a=e.size/1048576<100,r=new Promise((function(l,a){let r=window.URL||window.webkitURL,o=new Image;o.onload=function(){let e=o.width<=100&&o.height<=100;e=!0,l(null)},o.src=r.createObjectURL(e)})).then((()=>e),(()=>(console.error("图片尺寸过大,请上传100*100尺寸的图片"),Promise.reject())));return l||console.error("格式错误，请上传png格式图片"),a||console.error("文件过大，文件大小不超过100M"),r},me=()=>{var e,l;let{query:a,params:r}=B();if(X.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",(async()=>{})(),"create"===X.value&&(le.ruleForm=L.cloneDeep(Z)),"edit"===X.value){const{id:e}=r;(async e=>{const l=await x(e),{data:a}=l;le.ruleForm={...le.ruleForm,...a},Y.value=[{name:"logo_url",url:le.ruleForm.logo}],le.ruleForm})(e)}};return o((()=>{me()})),(e,l)=>{const a=t("el-form-item"),r=t("el-input"),o=t("el-option"),c=t("el-select"),h=t("Plus"),F=t("el-icon"),V=t("el-upload"),w=t("el-form"),U=t("el-button");return p(),s("div",null,[d(" form "),m(w,{ref:"ruleForm",enctype:"multipart/form-data",rules:i(le).rules,model:i(le).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===i(X)&&2===i(le).ruleForm.is_del},{default:u((()=>[m(i(q),{title:"基础信息"}),n("div",R,["edit"===i(X)?(p(),f(a,{key:0,class:"self-el-form-item",label:"广告主ID:",prop:"adv_id"},{default:u((()=>[n("span",null,_(i(le).ruleForm.adv_id),1)])),_:1})):d("v-if",!0),m(a,{class:"self-el-form-item",label:"广告主名称:",prop:"name"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>i(le).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"描述:",prop:"descs"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.descs,"onUpdate:modelValue":l[1]||(l[1]=e=>i(le).ruleForm.descs=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"广告主类型:",prop:"adv_type"},{default:u((()=>[m(c,{modelValue:i(le).ruleForm.adv_type,"onUpdate:modelValue":l[2]||(l[2]=e=>i(le).ruleForm.adv_type=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:u((()=>[(p(!0),s(v,null,b(i(le).options.adv_type,(e=>(p(),f(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"广告主地址:",prop:"adv_address"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.adv_address,"onUpdate:modelValue":l[3]||(l[3]=e=>i(le).ruleForm.adv_address=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"行业分类:",prop:"ind_cla"},{default:u((()=>[m(c,{modelValue:i(le).ruleForm.ind_cla,"onUpdate:modelValue":l[4]||(l[4]=e=>i(le).ruleForm.ind_cla=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:u((()=>[(p(!0),s(v,null,b(i(le).options.ind_cla,(e=>(p(),f(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"Logo:",prop:"logo"},{default:u((()=>[m(V,{class:"avatar-uploader",name:"logo_url",action:"","file-list":i(Y),"onUpdate:file-list":l[5]||(l[5]=e=>g(Y)?Y.value=e:Y=e),"show-file-list":!1,"on-success":se,"before-upload":de,"http-request":i($)},{default:u((()=>[i(le).ruleForm.logo?(p(),s("img",{key:0,src:i(le).ruleForm.logo,class:"avatar"},null,8,P)):(p(),f(F,{key:1,class:"avatar-uploader-icon"},{default:u((()=>[m(h)])),_:1}))])),_:1},8,["file-list","http-request"])])),_:1})]),m(i(q),{title:"Offer信息"}),n("div",D,[m(a,{class:"self-el-form-item",label:"选择时区:",prop:"time_zone"},{default:u((()=>[m(c,{modelValue:i(le).ruleForm.time_zone,"onUpdate:modelValue":l[6]||(l[6]=e=>i(le).ruleForm.time_zone=e),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:u((()=>[(p(!0),s(v,null,b(i(le).options.time_zone,(e=>(p(),f(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"转化单价（美元）:",prop:"price"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.price,"onUpdate:modelValue":l[7]||(l[7]=e=>i(le).ruleForm.price=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number",step:"0.001"},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"日花费上限（美元）:",prop:"spend_limit"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.spend_limit,"onUpdate:modelValue":l[8]||(l[8]=e=>i(le).ruleForm.spend_limit=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"强制流量占比%:",prop:"flow_rate"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.flow_rate,"onUpdate:modelValue":l[9]||(l[9]=e=>i(le).ruleForm.flow_rate=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1})]),m(i(q),{title:"追踪信息"}),n("div",I,[m(a,{class:"self-el-form-item",label:"第三方监测平台:",prop:"third_party"},{default:u((()=>[m(c,{modelValue:i(le).ruleForm.third_party,"onUpdate:modelValue":l[10]||(l[10]=e=>i(le).ruleForm.third_party=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:u((()=>[(p(!0),s(v,null,b(i(le).options.third_party,(e=>(p(),f(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"点击监测链接:",prop:"click_url"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.click_url,"onUpdate:modelValue":l[11]||(l[11]=e=>i(le).ruleForm.click_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1}),m(a,{class:"self-el-form-item",label:"曝光监测链接:",prop:"impression_url"},{default:u((()=>[m(r,{modelValue:i(le).ruleForm.impression_url,"onUpdate:modelValue":l[12]||(l[12]=e=>i(le).ruleForm.impression_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),m(i(q),{title:"数据回传"}),n("div",O,[m(a,{class:"self-el-form-item",label:"回传方式:",prop:"return_mode"},{default:u((()=>[m(c,{modelValue:i(le).ruleForm.return_mode,"onUpdate:modelValue":l[13]||(l[13]=e=>i(le).ruleForm.return_mode=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:u((()=>[(p(!0),s(v,null,b(i(le).options.return_mode,(e=>(p(),f(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),d(" form "),d(" footer "),n("div",N,[m(U,{type:"primary",onClick:ae},{default:u((()=>[y(" 确认 ")])),_:1}),m(U,{type:"primary",onClick:te},{default:u((()=>[y(" 取消 ")])),_:1})])])}}}),[["__scopeId","data-v-f702f7e8"]]);export{$ as default};
