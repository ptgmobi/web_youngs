var e=Object.defineProperty,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,t=(l,r,a)=>r in l?e(l,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[r]=a,o=(e,o)=>{for(var i in o||(o={}))r.call(o,i)&&t(e,i,o[i]);if(l)for(var i of l(o))a.call(o,i)&&t(e,i,o[i]);return e};import{d as i,a as u,r as d,e as c,w as n,I as p,a1 as m,M as s,m as _,s as f,n as y,z as b,c as F,p as h,v as g,q as v,A as V,O as k,P as x,b as w,x as j,L as A}from"./index-652e212f.js";import{f as O,g as U,h as D,i as N}from"./buzzsync-c9583060.js";import{m as S}from"./message-ffb9da26.js";const q={class:"content-con flex column"},P={class:"flex jc-start form-one jc-start radio-box"},M=w(" whole traffic "),z=w(" diversity in platform "),C={class:"flex jc-start form-one jc-start radio-box"},I=w(" whole preclick "),T=w(" diversity in platform "),J={class:"flex jc-start form-one jc-start radio-box"},R={class:"flex jc-start form-one jc-start radio-box"},E=w(" app download "),G=w(" 非app download "),B={class:"flex jc-start form-one jc-start radio-box"},L=w(" 代理 "),$=w(" API "),H=w(" 直客 "),K={class:"flex jc-start form-one jc-start radio-box"},Q={class:"w100 flex"},W=w(" Save "),X=i({setup(e){let{proxy:l}=A();const r=u(),a="此项必填";let t=d({type:[{value:1,label:"no creatives无素材"},{value:2,label:"pictures图片广告"},{value:3,label:"原生视频广告"},{value:4,label:"rewarded video激励视频"},{value:5,label:"敏感频道"},{value:6,label:"CPS"},{value:7,label:"新banner"},{value:8,label:"新插屏"}]}),i=d({offer:{},index:null,cacheDevice:{}}),X=c(""),Y=c(0),Z=c([0,100]),ee=d({dialogVisibleDevice:!1,dialogVisibleSite:!1,search:{input:""},type:"1",params:"",loading:!0,options:{channel:[],attribute_provider:["AppsFlyer","Branch","Adjust","Singular","AppMetrica"],time:[-1,...[...new Array(24)].map(((e,l)=>l))],platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],country:[],site_id:["0.2","0.4","0.6","1","2","4","8","24","72","168"],category:[],devices:[]},ruleForm:{name:"",short_name:"",desc:"",traffic_type:1,traffic_type_all:"100",traffic_type_ios:"100",traffic_type_android:"100",pre_click_type:1,pre_click_type_all:"100",pre_click_type_ios:"100",pre_click_type_android:"100",type:[],channel_content:"",channel_type:"",fenix_connected:1,adv_id:"",group:""},rules:{name:[{required:!0,message:a,trigger:["blur","change"]}],short_name:[{required:!0,message:a,trigger:["blur","change"]}],desc:[{required:!0,message:a,trigger:["blur","change"]}],traffic_type:[{required:!0,message:a,trigger:["blur","change"]}],traffic_type_all:[{required:!0,message:a,trigger:["blur","change"]}],traffic_type_ios:[{required:!0,message:a,trigger:["blur","change"]}],traffic_type_android:[{required:!0,message:a,trigger:["blur","change"]}],pre_click_type:[{required:!0,message:a,trigger:["blur","change"]}],pre_click_type_all:[{required:!0,message:a,trigger:["blur","change"]}],pre_click_type_ios:[{required:!0,message:a,trigger:["blur","change"]}],pre_click_type_android:[{required:!0,message:a,trigger:["blur","change"]}],type:[{required:!0,message:a,trigger:["blur","change"]}],channel_content:[{required:!0,message:a,trigger:["blur","change"]}],channel_type:[{required:!0,message:a,trigger:["blur","change"]}],fenix_connected:[{required:!0,message:a,trigger:["blur","change"]}]},siteData:[]});const le=()=>{re("ruleForm")},re=e=>{l.$refs[e].validate((e=>{if(!e)return!1;ae()}))},ae=async()=>{let e;ee.ruleForm;let l=o({},ee.ruleForm);l.clk_id=parseFloat(l.clk_id),l.conversion_flow=parseFloat(l.conversion_flow),l.cutoff_end=parseFloat(l.cutoff_end),l.cutoff_start=parseFloat(l.cutoff_start),l.end_hour=parseFloat(l.end_hour),l.start_hour=parseFloat(l.start_hour),l.hour=parseFloat(l.hour),l.max_clk_num=parseFloat(l.max_clk_num),l.payout=parseFloat(l.payout),l.platform=parseFloat(l.platform),l.site_clk_id=parseFloat(l.site_clk_id),l.site_clk_limit=parseFloat(l.site_clk_limit),l.site_id=parseFloat(l.site_id),l.site_install_limitation=parseFloat(l.site_install_limitation),l.diy_siteid=JSON.stringify(l.diy_siteid),l.device=JSON.stringify(l.device),"1"===ee.ruleForm.type&&(delete l.id,delete l.offer_id,e=await O(l)),"2"===ee.ruleForm.type&&(e=await U(l)),S(e)&&window.close()};n(Z,((e,l)=>{(e=>{ee.ruleForm.cutoff_start=e[0]/100,ee.ruleForm.cutoff_end=e[1]/100})(e)}),{immediate:!0});p((()=>{const e=Y.value,l=ee.ruleForm.cutoff_start,r=ee.ruleForm.cutoff_end;return{judge:((Number(r)-Number(l))*Number(e)).toFixed(0),all:Number(e).toFixed(0)}})),m((()=>{(async()=>{ee.ruleForm.pkg_name,ee.ruleForm.country,ee.ruleForm.platform})()}));const te=async e=>{const l=await N(e),{data:r}=l;ee.ruleForm=((e,l)=>{let r={};return l.type,e.device&&(e.device=JSON.parse(e.device)),e.diy_siteid&&(e.diy_siteid=JSON.parse(e.diy_siteid)),"2"===l.type&&(r.id=e.id,r.offer_id=e.offer_id),r=o(o({},e),l),"1"===l.type&&(delete r.id,delete r.offer_id),r})(r,{type:ee.ruleForm.type,isCopy:!1}),i.offer=r};return p((()=>{const e=ee.ruleForm.tracking_link,l=ee.ruleForm.attribute_provider;let r="";if("AppsFlyer"===l){const l=/pid=([\s\S]*)_int/g,a=[...e.matchAll(l)];if(0!==a.length)return r=a[0][1],ee.ruleForm.pid=r,r}if("Adjust"===l){const l=/https:\/\/app.adjust.com\/([\s\S]*)\?/g,a=[...e.matchAll(l)];if(0!==a.length)return r=a[0][1],ee.ruleForm.pid=r,r}return ee.ruleForm.pid=r,r})),p((()=>{let e=0;if(i.cacheDevice,i.cacheDevice.hasOwnProperty("all")&&i.cacheDevice.hasOwnProperty("select")){let l=i.cacheDevice.all,r=i.cacheDevice.select;0!==l.length&&0!==r.length&&l.forEach((l=>{r.forEach((r=>{l.source===r.source&&l.label===r.label&&(e+=parseInt(l.device_count))}))})),ee.search.deviceData.count=e}return null!=e?e:ee.search.deviceData.count})),s((()=>{if((async()=>{const e=await D();if(e){const{data:l}=e;return ee.options.channel=Object.values(l.channel),ee.options.country=Object.values(l.country),ee.options.category=Object.values(l.category),"获取配置成功"}})(),X.value=r.currentRoute.value.name,X.value,"buzz-sync-create"===X.value&&(ee.ruleForm.operation_type="1",ee.ruleForm.type="1"),"buzz-sync-edit"===X.value){ee.ruleForm.operation_type="2",ee.ruleForm.type="2";const e=r.currentRoute.value.params.id;te(e)}})),(e,l)=>{const r=_("el-input"),a=_("el-form-item"),o=_("el-radio"),i=_("el-checkbox"),u=_("el-checkbox-group"),d=_("el-switch"),c=_("el-form"),n=_("el-button");return f(),y("div",null,[b(" form "),F(c,{ref:"ruleForm",enctype:"multipart/form-data",rules:v(ee).rules,model:v(ee).ruleForm,"label-width":"240px","label-position":"right"},{default:h((()=>[g("div",q,[b(" AD Network Name "),F(a,{label:"AD Network Name:",prop:"name"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>v(ee).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1}),b(" AD Network Short Name "),F(a,{label:"AD Network Short Name:",prop:"short_name"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.short_name,"onUpdate:modelValue":l[1]||(l[1]=e=>v(ee).ruleForm.short_name=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1}),b(" AD Network Description "),F(a,{class:"mb-30",label:"AD Network Description:",prop:"desc"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.desc,"onUpdate:modelValue":l[2]||(l[2]=e=>v(ee).ruleForm.desc=e),modelModifiers:{trim:!0},class:"form-one",type:"textarea",autosize:{minRows:8,maxRows:80},placeholder:""},null,8,["modelValue"])])),_:1}),b(" Percent Of Traffic "),F(a,{label:"Percent Of Traffic:",prop:"traffic_type"},{default:h((()=>[g("div",P,[F(o,{modelValue:v(ee).ruleForm.traffic_type,"onUpdate:modelValue":l[3]||(l[3]=e=>v(ee).ruleForm.traffic_type=e),label:1},{default:h((()=>[M])),_:1},8,["modelValue"]),F(o,{modelValue:v(ee).ruleForm.traffic_type,"onUpdate:modelValue":l[4]||(l[4]=e=>v(ee).ruleForm.traffic_type=e),label:2},{default:h((()=>[z])),_:1},8,["modelValue"])])])),_:1}),b(" All "),1==v(ee).ruleForm.traffic_type?(f(),V(a,{key:0,label:"all(%)",prop:"traffic_type_all"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.traffic_type_all,"onUpdate:modelValue":l[5]||(l[5]=e=>v(ee).ruleForm.traffic_type_all=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1})):b("v-if",!0),b(" iOS "),2==v(ee).ruleForm.traffic_type?(f(),V(a,{key:1,label:"iOS(%):",prop:"traffic_type_ios"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.traffic_type_ios,"onUpdate:modelValue":l[6]||(l[6]=e=>v(ee).ruleForm.traffic_type_ios=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1})):b("v-if",!0),b(" Android "),2==v(ee).ruleForm.traffic_type?(f(),V(a,{key:2,label:"Android(%):",prop:"traffic_type_android"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.traffic_type_android,"onUpdate:modelValue":l[7]||(l[7]=e=>v(ee).ruleForm.traffic_type_android=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1})):b("v-if",!0),b(" Percent Of Preclick "),F(a,{label:"Percent Of Preclick:",prop:"clk_id"},{default:h((()=>[g("div",C,[F(o,{modelValue:v(ee).ruleForm.pre_click_type,"onUpdate:modelValue":l[8]||(l[8]=e=>v(ee).ruleForm.pre_click_type=e),label:1},{default:h((()=>[I])),_:1},8,["modelValue"]),F(o,{modelValue:v(ee).ruleForm.pre_click_type,"onUpdate:modelValue":l[9]||(l[9]=e=>v(ee).ruleForm.pre_click_type=e),label:2},{default:h((()=>[T])),_:1},8,["modelValue"])])])),_:1}),b(" All "),1==v(ee).ruleForm.pre_click_type?(f(),V(a,{key:3,label:"all(%)",prop:"pre_click_type_all"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.pre_click_type_all,"onUpdate:modelValue":l[10]||(l[10]=e=>v(ee).ruleForm.pre_click_type_all=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1})):b("v-if",!0),b(" iOS "),2==v(ee).ruleForm.pre_click_type?(f(),V(a,{key:4,label:"iOS(%):",prop:"pre_click_type_ios"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.pre_click_type_ios,"onUpdate:modelValue":l[11]||(l[11]=e=>v(ee).ruleForm.pre_click_type_ios=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1})):b("v-if",!0),b(" Android "),2==v(ee).ruleForm.pre_click_type?(f(),V(a,{key:5,label:"Android(%):",prop:"pre_click_type_android"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.pre_click_type_android,"onUpdate:modelValue":l[12]||(l[12]=e=>v(ee).ruleForm.pre_click_type_android=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1})):b("v-if",!0),b(" type "),F(a,{label:"Type"},{default:h((()=>[g("div",J,[F(u,{modelValue:v(ee).ruleForm.type,"onUpdate:modelValue":l[13]||(l[13]=e=>v(ee).ruleForm.type=e)},{default:h((()=>[(f(!0),y(k,null,x(v(t).type,(e=>(f(),V(i,{key:e.value,label:e.value,disabled:e.require},{default:h((()=>[w(j(e.label),1)])),_:2},1032,["label","disabled"])))),128))])),_:1},8,["modelValue"])])])),_:1}),b(" 广告类型 "),F(a,{label:"广告类型:",prop:"channel_content"},{default:h((()=>[g("div",R,[F(o,{modelValue:v(ee).ruleForm.channel_content,"onUpdate:modelValue":l[14]||(l[14]=e=>v(ee).ruleForm.channel_content=e),label:1},{default:h((()=>[E])),_:1},8,["modelValue"]),F(o,{modelValue:v(ee).ruleForm.channel_content,"onUpdate:modelValue":l[15]||(l[15]=e=>v(ee).ruleForm.channel_content=e),label:2},{default:h((()=>[G])),_:1},8,["modelValue"])])])),_:1}),b(" Channel Type "),F(a,{label:"Channel Type:",prop:"channel_type"},{default:h((()=>[g("div",B,[F(o,{modelValue:v(ee).ruleForm.channel_type,"onUpdate:modelValue":l[16]||(l[16]=e=>v(ee).ruleForm.channel_type=e),label:1},{default:h((()=>[L])),_:1},8,["modelValue"]),F(o,{modelValue:v(ee).ruleForm.channel_type,"onUpdate:modelValue":l[17]||(l[17]=e=>v(ee).ruleForm.channel_type=e),label:2},{default:h((()=>[$])),_:1},8,["modelValue"]),F(o,{modelValue:v(ee).ruleForm.channel_type,"onUpdate:modelValue":l[18]||(l[18]=e=>v(ee).ruleForm.channel_type=e),label:3},{default:h((()=>[H])),_:1},8,["modelValue"])])])),_:1}),b(" Fenix Connected "),F(a,{label:"Fenix Connected:",prop:"fenix_connected"},{default:h((()=>[g("div",K,[F(d,{modelValue:v(ee).ruleForm.fenix_connected,"onUpdate:modelValue":l[19]||(l[19]=e=>v(ee).ruleForm.fenix_connected=e),"active-value":1,"inactive-value":2},null,8,["modelValue"])])])),_:1}),b(" Adv ID "),F(a,{label:"Adv ID:",prop:"adv_id"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.adv_id,"onUpdate:modelValue":l[20]||(l[20]=e=>v(ee).ruleForm.adv_id=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1}),b(" Group "),F(a,{label:"Group:",prop:"group"},{default:h((()=>[F(r,{modelValue:v(ee).ruleForm.group,"onUpdate:modelValue":l[21]||(l[21]=e=>v(ee).ruleForm.group=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model"]),b(" form "),b(" footer "),g("div",Q,[F(n,{type:"primary",onClick:le},{default:h((()=>[W])),_:1})]),b(" footer ")])}}});export{X as default};
