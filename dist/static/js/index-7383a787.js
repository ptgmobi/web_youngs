var e=Object.defineProperty,a=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,s=(a,i,t)=>i in a?e(a,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[i]=t;import{_ as l,q as o,o as n,c as d,A as m,s as r,z as p,e as u,f as b,y as c,N as f,O as h,x as g}from"./main-665d1af0.js";import{m as y}from"./vuex.esm-bundler-71b2fa9a.js";import{g as D}from"./power-ed69a2b7.js";import{g as w,a as V,s as _,b as C}from"./role-ba086b04.js";import{m as j}from"./message-6257d60b.js";import{m as k}from"./self-fa6f6ce9.js";const v={components:{},mixins:[k],data:()=>({options:{permissions:[]},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",permissions:[]},choiceData:{}}}),computed:((e,l)=>{for(var o in l||(l={}))i.call(l,o)&&s(e,o,l[o]);if(a)for(var o of a(l))t.call(l,o)&&s(e,o,l[o]);return e})({},y(["element"])),created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await D();this.options.permissions=e.permission},async getList(){const{data:e}=await w();this.data=e,this.list=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.busData.item.name="",this.busData.item.permissions=[],this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:a}=await V(this.busData.item.id);this.busData.item.name=a.role[0].name,this.busData.item.permissions=a.role_permission,this.dialogVisible=!0;const i=new Date;this.date=i.getTime()},handleDelete(e){},roleChangeChoice(e,a){this.busData.choiceData[e]=a},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,permission_id:this.busData.item.permissions},a=await _(e);a&&j(a),this.getList()}if("edit"===this.dialogType){const e={role_id:this.busData.item.id,permission_id:this.busData.item.permissions},a=await C(this.busData.item.id,e);a&&j(a)}this.dialogVisible=!1}}},T={class:"app-container"},E=b(" 新建 "),A=b(" 修改 "),O=b(" 删除 "),P={slot:"footer",class:"dialog-footer"},x=b(" 取 消 "),F=b(" 确 定 ");var R=l(v,[["render",function(e,a,i,t,s,l){const y=o("el-button"),D=o("el-table-column"),w=o("el-table"),V=o("el-input"),_=o("el-form-item"),C=o("el-option"),j=o("el-select"),k=o("el-form"),v=o("el-dialog");return n(),d("div",T,[e.judgePermissionElementFn("A-AR-ADD-V")?(n(),m(y,{key:0,type:"primary",onClick:l.handleCreate},{default:r((()=>[E])),_:1},8,["onClick"])):p("v-if",!0),u(w,{data:s.list,style:{width:"100%","margin-top":"30px"},border:""},{default:r((()=>[u(D,{align:"center",label:"ID"},{default:r((e=>[b(c(e.row.id),1)])),_:1}),u(D,{align:"center",label:"Name"},{default:r((e=>[b(c(e.row.name),1)])),_:1}),u(D,{align:"center",label:"Operations"},{default:r((a=>[e.judgePermissionElementFn("A-AR-EDIT-V")?(n(),m(y,{key:0,type:"primary",size:"small",onClick:e=>l.handleEdit(a)},{default:r((()=>[A])),_:2},1032,["onClick"])):p("v-if",!0),e.judgePermissionElementFn("A-AR-DEL-V")?(n(),m(y,{key:1,type:"danger",size:"small",onClick:e=>l.handleDelete(a)},{default:r((()=>[O])),_:2},1032,["onClick"])):p("v-if",!0)])),_:1})])),_:1},8,["data"]),u(v,{modelValue:s.dialogVisible,"onUpdate:modelValue":a[3]||(a[3]=e=>s.dialogVisible=e),title:"edit"===s.dialogType?"Edit Role":"New Role",width:"90%"},{default:r((()=>[u(k,{"label-width":"150px","label-position":"left"},{default:r((()=>[u(_,{label:"Name"},{default:r((()=>[u(V,{modelValue:s.busData.item.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.busData.item.name=e),placeholder:"",disabled:"edit"===s.dialogType},null,8,["modelValue","disabled"])])),_:1}),u(_,{label:"Permissions"},{default:r((()=>[u(j,{modelValue:s.busData.item.permissions,"onUpdate:modelValue":a[1]||(a[1]=e=>s.busData.item.permissions=e),filterable:"",multiple:"",clearable:"",class:"w100",placeholder:"支持多选"},{default:r((()=>[(n(!0),d(f,null,h(s.options.permissions,(e=>(n(),m(C,{key:e.id,label:e.type,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),g("div",P,[u(y,{onClick:a[2]||(a[2]=e=>s.dialogVisible=!1)},{default:r((()=>[x])),_:1}),u(y,{type:"primary",onClick:l.submitFn},{default:r((()=>[F])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{R as default};
