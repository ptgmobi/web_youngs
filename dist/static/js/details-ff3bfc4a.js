var e=Object.defineProperty,l=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(l,r,t)=>r in l?e(l,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[r]=t,a=(e,a)=>{for(var i in a||(a={}))r.call(a,i)&&o(e,i,a[i]);if(l)for(var i of l(a))t.call(a,i)&&o(e,i,a[i]);return e};import{d as i,a as d,r as u,e as m,w as s,I as n,a1 as c,M as p,m as f,s as _,n as b,z as g,c as v,p as F,v as h,q as y,O as V,P as k,b as w,A as x,x as A,L as j}from"./index-3d72bb36.js";import{f as O,g as D,h as U,i as q}from"./buzzsync-8759f0f4.js";import{m as N}from"./message-f0695268.js";const S={class:"content-con flex column"},M={class:"flex jc-start form-one jc-start radio-box"},P=w(" whole traffic "),E=w(" diversity in platform "),z={class:"flex jc-start form-one jc-start radio-box"},I=w(" whole preclick "),C=w(" diversity in platform "),R={class:"flex jc-start form-one jc-start radio-box"},J={class:"flex jc-start form-one jc-start radio-box"},T=w(" app download "),B=w(" 非app download "),G={class:"flex jc-start form-one jc-start radio-box"},L=w(" 代理 "),$=w(" API "),H=w(" 直客 "),K={class:"flex jc-start form-one jc-start radio-box"},Q={class:"w100 flex"},W=w(" Save "),X=i({setup(e){let{proxy:l}=j();const r=d(),t="此项必填";let o=u({type:[{value:1,label:"no creatives无素材"}]}),i=u({offer:{},index:null,cacheDevice:{}}),X=m(""),Y=m(0),Z=m([0,100]),ee=u({dialogVisibleDevice:!1,dialogVisibleSite:!1,search:{id:"",baseDeviceSelect:{},deviceData:{all:[],select:[],count:0}},type:"1",params:"",loading:!0,options:{channel:[],attribute_provider:["AppsFlyer","Branch","Adjust","Singular","AppMetrica"],time:[-1,...[...new Array(24)].map(((e,l)=>l))],platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],country:[],site_id:["0.2","0.4","0.6","1","2","4","8","24","72","168"],category:[],devices:[]},ruleForm:{type:"",id:"",offer_id:void 0,operation_type:"",channel:"",copy_offer:"",attribute_provider:"AppsFlyer",title:"",tracking_link:"",pid:"",pkg_name:"",conversion_flow:"",event_name:"",payout:void 0,platform:"",country:"",max_clk_num:void 0,site_clk_limit:void 0,site_install_limitation:void 0,start_hour:"-1",end_hour:"-1",device:[],cutoff_start:void 0,cutoff_end:void 0,diy_siteid:"",site_id:"",hour:void 0,clk_id:"",site_clk_id:"",note:"",campaign_id:""},rules:{channel:[{required:!0,message:t,trigger:["blur","change"]}],attribute_provider:[{required:!0,message:t,trigger:["blur","change"]}],title:[{required:!0,message:t,trigger:["blur","change"]}],tracking_link:[{required:!0,message:t,trigger:["blur","change"]},{validator:(e,l,r)=>{new RegExp("\\s+","g").test(l)?r(new Error("链接中有空格")):r(void 0),r(void 0)}},{validator:(e,l,r)=>{/^http/.test(l)?r(void 0):r(new Error("必须为有效链接")),r(void 0)}}],pkg_name:[{required:!0,message:t,trigger:["blur","change"]}],conversion_flow:[{required:!0,message:t,trigger:["blur","change"]}],event_name:[{required:!0,message:t,trigger:["blur","change"]},{validator:(e,l,r)=>{"1"===ee.ruleForm.conversion_flow?r(void 0):r(l?void 0:new Error(t))}}],payout:[{required:!0,message:t,trigger:["blur","change"]}],platform:[{required:!0,message:t,trigger:["blur","change"]}],country:[{required:!0,message:t,trigger:["blur","change"]}],max_clk_num:[{required:!0,message:t,trigger:["blur","change"]}],device:[{required:!0,validator:(e,l,r)=>{r(void 0)},trigger:["blur","change"]}],site_id:[{required:!0,validator:(e,l,r)=>{l?1===l||ee.ruleForm.hour?r(void 0):r(new Error("请选择具体数值")):r(new Error(t))},trigger:["blur","change"]}],clk_id:[{required:!0,message:t,trigger:["blur","change"]}],start_hour:[{required:!1,validator:(e,l,r)=>{""!==l&&(""===ee.ruleForm.end_hour?r(new Error(t)):r(void 0))},trigger:["blur","change"]}],end_hour:[{required:!1,validator:(e,l,r)=>{""!==l&&(""===ee.ruleForm.start_hour?r(new Error(t)):r(void 0))},trigger:["blur","change"]}],cutoff_start:[{required:!0,trigger:["blur","change"]}],cutoff_end:[{required:!0,trigger:["blur","change"]}]},siteData:[]});const le=()=>{re("ruleForm")},re=e=>{l.$refs[e].validate((e=>{if(!e)return!1;te()}))},te=async()=>{let e;ee.ruleForm;let l=a({},ee.ruleForm);l.clk_id=parseFloat(l.clk_id),l.conversion_flow=parseFloat(l.conversion_flow),l.cutoff_end=parseFloat(l.cutoff_end),l.cutoff_start=parseFloat(l.cutoff_start),l.end_hour=parseFloat(l.end_hour),l.start_hour=parseFloat(l.start_hour),l.hour=parseFloat(l.hour),l.max_clk_num=parseFloat(l.max_clk_num),l.payout=parseFloat(l.payout),l.platform=parseFloat(l.platform),l.site_clk_id=parseFloat(l.site_clk_id),l.site_clk_limit=parseFloat(l.site_clk_limit),l.site_id=parseFloat(l.site_id),l.site_install_limitation=parseFloat(l.site_install_limitation),l.diy_siteid=JSON.stringify(l.diy_siteid),l.device=JSON.stringify(l.device),"1"===ee.ruleForm.type&&(delete l.id,delete l.offer_id,e=await O(l)),"2"===ee.ruleForm.type&&(e=await D(l)),N(e)&&window.close()};s(Z,((e,l)=>{(e=>{ee.ruleForm.cutoff_start=e[0]/100,ee.ruleForm.cutoff_end=e[1]/100})(e)}),{immediate:!0});n((()=>{const e=Y.value,l=ee.ruleForm.cutoff_start,r=ee.ruleForm.cutoff_end;return{judge:((Number(r)-Number(l))*Number(e)).toFixed(0),all:Number(e).toFixed(0)}})),c((()=>{(async()=>{ee.ruleForm.pkg_name,ee.ruleForm.country,ee.ruleForm.platform})()}));const oe=async e=>{const l=await q(e),{data:r}=l;ee.ruleForm=((e,l)=>{let r={};return l.type,e.device&&(e.device=JSON.parse(e.device)),e.diy_siteid&&(e.diy_siteid=JSON.parse(e.diy_siteid)),"2"===l.type&&(r.id=e.id,r.offer_id=e.offer_id),r=a(a({},e),l),"1"===l.type&&(delete r.id,delete r.offer_id),r})(r,{type:ee.ruleForm.type,isCopy:!1}),i.offer=r};return n((()=>{const e=ee.ruleForm.tracking_link,l=ee.ruleForm.attribute_provider;let r="";if("AppsFlyer"===l){const l=/pid=([\s\S]*)_int/g,t=[...e.matchAll(l)];if(0!==t.length)return r=t[0][1],ee.ruleForm.pid=r,r}if("Adjust"===l){const l=/https:\/\/app.adjust.com\/([\s\S]*)\?/g,t=[...e.matchAll(l)];if(0!==t.length)return r=t[0][1],ee.ruleForm.pid=r,r}return ee.ruleForm.pid=r,r})),n((()=>{let e=0;if(i.cacheDevice,i.cacheDevice.hasOwnProperty("all")&&i.cacheDevice.hasOwnProperty("select")){let l=i.cacheDevice.all,r=i.cacheDevice.select;0!==l.length&&0!==r.length&&l.forEach((l=>{r.forEach((r=>{l.source===r.source&&l.label===r.label&&(e+=parseInt(l.device_count))}))})),ee.search.deviceData.count=e}return null!=e?e:ee.search.deviceData.count})),p((()=>{if((async()=>{const e=await U();if(e){const{data:l}=e;return ee.options.channel=Object.values(l.channel),ee.options.country=Object.values(l.country),ee.options.category=Object.values(l.category),"获取配置成功"}})(),X.value=r.currentRoute.value.name,X.value,"buzz-sync-create"===X.value&&(ee.ruleForm.operation_type="1",ee.ruleForm.type="1"),"buzz-sync-edit"===X.value){ee.ruleForm.operation_type="2",ee.ruleForm.type="2";const e=r.currentRoute.value.params.id;oe(e)}})),(e,l)=>{const r=f("el-input"),t=f("el-form-item"),a=f("el-radio"),i=f("el-checkbox"),d=f("el-checkbox-group"),u=f("el-switch"),m=f("el-form"),s=f("el-button");return _(),b("div",null,[g(" form "),v(m,{ref:"ruleForm",enctype:"multipart/form-data",rules:y(ee).rules,model:y(ee).ruleForm,"label-width":"240px","label-position":"right"},{default:F((()=>[h("div",S,[g(" AD Network Name "),v(t,{label:"AD Network Name:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[0]||(l[0]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1}),g(" AD Network Short Name "),v(t,{label:"AD Network Short Name:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[1]||(l[1]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1}),g(" AD Network Description "),v(t,{class:"mb-30",label:"AD Network Description:",prop:"tracking_link"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.tracking_link,"onUpdate:modelValue":l[2]||(l[2]=e=>y(ee).ruleForm.tracking_link=e),modelModifiers:{trim:!0},class:"form-one",type:"textarea",autosize:{minRows:8,maxRows:80},placeholder:""},null,8,["modelValue"])])),_:1}),g(" Percent Of Traffic "),v(t,{label:"Percent Of Traffic:",prop:"clk_id"},{default:F((()=>[h("div",M,[v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[3]||(l[3]=e=>y(ee).ruleForm.clk_id=e),label:1},{default:F((()=>[P])),_:1},8,["modelValue"]),v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[4]||(l[4]=e=>y(ee).ruleForm.clk_id=e),label:2},{default:F((()=>[E])),_:1},8,["modelValue"])])])),_:1}),g(" All "),v(t,{label:"All:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[5]||(l[5]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1}),g(" iOS "),v(t,{label:"iOS:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[6]||(l[6]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1}),g(" Android "),v(t,{label:"Android:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[7]||(l[7]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1}),g(" Percent Of Preclick "),v(t,{label:"Percent Of Preclick:",prop:"clk_id"},{default:F((()=>[h("div",z,[v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[8]||(l[8]=e=>y(ee).ruleForm.clk_id=e),label:1},{default:F((()=>[I])),_:1},8,["modelValue"]),v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[9]||(l[9]=e=>y(ee).ruleForm.clk_id=e),label:2},{default:F((()=>[C])),_:1},8,["modelValue"])])])),_:1}),g(" All "),v(t,{label:"All:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[10]||(l[10]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1}),g(" iOS "),v(t,{label:"iOS:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[11]||(l[11]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1}),g(" Android "),v(t,{label:"Android:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[12]||(l[12]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"number",placeholder:""},null,8,["modelValue"])])),_:1}),g(" type "),v(t,{label:"Type"},{default:F((()=>[h("div",R,[v(d,{modelValue:y(ee).ruleForm.type,"onUpdate:modelValue":l[13]||(l[13]=e=>y(ee).ruleForm.type=e)},{default:F((()=>[(_(!0),b(V,null,k(y(o).type,(e=>(_(),x(i,{key:e.value,label:e.value,disabled:e.require},{default:F((()=>[w(A(e.label),1)])),_:2},1032,["label","disabled"])))),128))])),_:1},8,["modelValue"])])])),_:1}),g(" 广告类型 "),v(t,{label:"广告类型:",prop:"clk_id"},{default:F((()=>[h("div",J,[v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[14]||(l[14]=e=>y(ee).ruleForm.clk_id=e),label:1},{default:F((()=>[T])),_:1},8,["modelValue"]),v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[15]||(l[15]=e=>y(ee).ruleForm.clk_id=e),label:2},{default:F((()=>[B])),_:1},8,["modelValue"])])])),_:1}),g(" Channel Type "),v(t,{label:"广告类型:",prop:"clk_id"},{default:F((()=>[h("div",G,[v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[16]||(l[16]=e=>y(ee).ruleForm.clk_id=e),label:1},{default:F((()=>[L])),_:1},8,["modelValue"]),v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[17]||(l[17]=e=>y(ee).ruleForm.clk_id=e),label:2},{default:F((()=>[$])),_:1},8,["modelValue"]),v(a,{modelValue:y(ee).ruleForm.clk_id,"onUpdate:modelValue":l[18]||(l[18]=e=>y(ee).ruleForm.clk_id=e),label:3},{default:F((()=>[H])),_:1},8,["modelValue"])])])),_:1}),g(" Fenix Connected "),v(t,{label:"Fenix Connected:",prop:"clk_id"},{default:F((()=>[h("div",K,[v(u,{modelValue:y(ee).ruleForm.status,"onUpdate:modelValue":l[19]||(l[19]=e=>y(ee).ruleForm.status=e),"active-value":1,"inactive-value":2},null,8,["modelValue"])])])),_:1}),g(" Adv ID "),v(t,{label:"Adv ID:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[20]||(l[20]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1}),g(" Group "),v(t,{label:"Adv ID:",prop:"title"},{default:F((()=>[v(r,{modelValue:y(ee).ruleForm.title,"onUpdate:modelValue":l[21]||(l[21]=e=>y(ee).ruleForm.title=e),modelModifiers:{trim:!0},class:"form-one",type:"text",placeholder:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model"]),g(" form "),g(" footer "),h("div",Q,[v(s,{type:"primary",onClick:le},{default:F((()=>[W])),_:1})]),g(" footer ")])}}});export{X as default};
