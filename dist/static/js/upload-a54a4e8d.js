import{e}from"./dsp-advertiser-133f6b15.js";import{E as t}from"./main-f5fc11c6.js";const i=e=>{let i=e.filter((e=>"rejected"===e.status)),n={};if(0!==i.length)n={status:!1,msg:i.map((e=>e.reason)).join(",")},t.error(n.msg);else{let t={};e.map((e=>{let i=e.value;for(const n in i)if(Object.prototype.hasOwnProperty.call(i,n)){const e=i[n];e&&(t[n]=e)}})),n={status:!0,msg:"success",data:t}}return n};var n={validate:async(e,t,n)=>{const{type_reg:o,size:r,limit:s,duration:a}=n;if("image"===t){let t={w:"",h:"",limit:e.size,type:e.type};const n=new Promise((function(t,i){let n=(window.URL||window.webkitURL).createObjectURL(e),o={},s=new Image;s.onload=function(){let e=s.width,n=s.height,a=r.find((t=>t.width===e&&t.height===n));o.w=e,o.h=n,a?t(o):i("图片尺寸错误")},s.src=n})),a=new Promise((function(i,n){let r=e.type,s=o.test(r);s?i(t):n("图片类型错误")})),l=new Promise((function(i,n){e.size<=s?i(t):n("图片大小错误")})),c=await Promise.allSettled([n,a,l]).then((e=>e));return new Promise(((e,t)=>{let n=i(c);n.status?e(n):t("error")}))}if("video"===t){let t={w:"",h:"",limit:e.size,type:e.type,duration:""};const n=new Promise((function(i,n){let o=URL.createObjectURL(e),s=document.createElement("video");s.onloadedmetadata=function(e){URL.revokeObjectURL(o);let l=s.duration,c=s.videoWidth,d=s.videoHeight;return r.find((e=>e.width===c&&e.height===d))?l<=a?(t.w=c,t.h=d,t.duration=l,i(t)):n("视频时长错误"):n("视频尺寸错误")},s.src=o,s.load()})),l=new Promise((function(i,n){let r=e.type;o.test(r)?i(t):n("视频类型错误")})),c=new Promise((function(i,n){e.size<=s?i(t):n("视频大小错误")})),d=await Promise.allSettled([n,l,c]).then((e=>e));return new Promise(((e,t)=>{let n=i(d);n.status?e(n):t("error")}))}},uploadHttpRequest:async t=>{const i=new FormData;i.append("logo_url",t.file),i.append("f",t.file),i.append("file_name",t.file.name);return await e(i)}};export{n as u};
