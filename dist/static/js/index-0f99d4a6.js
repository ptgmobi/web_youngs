import{_ as e,q as a,c as t,A as i,s as l,z as s,e as o,o as d,f as n,y as m,N as u,O as r,x as p}from"./main-0a777472.js";import{m as b}from"./vuex.esm-bundler-f200bff2.js";import{g as h}from"./role-fbefbe1a.js";import{g as c,a as f,s as g,b as D}from"./station-b6293122.js";import{m as y}from"./message-d6ce123e.js";import{m as V}from"./self-732f5551.js";const _={components:{},mixins:[V],data:()=>({options:{role:[],pid:[],base_url:""},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",pid:"",role:[],base_url:""},choiceData:{}}}),computed:{...b(["element"])},created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await h();this.options.role=e},async getList(){const{data:e}=await c();this.data=e,this.list=e,this.options.pid=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:a}=await f(this.busData.item.id);a.position,this.busData.item.id=a.position.id,this.busData.item.name=a.position.name,a.position.pid&&(this.busData.item.pid=a.position.pid.toString()),this.busData.item.role=a.position_role,this.dialogVisible=!0;const t=new Date;this.date=t.getTime()},handleDelete(e){},roleChangeChoice(e,a){this.busData.choiceData[e]=a},clearBusData(){this.busData={item:{id:"",name:"",pid:"",role:[]},choiceData:{}}},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,pid:this.busData.item.pid,role_id:this.busData.item.role},a=await g(e);a&&y(a),this.getList()}if("edit"===this.dialogType){const e={id:this.busData.item.id,name:this.busData.item.name,role_id:this.busData.item.role},a=await D(this.busData.item.id,e);a&&y(a)}this.clearBusData(),this.dialogVisible=!1}}},w={class:"app-container"},C={slot:"footer",class:"dialog-footer"};var k=e(_,[["render",function(e,b,h,c,f,g){const D=a("el-button"),y=a("el-table-column"),V=a("el-table"),_=a("el-input"),k=a("el-form-item"),v=a("el-option"),T=a("el-select"),j=a("el-form"),A=a("el-dialog");return d(),t("div",w,[e.judgePermissionElementFn("A-AS-ADD-V")?(d(),i(D,{key:0,type:"primary",onClick:g.handleCreate},{default:l((()=>[n(" 新建 ")])),_:1},8,["onClick"])):s("v-if",!0),o(V,{data:f.list,style:{width:"100%","margin-top":"30px"},border:""},{default:l((()=>[o(y,{align:"center",label:"ID"},{default:l((e=>[n(m(e.row.id),1)])),_:1}),o(y,{align:"center",label:"Name"},{default:l((e=>[n(m(e.row.name),1)])),_:1}),o(y,{align:"center",label:"Operations"},{default:l((a=>[e.judgePermissionElementFn("A-AS-EDIT-V")?(d(),i(D,{key:0,type:"primary",size:"small",onClick:e=>g.handleEdit(a)},{default:l((()=>[n(" 修改 ")])),_:2},1032,["onClick"])):s("v-if",!0),e.judgePermissionElementFn("A-AS-DEL-V")?(d(),i(D,{key:1,type:"danger",size:"small",onClick:e=>g.handleDelete(a)},{default:l((()=>[n(" 删除 ")])),_:2},1032,["onClick"])):s("v-if",!0)])),_:1})])),_:1},8,["data"]),o(A,{modelValue:f.dialogVisible,"onUpdate:modelValue":b[4]||(b[4]=e=>f.dialogVisible=e),title:"edit"===f.dialogType?"Edit Role":"New Role",width:"90%"},{default:l((()=>[o(j,{"label-width":"150px","label-position":"left"},{default:l((()=>[o(k,{label:"Name"},{default:l((()=>[o(_,{modelValue:f.busData.item.name,"onUpdate:modelValue":b[0]||(b[0]=e=>f.busData.item.name=e),disabled:"edit"===f.dialogType,placeholder:""},null,8,["modelValue","disabled"])])),_:1}),o(k,{label:"PID"},{default:l((()=>[o(T,{modelValue:f.busData.item.pid,"onUpdate:modelValue":b[1]||(b[1]=e=>f.busData.item.pid=e),disabled:"edit"===f.dialogType,filterable:"",class:"w100",placeholder:"请选择"},{default:l((()=>[(d(!0),t(u,null,r(f.options.pid,(e=>(d(),i(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),o(k,{label:"Role"},{default:l((()=>[o(T,{modelValue:f.busData.item.role,"onUpdate:modelValue":b[2]||(b[2]=e=>f.busData.item.role=e),filterable:"",multiple:"",class:"w100",placeholder:"支持多选"},{default:l((()=>[(d(!0),t(u,null,r(f.options.role,(e=>(d(),i(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),p("div",C,[o(D,{onClick:b[3]||(b[3]=e=>f.dialogVisible=!1)},{default:l((()=>[n(" 取 消 ")])),_:1}),o(D,{type:"primary",onClick:g.submitFn},{default:l((()=>[n(" 确 定 ")])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{k as default};
