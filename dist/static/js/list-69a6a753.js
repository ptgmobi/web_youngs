var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,s=(e,a)=>{for(var l in a||(a={}))o.call(a,l)&&n(e,l,a[l]);if(t)for(var l of t(a))r.call(a,l)&&n(e,l,a[l]);return e};import{d as i,r as u,w as d,L as c,q as p,o as b,c as f,e as m,s as v,v as h,a as _,h as w,a3 as y,b as g,M as V,a4 as D,x as C,z as k,U as O,V as U,K as x,N as P,O as j,A as S,y as A,f as E}from"./main-117ea954.js";import{g as I,h as N,i as Q,j as T,k as z,l as $,m as B,n as F,o as M}from"./fenix-c8181ed6.js";import{P as R}from"./index-30d9f33c.js";import{h as q}from"./moment-9bd84dc2.js";import{m as K}from"./message-5536b0e9.js";import{o as L,a as X}from"./new-format-cf95a59e.js";const Z=i({props:{busData:{require:!0,default:()=>({}),type:Object}},setup(e){const a=e,l=u({tableData:[{}]});return d((()=>a.busData.offer.offer_id),((e,a)=>{}),{immediate:!0}),c((()=>{a.busData,(async()=>{const e={offer_id:a.busData.offer.offer_id};l.tableData=[];const{data:t}=await I(e),o=t.sort(((e,a)=>{const l=Number(q(e.date,q.ISO_8601).format("X"));return Number(q(a.date,q.ISO_8601).format("X"))-l}));l.tableData=o})()})),(e,a)=>{const t=p("el-table-column"),o=p("el-table");return b(),f("div",null,[m(o,{data:h(l).tableData,style:{width:"100%"},border:""},{default:v((()=>[m(t,{fixed:"",prop:"date",label:"Date",align:"center"}),m(t,{fixed:"",prop:"record",label:"Record",align:"center"}),m(t,{fixed:"",prop:"email",label:"User",align:"center"})])),_:1},8,["data"])])}}}),J={class:"control-box w100 mb-10"},G={class:"mb-10"},H=E(" Offer Create "),W={class:"flex jc-start flex-wrap w100"},Y={class:"flex"},ee={class:"flex"},ae=E(" 查询 "),le={class:"body-box mt-10"},te={class:"flex"},oe={key:0},re=E(" . "),ne=E(" . "),se=E(" . "),ie={class:"flex"},ue={class:"w100 flex"},de=i({name:"fenix-offer-list"}),ce=i((pe=s({},de),a(pe,l({setup(e){_(),w(!0);let a=w(!1);w(!1);const l=u({searchData:{adv_status:void 0,status:void 0,cvr_status:void 0,platform:void 0,attribute_provider:"",pub_name:"",offer_id:"",adv_offer:"",pkg:"",title:"",channel:"",pid:"",country:"",channel_type:void 0},tableData:[],options:{status:[{value:"1",label:"开"},{value:"2",label:"关"}],platform:[{value:"1",label:"Android"},{value:"2",label:"iOS"}],attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],pub:[{id:0,pub_name:""}],channel_type:[{value:"1",label:"BUZZ"},{value:"2",label:"SDK"}],dailyCapCount:{},cvr:{}},pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});let t=u({});y(l,"tableData");const o=async()=>{const{data:e}=await $();l.options.pub=e},r=async()=>{const{data:e}=await B(),a={};for(const l in e)if(Object.prototype.hasOwnProperty.call(e,l)){const t=e[l].split("_"),o={click_w:t[0],installs:t[1],cvr_w:t[2]};a[l]=o}l.options.cvr=a},n=async()=>{const{data:e}=await F();l.options.dailyCapCount=e},i=async()=>{let e={page:l.pagination.listQuery.page,limit:l.pagination.listQuery.limit};const a=s({},l.searchData);for(const l in a)if(Object.prototype.hasOwnProperty.call(a,l)){const t=a[l];t&&(e[l]=t)}const t=await N(e);l.tableData=t.data.data,l.pagination.total=t.data.paging.count},d=()=>{i()},E=(e,a)=>{let t="";t=`${e.offer_id}_${a.slotid}`;const o=l.options.dailyCapCount[t];return o?`: ${o}`:""};return g((()=>{})),c((()=>{(async()=>{Promise.all([o(),n(),r()])})(),i(),window.onpopstate=()=>{}})),V((()=>{})),D((()=>{})),(e,o)=>{const r=p("el-button"),n=p("el-option"),s=p("el-select"),u=p("el-form-item"),c=p("el-input"),_=p("el-form"),w=p("el-table-column"),y=p("el-switch"),g=p("el-popconfirm"),V=p("el-table"),D=p("el-dialog");return b(),f("div",null,[C("div",J,[C("div",G,[k(' <router-link to="/fenix/offer/create">\n          <el-button type="primary">\n            Offer Create\n          </el-button>\n        </router-link> '),m(r,{type:"primary",onClick:o[0]||(o[0]=e=>{L("/fenix/offer/create")})},{default:v((()=>[H])),_:1})]),m(_,{modelValue:h(l).searchData,"onUpdate:modelValue":o[14]||(o[14]=e=>h(l).searchData=e),inline:!0,class:"flex jc-between w100 ai-end"},{default:v((()=>[C("div",W,[m(u,{label:""},{default:v((()=>[m(s,{modelValue:h(l).searchData.adv_status,"onUpdate:modelValue":o[1]||(o[1]=e=>h(l).searchData.adv_status=e),clearable:"",class:"search-con",placeholder:"Adv Status"},{default:v((()=>[(b(!0),f(P,null,j(h(l).options.status,(e=>(b(),S(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(s,{modelValue:h(l).searchData.status,"onUpdate:modelValue":o[2]||(o[2]=e=>h(l).searchData.status=e),clearable:"",class:"search-con",placeholder:"Status"},{default:v((()=>[(b(!0),f(P,null,j(h(l).options.status,(e=>(b(),S(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),k(' <el-form-item label="">\n            <el-select v-model="state.searchData.cvr_status" clearable class="search-con" placeholder="Cvr Status">\n              <el-option\n                v-for="item in state.options.status"\n                :key="item.value"\n                :label="item.label"\n                :value="item.value"\n              />\n            </el-select>\n          </el-form-item> '),m(u,{label:""},{default:v((()=>[m(s,{modelValue:h(l).searchData.platform,"onUpdate:modelValue":o[3]||(o[3]=e=>h(l).searchData.platform=e),clearable:"",class:"search-con",placeholder:"Platform"},{default:v((()=>[(b(!0),f(P,null,j(h(l).options.platform,(e=>(b(),S(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(s,{modelValue:h(l).searchData.attribute_provider,"onUpdate:modelValue":o[4]||(o[4]=e=>h(l).searchData.attribute_provider=e),clearable:"",class:"search-con",placeholder:"Attribute Provider"},{default:v((()=>[(b(!0),f(P,null,j(h(l).options.attribute_provider,(e=>(b(),S(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(s,{modelValue:h(l).searchData.pub_name,"onUpdate:modelValue":o[5]||(o[5]=e=>h(l).searchData.pub_name=e),clearable:"",class:"search-con",placeholder:"Pub Name"},{default:v((()=>[(b(!0),f(P,null,j(h(l).options.pub,(e=>{var a;return b(),S(n,{key:e.id,label:e.pub_name,value:null!=(a=e.pub_name)?a:e.id},null,8,["label","value"])})),128))])),_:1},8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(c,{modelValue:h(l).searchData.offer_id,"onUpdate:modelValue":o[6]||(o[6]=e=>h(l).searchData.offer_id=e),placeholder:"Offer ID",class:"search-con"},null,8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(c,{modelValue:h(l).searchData.adv_offer,"onUpdate:modelValue":o[7]||(o[7]=e=>h(l).searchData.adv_offer=e),placeholder:"Adv Offer",class:"search-con"},null,8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(c,{modelValue:h(l).searchData.pkg,"onUpdate:modelValue":o[8]||(o[8]=e=>h(l).searchData.pkg=e),placeholder:"Pachage Name",class:"search-con"},null,8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(c,{modelValue:h(l).searchData.title,"onUpdate:modelValue":o[9]||(o[9]=e=>h(l).searchData.title=e),placeholder:"Offer Title",class:"search-con"},null,8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(c,{modelValue:h(l).searchData.channel,"onUpdate:modelValue":o[10]||(o[10]=e=>h(l).searchData.channel=e),placeholder:"Channel",class:"search-con"},null,8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(c,{modelValue:h(l).searchData.country,"onUpdate:modelValue":o[11]||(o[11]=e=>h(l).searchData.country=e),placeholder:"Country",class:"search-con"},null,8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(c,{modelValue:h(l).searchData.pid,"onUpdate:modelValue":o[12]||(o[12]=e=>h(l).searchData.pid=e),placeholder:"Pid",class:"search-con"},null,8,["modelValue"])])),_:1}),m(u,{label:""},{default:v((()=>[m(s,{modelValue:h(l).searchData.channel_type,"onUpdate:modelValue":o[13]||(o[13]=e=>h(l).searchData.channel_type=e),clearable:"",class:"search-con",placeholder:"Channel Type"},{default:v((()=>[(b(!0),f(P,null,j(h(l).options.channel_type,(e=>(b(),S(n,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})]),C("div",Y,[m(u,{class:"mr-0",style:{"margin-right":"0px"}},{default:v((()=>[C("div",ee,[m(r,{type:"primary",onClick:d},{default:v((()=>[ae])),_:1}),k(' <el-button type="primary" @click="handleExportSearch">导出</el-button> ')])])),_:1})])])),_:1},8,["modelValue"]),k(' <el-input placeholder="请输入内容" v-model="searchData.data" class=\'search-input\'>\n        <el-button slot="append" icon="Search" @click=\'searchFun\'></el-button>\n      </el-input> ')]),k(" table "),C("div",le,[m(V,{data:h(l).tableData,class:"w100",height:"70vh",border:""},{default:v((()=>[m(w,{sortable:"",fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"60"}),m(w,{sortable:"",fixed:"",prop:"adv_offer",label:"Adv Offer",align:"center",width:"87"}),m(w,{sortable:"",fixed:"",prop:"channel",label:"Channel",align:"center",width:"42"}),m(w,{sortable:"",prop:"revenue",label:"Revenue",align:"center",width:"45"}),m(w,{sortable:"",prop:"pkg",label:"Package Name",align:"center",width:"100"}),m(w,{sortable:"",prop:"title",label:"Offer Title",align:"center",width:"90"}),m(w,{sortable:"",prop:"pid",label:"Pid",align:"center",width:"77"}),m(w,{sortable:"",prop:"country",label:"Country",align:"center",width:"40"}),m(w,{sortable:"",label:"Adv Status",align:"center",width:"47"},{default:v((e=>[C("div",null,[C("span",null,A(1===e.row.adv_status?"开":"关"),1)])])),_:1}),m(w,{sortable:"",prop:"offer_id",label:"Click*w",align:"center",width:"55"},{default:v((e=>{var a;return[C("div",null,[C("span",null,A(null==(a=h(l).options.cvr[e.row.offer_id])?void 0:a.click_w),1)])]})),_:1}),m(w,{sortable:"",prop:"offer_id",label:"Installs",align:"center",width:"50"},{default:v((e=>{var a;return[C("div",null,[C("span",null,A(null==(a=h(l).options.cvr[e.row.offer_id])?void 0:a.installs),1)])]})),_:1}),m(w,{sortable:"",prop:"offer_id",label:"Cvr*w",align:"center",width:"48"},{default:v((e=>{var a;return[C("div",null,[C("span",null,A(null==(a=h(l).options.cvr[e.row.offer_id])?void 0:a.cvr_w),1)])]})),_:1}),m(w,{sortable:"",prop:"daily_cap",label:"Daily Cap",align:"center",width:"48"},{default:v((e=>[C("div",null,[C("span",null,A(e.row.daily_cap),1)])])),_:1}),m(w,{sortable:"",label:"Target Cvr*w",align:"center",width:"150"},{default:v((e=>[C("div",te,[m(c,{modelValue:e.row.target_cvr,"onUpdate:modelValue":a=>e.row.target_cvr=a,placeholder:"Please input",class:"input-with-select mr-5"},null,8,["modelValue","onUpdate:modelValue"]),m(r,{class:"mr-5 scale-button",type:"default",icon:"Edit",circle:"",onClick:a=>(async({row:e})=>{let a={id:e.id,target_cvr:e.target_cvr};a=X(a);const l=await z(a);K(l)})(e)},null,8,["onClick"]),m(y,{modelValue:e.row.cvr_status,"onUpdate:modelValue":a=>e.row.cvr_status=a,class:"scale-button","active-value":1,"inactive-value":2,onChange:a=>(async({row:e})=>{let a={id:e.id,cvr_status:e.cvr_status};a=X(a);const l=await T(a);K(l)||(e.cvr_status=1===e.cvr_status?2:1)})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"])])])),_:1}),m(w,{sortable:"",label:"Traffic Data",align:"left",width:"200"},{default:v((e=>[e.row.traffic?(b(),f("div",oe,[(b(!0),f(P,null,j(JSON.parse(e.row.traffic),(a=>(b(),f("div",{key:a},[C("div",null,[C("span",null,A(1===a.pub_status?"开":"关"),1),re,C("span",null,A(a.pub),1),ne,C("span",null,A(a.payout),1),se,C("span",null,A(a.cap_daily),1),C("span",null,A(E(e.row,a)),1)])])))),128))])):k("v-if",!0)])),_:1}),m(w,{sortable:"",label:"Operation",align:"center",width:"130"},{default:v((e=>[k(' <router-link :to="getEditUrl(scope)">\n              <el-button\n                class="cp mr-5"\n                type="primary"\n                icon="Edit"\n                circle\n              ></el-button>\n            </router-link> '),m(r,{class:"cp mr-5",type:"primary",icon:"Edit",onClick:a=>(e=>{let a=(e=>`/fenix/offer/edit/${e.id}`)(e);L(a)})(e.row),circle:""},null,8,["onClick"]),m(y,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,class:"mr-5",onChange:a=>(async({row:e})=>{const a={id:e.id,status:e.status},l=await Q(a);K(l)||(e.status=1===e.status?2:1)})(e)},null,8,["modelValue","onUpdate:modelValue","onChange"]),m(g,{title:"删除后无法再生成该Offer ID，请谨慎操作！",onConfirm:a=>(async e=>{const{row:a}=e,t=await M(a.id);K(t)&&l.tableData.splice(e.$index,1)})(e)},{reference:v((()=>[m(r,{type:"danger",icon:"Delete",circle:""})])),_:2},1032,["onConfirm"])])),_:1}),m(w,{sortable:"",prop:"last_time",label:"Last Time",align:"center",width:"80"}),m(w,{sortable:"",label:"Platform",align:"center",width:"55"},{default:v((e=>[C("div",null,[C("span",null,A(1===e.row.platform?"Android":"iOS"),1)])])),_:1}),m(w,{sortable:"",prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),m(w,{sortable:"",label:"Record",align:"center",width:"52"},{default:v((({row:e})=>[m(r,{class:"scale-button",icon:"View",circle:"",onClick:l=>(e=>{t.offer=e,a.value=!0})(e)},null,8,["onClick"])])),_:1}),m(w,{sortable:"",label:"Comment",align:"center",width:"150"},{default:v((e=>[C("div",ie,[m(c,{modelValue:e.row.description,"onUpdate:modelValue":a=>e.row.description=a,placeholder:"Please input",class:"input-with-select mr-5"},null,8,["modelValue","onUpdate:modelValue"]),m(r,{class:"scale-button",type:"default",icon:"Edit",circle:""})])])),_:1})])),_:1},8,["data"])]),k(" 分页 "),C("div",ue,[O(m(h(R),{page:h(l).pagination.listQuery.page,"onUpdate:page":o[15]||(o[15]=e=>h(l).pagination.listQuery.page=e),limit:h(l).pagination.listQuery.limit,"onUpdate:limit":o[16]||(o[16]=e=>h(l).pagination.listQuery.limit=e),total:h(l).pagination.total,"page-sizes":h(l).pagination.pageSizes,onPagination:i},null,8,["page","limit","total","page-sizes"]),[[U,h(l).pagination.total]])]),k(" record "),m(D,{modelValue:h(a),"onUpdate:modelValue":o[18]||(o[18]=e=>x(a)?a.value=e:a=e),title:"日志",width:"80%","destroy-on-close":""},{default:v((()=>[m(Z,{modelValue:h(a),"onUpdate:modelValue":o[17]||(o[17]=e=>x(a)?a.value=e:a=e),"bus-data":h(t)},null,8,["modelValue","bus-data"])])),_:1},8,["modelValue"])])}}}))));var pe;export{ce as default};
