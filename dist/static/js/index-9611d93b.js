var e=Object.defineProperty,a=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,l=(a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;import{_ as s,m as o,s as d,n,A as m,p as r,z as u,c as p,b,x as c,O as h,P as f,v as g}from"./index-652e212f.js";import{m as D}from"./vuex.esm-bundler-27f109e3.js";import{g as y}from"./role-3ac8dd35.js";import{g as V,a as _,s as w,b as v}from"./station-4d5daac5.js";import{m as C}from"./message-ffb9da26.js";import{m as k}from"./self-82ba5dc9.js";const j={components:{},mixins:[k],data:()=>({options:{role:[],pid:[],base_url:""},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",pid:"",role:[],base_url:""},choiceData:{}}}),computed:((e,s)=>{for(var o in s||(s={}))t.call(s,o)&&l(e,o,s[o]);if(a)for(var o of a(s))i.call(s,o)&&l(e,o,s[o]);return e})({},D(["element"])),created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await y();this.options.role=e},async getList(){const{data:e}=await V();this.data=e,this.list=e,this.options.pid=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:a}=await _(this.busData.item.id);a.position,this.busData.item.id=a.position.id,this.busData.item.name=a.position.name,a.position.pid&&(this.busData.item.pid=a.position.pid.toString()),this.busData.item.role=a.position_role,this.dialogVisible=!0;const t=new Date;this.date=t.getTime()},handleDelete(e){},roleChangeChoice(e,a){this.busData.choiceData[e]=a},clearBusData(){this.busData={item:{id:"",name:"",pid:"",role:[]},choiceData:{}}},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,pid:this.busData.item.pid,role_id:this.busData.item.role},a=await w(e);a&&C(a),this.getList()}if("edit"===this.dialogType){const e={id:this.busData.item.id,name:this.busData.item.name,role_id:this.busData.item.role},a=await v(this.busData.item.id,e);a&&C(a)}this.clearBusData(),this.dialogVisible=!1}}},T={class:"app-container"},E=b(" 新建 "),A=b(" 修改 "),O=b(" 删除 "),P={slot:"footer",class:"dialog-footer"},x=b(" 取 消 "),F=b(" 确 定 ");var S=s(j,[["render",function(e,a,t,i,l,s){const D=o("el-button"),y=o("el-table-column"),V=o("el-table"),_=o("el-input"),w=o("el-form-item"),v=o("el-option"),C=o("el-select"),k=o("el-form"),j=o("el-dialog");return d(),n("div",T,[e.judgePermissionElementFn("A-AS-ADD-V")?(d(),m(D,{key:0,type:"primary",onClick:s.handleCreate},{default:r((()=>[E])),_:1},8,["onClick"])):u("v-if",!0),p(V,{data:l.list,style:{width:"100%","margin-top":"30px"},border:""},{default:r((()=>[p(y,{align:"center",label:"ID"},{default:r((e=>[b(c(e.row.id),1)])),_:1}),p(y,{align:"center",label:"Name"},{default:r((e=>[b(c(e.row.name),1)])),_:1}),p(y,{align:"center",label:"Operations"},{default:r((a=>[e.judgePermissionElementFn("A-AS-EDIT-V")?(d(),m(D,{key:0,type:"primary",size:"small",onClick:e=>s.handleEdit(a)},{default:r((()=>[A])),_:2},1032,["onClick"])):u("v-if",!0),e.judgePermissionElementFn("A-AS-DEL-V")?(d(),m(D,{key:1,type:"danger",size:"small",onClick:e=>s.handleDelete(a)},{default:r((()=>[O])),_:2},1032,["onClick"])):u("v-if",!0)])),_:1})])),_:1},8,["data"]),p(j,{modelValue:l.dialogVisible,"onUpdate:modelValue":a[4]||(a[4]=e=>l.dialogVisible=e),title:"edit"===l.dialogType?"Edit Role":"New Role",width:"90%"},{default:r((()=>[p(k,{"label-width":"150px","label-position":"left"},{default:r((()=>[p(w,{label:"Name"},{default:r((()=>[p(_,{modelValue:l.busData.item.name,"onUpdate:modelValue":a[0]||(a[0]=e=>l.busData.item.name=e),disabled:"edit"===l.dialogType,placeholder:""},null,8,["modelValue","disabled"])])),_:1}),p(w,{label:"PID"},{default:r((()=>[p(C,{modelValue:l.busData.item.pid,"onUpdate:modelValue":a[1]||(a[1]=e=>l.busData.item.pid=e),disabled:"edit"===l.dialogType,filterable:"",class:"w100",placeholder:"请选择"},{default:r((()=>[(d(!0),n(h,null,f(l.options.pid,(e=>(d(),m(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","disabled"])])),_:1}),p(w,{label:"Role"},{default:r((()=>[p(C,{modelValue:l.busData.item.role,"onUpdate:modelValue":a[2]||(a[2]=e=>l.busData.item.role=e),filterable:"",multiple:"",class:"w100",placeholder:"支持多选"},{default:r((()=>[(d(!0),n(h,null,f(l.options.role,(e=>(d(),m(v,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),g("div",P,[p(D,{onClick:a[3]||(a[3]=e=>l.dialogVisible=!1)},{default:r((()=>[x])),_:1}),p(D,{type:"primary",onClick:s.submitFn},{default:r((()=>[F])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{S as default};
