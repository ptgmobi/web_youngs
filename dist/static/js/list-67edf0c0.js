var e=Object.defineProperty,a=Object.defineProperties,t=Object.getOwnPropertyDescriptors,i=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,r=(a,t,i)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[t]=i;import{d as o,Z as s,r as c,L as p,q as d,$ as m,o as g,c as u,x as f,e as b,s as v,z as y,U as w,v as h,A as x,V as j,f as _,E as D}from"./main-f5fc11c6.js";import{P as O}from"./index-25212d29.js";import{A as P,a as Q}from"./tool-ca0fdbd7.js";import{m as k}from"./message-63eca02f.js";import{_ as z}from"./lodash-d099a0b1.js";import{u as C}from"./useUtils-e29f5423.js";const F={class:"controlBox w100 flex jc-between ai-start"},U={class:"mb-10"},S=_("新建广告主"),q={class:"flex jc-around"},A={class:"w100 flex"},E=o({name:"dsp-advsetting-list"}),I=o(($=((e,a)=>{for(var t in a||(a={}))l.call(a,t)&&r(e,t,a[t]);if(i)for(var t of i(a))n.call(a,t)&&r(e,t,a[t]);return e})({},E),a($,t({setup(e){const{goNewUrl:a,openAlert:t}=C(),i=s({name:""});let l=c({dialogVisible:!1,cache:{item:{},device:{}},searchForm:i.value,useData:i.value,loading:!0,options:{},list:[],pagination:{pageSizes:["50","100","500","1000"],total:1,listQuery:{page:1,limit:50,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});const n=()=>{a({url:"/tool/advsetting/create",query:{type:"create"}})},r=async()=>{l.loading=!0;let e={page:l.pagination.listQuery.page,limit:l.pagination.listQuery.limit};l.useData.name&&(e.name=l.useData.name);const a=await P(e),{data:t}=a;l.list=t,(e=>{100!==e.reduce(((e,a)=>e+a.flow_rate),0)&&D({message:"温馨提示：所有广告主的强制流量占比之和必须等于100%，否则会造成系统错误或流量浪费。",type:"warning"})})(t),l.pagination.total=Number(t.count),l.loading=!1};return p((()=>{l.useData=z.cloneDeep(l.searchForm),r()})),(e,t)=>{const i=d("el-button"),o=d("el-table-column"),s=d("el-table"),c=m("loading");return g(),u("div",null,[f("div",F,[f("div",U,[b(i,{type:"primary",onClick:n},{default:v((()=>[S])),_:1})]),y(' <el-form\n        v-model="data.searchForm"\n        :inline="true"\n        class="flex jc-between ai-end"\n      >\n        <div class="flex jc-start flex-wrap w100">\n          <el-form-item label="">\n            <el-input\n              v-model="data.searchForm.name"\n              placeholder="请输入广告主名称"\n              class="search-con"\n              style="min-width: 120px"\n            />\n          </el-form-item>\n        </div>\n        <div class="flex">\n          <el-form-item\n            class="mr-0"\n            style="margin-right: 0px"\n          >\n            <div class="flex">\n              <el-button\n                type="primary"\n                @click="searchFn"\n              >\n                查询\n              </el-button>\n            </div>\n          </el-form-item>\n        </div>\n      </el-form> ')]),y(" table "),w((g(),x(s,{center:"",data:h(l).list,class:"w100","min-height":"70vh",border:""},{default:v((()=>[b(o,{fixed:"",prop:"id",label:"ID",align:"center"}),b(o,{fixed:"",prop:"ad_id",label:"广告主ID",align:"center"}),b(o,{fixed:"",prop:"ad_name",label:"广告主名称",align:"center"}),b(o,{prop:"desc",label:"描述",align:"center"}),b(o,{prop:"flow_rate",label:"强制流量占比%",width:"120",align:"center"}),b(o,{prop:"create_email",label:"创建人",align:"center"}),b(o,{prop:"update_email",label:"更新人",align:"center"}),b(o,{prop:"create_time",label:"创建时间",sortable:"",align:"center"}),b(o,{prop:"update_time",label:"更新时间",sortable:"",align:"center"}),b(o,{width:"100",label:"操作",align:"center"},{default:v((e=>[f("div",q,[b(i,{class:"cp mr-10",type:"primary",icon:"Edit",circle:"",onClick:t=>(({row:e})=>{const{id:t}=e;a({url:`/tool/advsetting/edit/${t}`,query:{type:"edit"}})})(e)},null,8,["onClick"]),b(i,{class:"cp mr-10",type:"danger",icon:"Delete",circle:"",onClick:a=>(async({row:e,$index:a})=>{const{id:t}=e,i=await Q(t);k(i)&&l.list.splice(a,1)})(e)},null,8,["onClick"]),y(' <el-switch\n              v-model="scope.row.status"\n              :active-value="1"\n              :inactive-value="2"\n              @change="changeStatus(scope.row)"\n            /> ')])])),_:1})])),_:1},8,["data"])),[[c,h(l).loading]]),y(" 分页 "),f("div",A,[w(b(h(O),{page:h(l).pagination.listQuery.page,"onUpdate:page":t[0]||(t[0]=e=>h(l).pagination.listQuery.page=e),limit:h(l).pagination.listQuery.limit,"onUpdate:limit":t[1]||(t[1]=e=>h(l).pagination.listQuery.limit=e),total:h(l).pagination.total,"page-sizes":h(l).pagination.pageSizes,onPagination:r},null,8,["page","limit","total","page-sizes"]),[[j,h(l).pagination.total]])])])}}}))));var $;export{I as default};
