import{_ as e,m as a,s as i,n as t,A as s,p as l,z as o,c as d,b as n,x as m,O as r,P as u,v as p}from"./index-b160a4d6.js";import{m as b}from"./vuex.esm-bundler-4d56da27.js";import{g as c}from"./power-03161cb8.js";import{g as h,a as f,s as g,b as D}from"./role-dd0ab8c0.js";import{m as y}from"./message-6c553f21.js";import{m as V}from"./self-680a49e8.js";const _={components:{},mixins:[V],data:()=>({options:{permissions:[]},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",permissions:[]},choiceData:{}}}),computed:{...b(["element"])},created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:e}=await c();this.options.permissions=e.permission},async getList(){const{data:e}=await h();this.data=e,this.list=e},handleCreate(){this.dialogType="new",this.busData.item.type="",this.busData.item.name="",this.busData.item.permissions=[],this.dialogVisible=!0;const e=new Date;this.date=e.getTime()},async handleEdit(e){this.dialogType="edit",this.busData.item.id=e.row.id;const{data:a}=await f(this.busData.item.id);this.busData.item.name=a.role[0].name,this.busData.item.permissions=a.role_permission,this.dialogVisible=!0;const i=new Date;this.date=i.getTime()},handleDelete(e){},roleChangeChoice(e,a){this.busData.choiceData[e]=a},async submitFn(){if("new"===this.dialogType){const e={name:this.busData.item.name,permission_id:this.busData.item.permissions},a=await g(e);a&&y(a),this.getList()}if("edit"===this.dialogType){const e={role_id:this.busData.item.id,permission_id:this.busData.item.permissions},a=await D(this.busData.item.id,e);a&&y(a)}this.dialogVisible=!1}}},w={class:"app-container"},C=n(" 新建 "),k=n(" 修改 "),v=n(" 删除 "),T={slot:"footer",class:"dialog-footer"},j=n(" 取 消 "),A=n(" 确 定 ");var E=e(_,[["render",function(e,b,c,h,f,g){const D=a("el-button"),y=a("el-table-column"),V=a("el-table"),_=a("el-input"),E=a("el-form-item"),x=a("el-option"),F=a("el-select"),P=a("el-form"),R=a("el-dialog");return i(),t("div",w,[e.judgePermissionElementFn("A-AR-ADD-V")?(i(),s(D,{key:0,type:"primary",onClick:g.handleCreate},{default:l((()=>[C])),_:1},8,["onClick"])):o("v-if",!0),d(V,{data:f.list,style:{width:"100%","margin-top":"30px"},border:""},{default:l((()=>[d(y,{align:"center",label:"ID"},{default:l((e=>[n(m(e.row.id),1)])),_:1}),d(y,{align:"center",label:"Name"},{default:l((e=>[n(m(e.row.name),1)])),_:1}),d(y,{align:"center",label:"Operations"},{default:l((a=>[e.judgePermissionElementFn("A-AR-EDIT-V")?(i(),s(D,{key:0,type:"primary",size:"small",onClick:e=>g.handleEdit(a)},{default:l((()=>[k])),_:2},1032,["onClick"])):o("v-if",!0),e.judgePermissionElementFn("A-AR-DEL-V")?(i(),s(D,{key:1,type:"danger",size:"small",onClick:e=>g.handleDelete(a)},{default:l((()=>[v])),_:2},1032,["onClick"])):o("v-if",!0)])),_:1})])),_:1},8,["data"]),d(R,{modelValue:f.dialogVisible,"onUpdate:modelValue":b[3]||(b[3]=e=>f.dialogVisible=e),title:"edit"===f.dialogType?"Edit Role":"New Role",width:"90%"},{default:l((()=>[d(P,{"label-width":"150px","label-position":"left"},{default:l((()=>[d(E,{label:"Name"},{default:l((()=>[d(_,{modelValue:f.busData.item.name,"onUpdate:modelValue":b[0]||(b[0]=e=>f.busData.item.name=e),placeholder:"",disabled:"edit"===f.dialogType},null,8,["modelValue","disabled"])])),_:1}),d(E,{label:"Permissions"},{default:l((()=>[d(F,{modelValue:f.busData.item.permissions,"onUpdate:modelValue":b[1]||(b[1]=e=>f.busData.item.permissions=e),filterable:"",multiple:"",clearable:"",class:"w100",placeholder:"支持多选"},{default:l((()=>[(i(!0),t(r,null,u(f.options.permissions,(e=>(i(),s(x,{key:e.id,label:e.type,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),p("div",T,[d(D,{onClick:b[2]||(b[2]=e=>f.dialogVisible=!1)},{default:l((()=>[j])),_:1}),d(D,{type:"primary",onClick:g.submitFn},{default:l((()=>[A])),_:1},8,["onClick"])])])),_:1},8,["modelValue","title"])])}]]);export{E as default};
