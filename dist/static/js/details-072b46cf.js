var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,t=(e,t)=>{for(var i in t||(t={}))a.call(t,i)&&r(e,i,t[i]);if(l)for(var i of l(t))o.call(t,i)&&r(e,i,t[i]);return e};import{_ as i,d as m,r as d,h as s,I as u,b as n,L as p,q as c,o as f,c as _,z as b,e as v,s as g,v as y,x as V,K as F,P as h,N as k,O as x,A as U,f as j,y as w,g as C}from"./main-f5fc11c6.js";import{u as O,s as P}from"./useUtils-e29f5423.js";import{c as D,d as L,e as M}from"./dsp-adcontrol-f9a35fbd.js";import{A as q}from"./dsp-campaign-14e24a60.js";import{m as A}from"./message-63eca02f.js";import{_ as I}from"./index-5d1349db.js";import{d as z,e as E}from"./new-format-35937e70.js";import{s as N}from"./validate-31aaa08c.js";import{_ as S}from"./lodash-d099a0b1.js";import $ from"./list-b3fec870.js";import"./index-25212d29.js";import"./clipboard-polyfill.text.esm-fc4f7791.js";const H={class:"content-con from-one flex column"},K={class:"content-con from-one flex column"},R=j("选择创意"),B=j("选择DPA模板"),G={class:"content-con from-one flex column"},J={class:"w100 flex"},Q=j(" 确认 "),T=j(" 取消 "),W={class:"w100 flex"},X=j("保存");var Y=i(m({setup(e){const{adv_type:l,ind_cla:a,third_party:o,return_mode:r,time_zone:i}=P,{getRouterData:m,getCommonCountryList:Y,goNewUrl:Z}=O();let{proxy:ee}=C();const le="此项必填";let ae=d({campaignList:[],campaignOne:{},dpa:{}}),oe=s("create"),re=s(!1);s(!1);const te={id:void 0,ad_id:"",name:"",ad_group_id:"",descs:"",category_id:void 0,type:void 0,originality_id:void 0,deeplink:"",is_h5:1,mobilelink:"",click_url:"",impression_url:"",campaign:[],dpa:[],status:1,is_del:0},ie=(e,l,a)=>{const{max:o}=e;N(l,o)?a(void 0):a(new Error("值的长度不能大于${}"))},me=d({ruleForm:te,rules:{adv_series_name:[{required:!0,message:le,trigger:["blur","change"]},{validator:ie,max:100,trigger:["blur","change"]}],adv_name:[{required:!0,message:le,trigger:["blur","change"]}],descs:[{validator:ie,max:200,trigger:["blur","change"]}],adv_series_type:[{required:!0,message:le,trigger:["blur","change"]}],adv_series_budget:[{required:!0,message:le,trigger:["blur","change"]}]},options:{adv_type:l,adv_series_type:[{value:1,label:"动态商品促销"},{value:2,label:"固定链接推广"}],adv_name:[],ad_num:[{value:"1",label:"1个"},{value:"2-10",label:"2-10个"}],campaign:[],dpa:[],ad_group:[],category:[],type:[]}}),de=()=>{ee.$refs.ruleForm.validate((e=>{if(!e)return!1;ue()}))},se=["id","adv_id","adv_series_type","adv_series_budget"],ue=async()=>{let e=h(me.ruleForm);if(e=z(e),e=E(e,se),"create"===oe.value){delete e.id;const l=await D(e);A(l)&&ne()}if("edit"===oe.value){const l=await L(e);A(l)&&ne()}},ne=()=>{Z({url:"/adcontrol/adseries/list"})},pe=()=>{re.value=!0},ce=e=>{ae.CampaignList=e},fe=e=>{ae.CampaignOne=e},_e=()=>{"create"===oe.value&&(ae.CampaignList,me.ruleForm.campaign=ae.CampaignList.map((e=>e.id))),"edit"===oe.value&&(ae.CampaignOne,me.ruleForm.campaign=ae.CampaignOne),re.value=!1},be=()=>{var e,l;let{query:a,params:o}=m();if(oe.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"","create"===oe.value&&(me.ruleForm=S.cloneDeep(te)),"edit"===oe.value){const{id:e}=o;(async e=>{const l=await M(e),{data:a}=l;me.ruleForm=t(t({},me.ruleForm),a),me.ruleForm})(e)}},ve=u((()=>me.ruleForm.campaign)),ge=u((()=>me.ruleForm.campaign));return n((()=>{(async()=>{const e={limit:1e4,page:1};await Promise.all([q(e),q(e)]).then((e=>{let l=e[0].data.data;me.options.campaign=l.map((e=>(e.value=e.id,e.label=e.name,e))),me.options.campaign,e[1].data.data,me.options.dpa=l.map((e=>(e.value=e.id,e.label=e.name,e)))}))})()})),p((()=>{be()})),(e,l)=>{const a=c("el-input"),o=c("el-form-item"),r=c("el-option"),t=c("el-select"),i=c("el-radio"),m=c("el-radio-group"),d=c("el-button"),s=c("el-checkbox"),u=c("el-form"),n=c("el-dialog");return f(),_("div",null,[b(" form "),v(u,{ref:"ruleForm",enctype:"multipart/form-data",rules:y(me).rules,model:y(me).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===y(oe)&&2===y(me).ruleForm.is_del},{default:g((()=>[v(y(I),{title:"基础信息"}),V("div",H,[v(o,{class:"self-el-form-item",label:"广告名称:",prop:"name"},{default:g((()=>[v(a,{modelValue:y(me).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>y(me).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),v(o,{class:"self-el-form-item",label:"所属广告组:",prop:"adv_name"},{default:g((()=>[v(t,{modelValue:y(me).ruleForm.ad_group_id,"onUpdate:modelValue":l[1]||(l[1]=e=>y(me).ruleForm.ad_group_id=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:g((()=>[(f(!0),_(k,null,x(y(me).options.ad_group,(e=>(f(),U(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(o,{class:"self-el-form-item",label:"描述:",prop:"descs"},{default:g((()=>[v(a,{modelValue:y(me).ruleForm.descs,"onUpdate:modelValue":l[2]||(l[2]=e=>y(me).ruleForm.descs=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),v(y(I),{title:"广告内容"}),V("div",K,[v(o,{class:"self-el-form-item",label:"内容分类:",prop:"category_id"},{default:g((()=>[v(t,{modelValue:y(me).ruleForm.category_id,"onUpdate:modelValue":l[3]||(l[3]=e=>y(me).ruleForm.category_id=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:g((()=>[(f(!0),_(k,null,x(y(me).options.category,(e=>(f(),U(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),v(o,{class:"self-el-form-item",label:"广告样式:",prop:"type"},{default:g((()=>[v(t,{modelValue:y(me).ruleForm.type,"onUpdate:modelValue":l[4]||(l[4]=e=>y(me).ruleForm.type=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:g((()=>[(f(!0),_(k,null,x(y(me).options.type,(e=>(f(),U(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),"create"===y(oe)?(f(),U(o,{key:0,class:"self-el-form-item",label:"广告数量:",prop:"marbet_target"},{default:g((()=>[v(m,{class:"form-one",modelValue:y(me).ruleForm.ad_num,"onUpdate:modelValue":l[5]||(l[5]=e=>y(me).ruleForm.ad_num=e)},{default:g((()=>[(f(!0),_(k,null,x(y(me).options.ad_num,(e=>(f(),U(i,{disabled:"edit"===y(oe),label:e.value},{default:g((()=>[j(w(e.label),1)])),_:2},1032,["disabled","label"])))),256))])),_:1},8,["modelValue"])])),_:1})):b("v-if",!0),b(" 选择创意 start "),v(o,{class:"self-el-form-item",label:"选择创意:",prop:"campaign"},{default:g((()=>[V("div",null,[V("div",null,[v(d,{type:"primary",onClick:pe},{default:g((()=>[R])),_:1})]),V("div",null,[v(t,{modelValue:y(me).ruleForm.campaign,"onUpdate:modelValue":l[6]||(l[6]=e=>y(me).ruleForm.campaign=e),filterable:"",placeholder:"请选择",class:"form-one mt-10",multiple:""},{default:g((()=>[(f(!0),_(k,null,x(y(me).options.campaign,(e=>(f(),U(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1}),b(" 选择创意 end "),b(" 选择DPA模板 start "),v(o,{class:"self-el-form-item",label:"选择DPA模板:",prop:"campaign"},{default:g((()=>[V("div",null,[V("div",null,[v(d,{type:"primary"},{default:g((()=>[B])),_:1})]),V("div",null,[v(t,{modelValue:y(me).ruleForm.dpa,"onUpdate:modelValue":l[7]||(l[7]=e=>y(me).ruleForm.dpa=e),filterable:"",placeholder:"请选择",class:"form-one mt-10",multiple:""},{default:g((()=>[(f(!0),_(k,null,x(y(me).options.dpa,(e=>(f(),U(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1}),b(" 选择DPA模板 end ")]),v(y(I),{title:"广告内容"}),V("div",G,[v(o,{class:"self-el-form-item",label:"Deeplink:",prop:"deeplink"},{default:g((()=>[v(a,{modelValue:y(me).ruleForm.deeplink,"onUpdate:modelValue":l[8]||(l[8]=e=>y(me).ruleForm.deeplink=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),v(o,{class:"self-el-form-item",label:"落地页跳转方式:",prop:"marbet_target"},{default:g((()=>[v(s,{modelValue:y(me).ruleForm.is_h5,"onUpdate:modelValue":l[9]||(l[9]=e=>y(me).ruleForm.is_h5=e),"true-label":"1","false-label":"2",label:"通过H5中间页跳转Deeplink"},null,8,["modelValue"])])),_:1}),v(o,{class:"self-el-form-item",label:"Mobilelink:",prop:"mobilelink"},{default:g((()=>[v(a,{modelValue:y(me).ruleForm.mobilelink,"onUpdate:modelValue":l[10]||(l[10]=e=>y(me).ruleForm.mobilelink=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),v(o,{class:"self-el-form-item",label:"点击监测链接:",prop:"click_url"},{default:g((()=>[v(a,{modelValue:y(me).ruleForm.click_url,"onUpdate:modelValue":l[11]||(l[11]=e=>y(me).ruleForm.click_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),v(o,{class:"self-el-form-item",label:"曝光监测链接:",prop:"impression_url"},{default:g((()=>[v(a,{modelValue:y(me).ruleForm.impression_url,"onUpdate:modelValue":l[12]||(l[12]=e=>y(me).ruleForm.impression_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),b(" form "),b(" footer "),V("div",J,[v(d,{type:"primary",onClick:de},{default:g((()=>[Q])),_:1}),v(d,{type:"primary",onClick:ne},{default:g((()=>[T])),_:1}),b(" 选择创意pop "),v(n,{modelValue:y(re),"onUpdate:modelValue":l[13]||(l[13]=e=>F(re)?re.value=e:re=e),title:"创意列表",width:"90%"},{default:g((()=>[v($,{class:"mb-10","paga-type":"show","choice-list":y(ve),"choice-one":y(ge),"choice-type":"create"===y(oe)?2:1,onUpdateList:ce,onUpdateOne:fe},null,8,["choice-list","choice-one","choice-type"]),V("div",W,[v(d,{class:"cp mr-10",type:"primary",onClick:_e},{default:g((()=>[X])),_:1})])])),_:1},8,["modelValue"])])])}}}),[["__scopeId","data-v-5175acd1"]]);export{Y as default};
