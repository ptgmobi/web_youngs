var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,l=(t,r,s)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[r]=s;import{k as n}from"./index-9f72a6d4.js";import{d as u,y as c,w as i,B as d,r as p,o as b,i as f,s as m,v as g,f as h,h as j,x as w,t as O}from"./vendor-29be9345.js";import{t as v}from"./format-bcf1fb2b.js";function _(e){return n({url:"/buzz",data:e,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function z(e){return n({url:"/buzz/edit-offer-max-clk",data:e,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function A(e){return n({url:"/buzz/status",data:e,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function y(e){return n({url:"/buzz",data:e,method:"post",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function E(e){return n({url:"/buzz",data:e,method:"put",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function P(e){return n({url:`/buzz/view/${e}`,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function x(){return n({url:"/buzz/edit-config",method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function C(e){return n({url:"/buzz/get-device-num",data:e,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}const L={class:"full"},k={class:"w100 flex mt-20"},M=m("span",null,"选中合计：",-1),S=["textContent"],V=u({props:{json:{require:!0,default:()=>({}),type:Object}},emits:["kk","up"],setup(e,{emit:n}){const u=e;let _=[];const z=c({search:{id:""},set:new Set,setObj:{},spanArr:_,arr:_,select:_,statisticsCount:0});i(u.json,((e,t)=>{}));const A=()=>{let e=[...z.set].map((e=>e=[e,!1]));z.setObj=Object.fromEntries(e),y()},y=()=>{Object.keys(z.setObj).forEach((e=>{let t=[];z.arr.forEach((r=>{r.source===e&&t.push(r.select_status)})),z.setObj[e]=!0,t.includes(!1)&&(z.setObj[e]=!1)})),E()},E=()=>{let e=z.arr.reduce(((e,t)=>t.select_status?e+parseInt(t.device_count):e),0);z.statisticsCount=v(e)},P=()=>{let e=[],u=0;z.arr.forEach((n=>{var c,i;n.select_status&&(e.push((c=((e,t)=>{for(var r in t||(t={}))a.call(t,r)&&l(e,r,t[r]);if(s)for(var r of s(t))o.call(t,r)&&l(e,r,t[r]);return e})({},n),i={source:n.source,label:n.label},t(c,r(i)))),u+=parseInt(n.device_count))})),n("kk",e)},x=(e,t)=>{z.spanArr=[];let r=0;for(var s=0;s<e.length;s++)0===s?z.spanArr.push(1):e[s][t]===e[s-1][t]?(z.spanArr[r]+=1,z.spanArr.push(0)):(z.spanArr.push(1),r=s)},C=({row:e,column:t,rowIndex:r,columnIndex:s})=>{if(0===s){const e=z.spanArr[r];return{rowspan:e,colspan:e>0?1:0}}};return d((()=>{(()=>{if(0!==u.json.all.length){z.set=new Set;let e=u.json.all;return z.select=u.json.select,e.map((e=>{e.select_status=!1,z.set.add(e.source),z.select.map((t=>(e.source===t.source&&e.label===t.label&&(e.select_status=!0),e)))})),e.sort(((e,t)=>e.label>t.label?1:e.label<t.label?-1:1)),e.sort(((e,t)=>e.source>t.source?1:e.source<t.source?-1:1)),x(e,"source"),z.arr=e,A(),e}JSON.parse(JSON.stringify(z.arr))})()})),(e,t)=>{const r=p("el-checkbox"),s=p("el-table-column"),a=p("el-table");return b(),f("div",null,[m("div",L,[g(a,{data:j(z).arr,"span-method":C,border:"",style:{width:"100%","margin-top":"20px"}},{default:h((()=>[g(s,{prop:"source",label:"Source",width:"180"},{default:h((e=>[g(r,{modelValue:j(z).setObj[e.row.source],"onUpdate:modelValue":t=>j(z).setObj[e.row.source]=t,onChange:t=>{return r=e.row.source,s=j(z).setObj[e.row.source],z.arr.map((e=>{e.source===r&&(e.select_status=s)})),y(),void P();var r,s}},{default:h((()=>[w(O(e.row.source),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),g(s,{prop:"label",label:"Label"}),g(s,{prop:"slot_id",label:"Slot ID"}),g(s,{prop:"device_count",label:"Count"},{default:h((e=>[m("span",null,O(j(v)(e.row.device_count)),1)])),_:1}),g(s,{prop:"select",label:"Select"},{default:h((e=>[g(r,{modelValue:e.row.select_status,"onUpdate:modelValue":t=>e.row.select_status=t,onChange:t=>(e.row,y(),void P())},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data"]),m("div",k,[M,m("span",{textContent:O(j(z).statisticsCount)},null,8,S)])])])}}});export{_ as A,V as _,z as a,A as b,y as c,E as d,x as e,P as f,C as g};
