import{d as e,o as l,c as a,x as r,y as o,h as t,r as s,L as m,q as d,z as i,e as u,s as n,v as f,P as c,f as p,g as _}from"./main-61c3af98.js";import{b,c as v,d as y}from"./tool-e8a715ec.js";import{m as F}from"./message-eb16f05b.js";import{u as g}from"./useUtils-26826e90.js";import{d as w,e as V,f as x}from"./new-format-87736781.js";import{_ as h}from"./lodash-39fd9b63.js";const j={class:"w100 flex jc-between p10-20"},U={class:"mr-10"},q=r("div",{class:"split-box"},null,-1),C=e({props:{title:{type:String,default:""}},setup(e){const t=e;return(e,s)=>(l(),a("div",j,[r("div",U,o(t.title),1),q]))}}),D={class:"content-con from-one flex column"},M={class:"content-con from-one flex column"},k={class:"w100 flex"},I=p(" 确认 "),L=p(" 取消 "),S=e({setup(e){const{getRouterData:p,getCommonCountryList:j,goNewUrl:U}=g();let{proxy:q}=_();const S="此项必填";let z=t("create");const N={id:"",ad_id:"",ad_name:"",desc:"",flow_rate:""},P=s({ruleForm:N,rules:{ad_name:[{required:!0,message:S,trigger:["blur","change"]}],flow_rate:[{required:!0,message:S,trigger:["blur","change"]}]},options:{}}),R=()=>{q.$refs.ruleForm.validate((e=>{if(!e)return!1;B()}))},$=["flow_rate"],A=[],B=async()=>{let e=c(P.ruleForm);if(e=w(e),e=V(e,$),"create"===z.value){delete e.id;const l=await b(e);F(l)&&E()}if("edit"===z.value){const l=await v(e);F(l)&&E()}},E=()=>{let e="";"create"===z.value&&(e="./list"),"edit"===z.value&&(e="../list"),U({url:e})},G=()=>{var e,l;let{query:a,params:r}=p();if(a.type,z.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",(async()=>{})(),"create"===z.value&&(P.ruleForm=h.cloneDeep(N)),"edit"===z.value){const{id:e}=r;(async e=>{const l=await y(e),{data:a}=l;P.ruleForm=x(a,A)})(e)}};return m((()=>{G()})),(e,t)=>{const s=d("el-form-item"),m=d("el-input"),c=d("el-form"),p=d("el-button");return l(),a("div",null,[i(" form "),u(c,{ref:"ruleForm",enctype:"multipart/form-data",rules:f(P).rules,model:f(P).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===f(z)&&2===f(P).ruleForm.is_del},{default:n((()=>[u(f(C),{title:"基本信息"}),r("div",D,[u(s,{class:"self-el-form-item",label:"ID:",prop:"id"},{default:n((()=>[r("span",null,o(f(P).ruleForm.id),1)])),_:1}),u(s,{class:"self-el-form-item",label:"广告主名称:",prop:"ad_name"},{default:n((()=>[u(m,{modelValue:f(P).ruleForm.ad_name,"onUpdate:modelValue":t[0]||(t[0]=e=>f(P).ruleForm.ad_name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(s,{class:"self-el-form-item",label:"广告主ID:",prop:"ad_id"},{default:n((()=>[u(m,{modelValue:f(P).ruleForm.ad_id,"onUpdate:modelValue":t[1]||(t[1]=e=>f(P).ruleForm.ad_id=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(s,{class:"self-el-form-item",label:"描述:",prop:"desc"},{default:n((()=>[u(m,{modelValue:f(P).ruleForm.desc,"onUpdate:modelValue":t[2]||(t[2]=e=>f(P).ruleForm.desc=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),u(f(C),{title:"广告主配置"}),r("div",M,[u(s,{class:"self-el-form-item",label:"强制流量占比(%):",prop:"flow_rate"},{default:n((()=>[u(m,{modelValue:f(P).ruleForm.flow_rate,"onUpdate:modelValue":t[3]||(t[3]=e=>f(P).ruleForm.flow_rate=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number"},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),i(" form "),i(" footer "),r("div",k,[u(p,{type:"primary",onClick:R},{default:n((()=>[I])),_:1}),u(p,{type:"primary",onClick:E},{default:n((()=>[L])),_:1})])])}}});export{S as default};
