import{Q as e,d as t,r as s,w as a,L as r,q as l,o,c as n,x as u,e as i,s as c,v as d,f as p,y as m}from"./main-6b68d136.js";import{b as f}from"./format-15e3f823.js";import{_ as g}from"./lodash-e0dee56d.js";function h(t){return e({url:"light-sy",data:t,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function b(t){return e({url:"light-sy/offer-max-clk",data:t,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function w(t){return e({url:"light-sy/edit-clk-limit",data:t,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function A(t){return e({url:"light-sy/status",data:t,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function _(t){return e({url:"light-sy",data:t,method:"post",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function y(t){return e({url:"light-sy",data:t,method:"put",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}function j(t){return e({url:`light-sy/view/${t}`,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function v(t){return e({url:"light-sy/copy",method:"get",data:t,bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function E(){return e({url:"light-sy/edit-config",method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function L(t){return e({url:"light-sy/offer-device",data:t,method:"get",bfLoading:!1,isParams:!0,isAlertErrorMsg:!1})}function O(t){return e({url:"light-sy/device",data:t,method:"patch",bfLoading:!1,isParams:!1,isAlertErrorMsg:!1})}const M={class:"full"},P={class:"w100 flex mt-20"},x=u("span",null,"选中合计：",-1),C=["textContent"],k=t({props:{all:{require:!0,default:()=>({}),type:Object},select:{require:!0,default:()=>({}),type:Object}},emits:["kk","count","up"],setup(e,{emit:t}){const h=e;let b=[];const w=s({search:{id:""},test:"",set:new Set,setObj:{},spanArr:b,all:b,select:b,statisticsCount:0}),A=()=>{let e=[...w.set].map((e=>e=[e,!1]));w.setObj=Object.fromEntries(e),_()},_=()=>{Object.keys(w.setObj).forEach((e=>{let t=[];w.all.forEach((s=>{s.source===e&&t.push(s.select_status)})),w.setObj[e]=!0,t.includes(!1)&&(w.setObj[e]=!1)})),y()},y=()=>{let e=w.all.reduce(((e,t)=>t.select_status?e+parseInt(t.device_count):e),0);w.statisticsCount=f(e),t("count",e)},j=()=>{let e=[],s=0;w.all.forEach((t=>{t.select_status&&(e.push({source:t.source,label:t.label}),s+=parseInt(t.device_count))})),t("kk",e)},v=(e,t)=>{w.spanArr=[];let s=0;for(var a=0;a<e.length;a++)0===a?w.spanArr.push(1):e[a][t]===e[a-1][t]?(w.spanArr[s]+=1,w.spanArr.push(0)):(w.spanArr.push(1),s=a)},E=({row:e,column:t,rowIndex:s,columnIndex:a})=>{if(0===a){const e=w.spanArr[s];return{rowspan:e,colspan:e>0?1:0}}};return a((()=>h.all),((e,t)=>{h.all&&h.all.length>0&&(w.all=g.cloneDeep(h.all),w.select=g.cloneDeep(h.select),w.set=new Set,w.all.map((e=>(e.select_status=!1,w.set.add(e.source),w.select.map((t=>(e.source===t.source&&e.label===t.label&&(e.select_status=!0),e))),e))),w.all.sort(((e,t)=>e.label>t.label?1:e.label<t.label?-1:1)),w.all.sort(((e,t)=>e.source>t.source?1:e.source<t.source?-1:1)),v(w.all,"source"),A())}),{immediate:!0}),r((()=>{})),(e,t)=>{const s=l("el-checkbox"),a=l("el-table-column"),r=l("el-table");return o(),n("div",null,[u("div",M,[i(r,{data:d(w).all,"span-method":E,border:"",style:{width:"100%","margin-top":"20px"}},{default:c((()=>[i(a,{prop:"source",label:"Source",width:"180"},{default:c((e=>[i(s,{modelValue:d(w).setObj[e.row.source],"onUpdate:modelValue":t=>d(w).setObj[e.row.source]=t,onChange:t=>{return s=e.row.source,a=d(w).setObj[e.row.source],w.all.map((e=>{e.source===s&&(e.select_status=a)})),_(),void j();var s,a}},{default:c((()=>[p(m(e.row.source),1)])),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),i(a,{prop:"label",label:"Label"}),i(a,{prop:"slot_id",label:"Slot ID"}),i(a,{prop:"device_count",label:"Count"},{default:c((e=>[u("span",null,m(d(f)(e.row.device_count)),1)])),_:1}),i(a,{prop:"select",label:"Select"},{default:c((e=>[i(s,{modelValue:e.row.select_status,"onUpdate:modelValue":t=>e.row.select_status=t,onChange:t=>(e.row,_(),void j())},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data"]),u("div",P,[x,u("span",{textContent:m(d(w).statisticsCount)},null,8,C)])])])}}});export{h as A,k as _,b as a,w as b,A as c,L as d,O as e,_ as f,y as g,E as h,j as i,v as j};
