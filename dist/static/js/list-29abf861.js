import{d as e,ah as a,y as l,B as t,r as i,ai as o,i as r,s as c,g as n,v as s,f as d,h as u,P as p,c as m,Q as f,o as b,F as h,j as v,x as g,t as _}from"./vendor-b395509e.js";import{P as y}from"./index-1a52236e.js";import{A as w,_ as V,a as k,b as D,c as x,d as F,e as C}from"./device-1ae93e1b.js";import{m as U}from"./message-2bc78ae8.js";import{_ as j}from"./lodash-8aca15e5.js";import{h as z}from"./new-format-1656c250.js";import{b as A}from"./format-b76f9697.js";import{_ as P}from"./index-4eec30de.js";import"./moment-1cf83a0b.js";const S={class:"controlBox w100 mb-10"},O={class:"mb-10"},N=g("Offer Create"),Q={class:"flex jc-start flex-wrap w100"},E={class:"flex"},B={class:"flex"},$=g("查询"),I={class:"flex jc-around"},J={class:"flex jc-around"},L={class:"flex jc-between"},M=["textContent"],T={class:"flex jc-around"},K={class:"w100 flex"},q={class:"dialog-footer"},G=g("确 定");var H=P(e({setup(e){const P=a({attribute_provider:[],platform:[],package_name:"",channel:"",id:"",offer_title:"",country:"",pid:""});let H=l({offer:{},index:null,cacheDevice:{}}),R=l({dialogVisible:!1,dialogVisibleDevice:!1,cache:{item:{},device:{}},searchForm:P.value,useData:P.value,loading:!0,options:{cutoff_start:[...new Array(20)].map(((e,a)=>{const l=5*a/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),cutoff_end:[...new Array(20)].map(((e,a)=>{const l=(5*a+5)/100;return{value:l,label:`${(100*Number(l)).toFixed(0)}%`}})),attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],platform:[{value:"1",label:"Android"},{value:"2",label:"iOS"}]},list:[],pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});const W=()=>{R.useData=j.cloneDeep(R.searchForm),X()},X=async()=>{R.loading=!0;let e={page:R.pagination.listQuery.page,page_size:R.pagination.listQuery.limit};R.useData.attribute_provider&&(e.attribute_provider=R.useData.attribute_provider),R.useData.platform&&(e.platform=R.useData.platform),R.useData.package_name&&(e.pkg_name=R.useData.package_name),R.useData.channel&&(e.channel=R.useData.channel),R.useData.id&&(e.offer_id=R.useData.id),R.useData.offer_title&&(e.title=R.useData.offer_title),R.useData.country&&(e.country=R.useData.country),R.useData.pid&&(e.tracking_link=R.useData.pid);const a=await w(e),{data:l}=a,{page:t}=l;R.list=null==l?void 0:l.data,R.pagination.total=Number(t.count),R.loading=!1},Y=e=>{H.cacheDevice.select=e},Z=async()=>{const e={id:H.offer.id,device:JSON.stringify(H.cacheDevice.select)},a=await C(e);U(a),R.dialogVisibleDevice=!1};return t((()=>{W()})),(e,a)=>{const l=i("el-button"),t=i("router-link"),w=i("el-option"),C=i("el-select"),j=i("el-form-item"),P=i("el-input"),ee=i("el-form"),ae=i("el-table-column"),le=i("el-switch"),te=i("el-table"),ie=i("el-dialog"),oe=o("loading");return b(),r("div",null,[c("div",S,[c("div",O,[n(" <el-button type=\"primary\" @click='createFun'>Offer Create</el-button> "),s(t,{to:"/buzz/old-buzz/create"},{default:d((()=>[s(l,{type:"primary"},{default:d((()=>[N])),_:1})])),_:1})]),s(ee,{inline:!0,modelValue:u(R).searchForm,"onUpdate:modelValue":a[8]||(a[8]=e=>u(R).searchForm=e),class:"flex jc-between w100 ai-end"},{default:d((()=>[c("div",Q,[s(j,{label:""},{default:d((()=>[s(C,{modelValue:u(R).searchForm.attribute_provider,"onUpdate:modelValue":a[0]||(a[0]=e=>u(R).searchForm.attribute_provider=e),clearable:"",class:"search-con",placeholder:"Attribute Provider",style:{"min-width":"140px"}},{default:d((()=>[(b(!0),r(h,null,v(u(R).options.attribute_provider,(e=>(b(),m(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(j,{label:""},{default:d((()=>[s(C,{modelValue:u(R).searchForm.platform,"onUpdate:modelValue":a[1]||(a[1]=e=>u(R).searchForm.platform=e),clearable:"",class:"search-con",placeholder:"Platform",style:{"min-width":"95px"}},{default:d((()=>[(b(!0),r(h,null,v(u(R).options.platform,(e=>(b(),m(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),s(j,{label:""},{default:d((()=>[s(P,{placeholder:"Package Name",modelValue:u(R).searchForm.package_name,"onUpdate:modelValue":a[2]||(a[2]=e=>u(R).searchForm.package_name=e),class:"search-con",style:{"min-width":"120px"}},null,8,["modelValue"])])),_:1}),s(j,{label:""},{default:d((()=>[s(P,{placeholder:"Channel",modelValue:u(R).searchForm.channel,"onUpdate:modelValue":a[3]||(a[3]=e=>u(R).searchForm.channel=e),class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),s(j,{label:""},{default:d((()=>[s(P,{placeholder:"ID",modelValue:u(R).searchForm.id,"onUpdate:modelValue":a[4]||(a[4]=e=>u(R).searchForm.id=e),class:"search-con"},null,8,["modelValue"])])),_:1}),s(j,{label:""},{default:d((()=>[s(P,{placeholder:"Offer Title",modelValue:u(R).searchForm.offer_title,"onUpdate:modelValue":a[5]||(a[5]=e=>u(R).searchForm.offer_title=e),class:"search-con",style:{"min-width":"90px"}},null,8,["modelValue"])])),_:1}),s(j,{label:""},{default:d((()=>[s(P,{placeholder:"Country",modelValue:u(R).searchForm.country,"onUpdate:modelValue":a[6]||(a[6]=e=>u(R).searchForm.country=e),class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])])),_:1}),s(j,{label:""},{default:d((()=>[s(P,{placeholder:"Pid",modelValue:u(R).searchForm.pid,"onUpdate:modelValue":a[7]||(a[7]=e=>u(R).searchForm.pid=e),class:"search-con"},null,8,["modelValue"])])),_:1})]),c("div",E,[s(j,{class:"mr-0",style:{"margin-right":"0px"}},{default:d((()=>[c("div",B,[s(l,{type:"primary",onClick:W},{default:d((()=>[$])),_:1}),n(' <el-button type="primary" @click="handleExportSearch">导出</el-button> ')])])),_:1})])])),_:1},8,["modelValue"]),n(' <el-input placeholder="请输入内容" v-model="data.searchForm.data" class=\'search-input\'>\n        <el-button slot="append" icon="Search" @click=\'searchFun\'></el-button>\n      </el-input> ')]),n(" table "),p((b(),m(te,{center:"",data:u(R).list,class:"w100",height:"60vh",border:""},{default:d((()=>[s(ae,{fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"70"}),s(ae,{fixed:"",prop:"channel",label:"Channel",align:"center",width:"60"}),s(ae,{prop:"pkg_name",label:"Package Name",align:"center",width:"110"}),s(ae,{prop:"title",label:"Offer Title",align:"center"}),s(ae,{prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),s(ae,{prop:"pid",label:"Pid",align:"center",width:"90"}),s(ae,{prop:"platform",label:"Platform",align:"center",width:"65"},{default:d((e=>[g(_(1===Number(e.row.platform)?"Android":"iOS"),1)])),_:1}),s(ae,{prop:"country",label:"Country",align:"center",width:"57"}),s(ae,{prop:"payout",label:"Payout",align:"center",width:"55"}),s(ae,{label:"Click Limitation(w)",width:"150",align:"center"},{default:d((e=>[c("div",I,[s(P,{modelValue:e.row.max_clk_num,"onUpdate:modelValue":a=>e.row.max_clk_num=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),s(l,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,max_clk_num:parseFloat(e.max_clk_num)},l=await k(a);U(l)})(e.row)},null,8,["onClick"])])])),_:1}),s(ae,{label:"Site Click Limitation",width:"150",align:"center"},{default:d((e=>[c("div",J,[s(P,{modelValue:e.row.site_clk_limit,"onUpdate:modelValue":a=>e.row.site_clk_limit=a,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),s(l,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async e=>{let a={id:e.id,site_clk_limit:parseFloat(e.site_clk_limit)},l=await D(a);U(l)})(e.row)},null,8,["onClick"])])])),_:1}),s(ae,{label:"Select Device",width:"120",align:"center"},{default:d((e=>[c("div",L,[c("span",{textContent:_(u(A)(e.row.device_count))},null,8,M),s(l,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:a=>(async(e,a)=>{R.dialogVisibleDevice=!0,H.offer=a,H.index=e;const l={id:a.id,platform:a.platform,country:a.country},{data:t}=await F(l);H.cacheDevice.all=t.all,H.cacheDevice.select=JSON.parse(a.device)})(e.$index,e.row)},null,8,["onClick"])])])),_:1}),s(ae,{label:"Operation",align:"center"},{default:d((e=>{return[c("div",T,[s(t,{to:(a=e.row,`/buzz/old-buzz/edit/${a.id}`)},{default:d((()=>[s(l,{class:"cp mr-10",type:"primary",icon:"Edit",circle:""})])),_:2},1032,["to"]),n(" <el-button class='cp mr-10' type=\"primary\" icon=\"Edit\" circle @click='editFun(scope.row)'></el-button> "),s(le,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,onChange:a=>(async e=>{let a={id:e.id,status:e.status};a=z(a);const l=await x(a);U(l)})(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])];var a})),_:1})])),_:1},8,["data"])),[[oe,u(R).loading]]),n(" 分页 "),c("div",K,[p(s(u(y),{total:u(R).pagination.total,"page-sizes":u(R).pagination.pageSizes,page:u(R).pagination.listQuery.page,"onUpdate:page":a[9]||(a[9]=e=>u(R).pagination.listQuery.page=e),limit:u(R).pagination.listQuery.limit,"onUpdate:limit":a[10]||(a[10]=e=>u(R).pagination.listQuery.limit=e),onPagination:X},null,8,["total","page-sizes","page","limit"]),[[f,u(R).pagination.total]])]),n(" device "),s(ie,{title:"Device",modelValue:u(R).dialogVisibleDevice,"onUpdate:modelValue":a[13]||(a[13]=e=>u(R).dialogVisibleDevice=e)},{default:d((()=>[u(R).dialogVisibleDevice?(b(),m(V,{key:0,all:u(H).cacheDevice.all,"onUpdate:all":a[11]||(a[11]=e=>u(H).cacheDevice.all=e),select:u(H).cacheDevice.select,"onUpdate:select":a[12]||(a[12]=e=>u(H).cacheDevice.select=e),onKk:Y},null,8,["all","select"])):n("v-if",!0),c("span",q,[n(' <el-button @click="cancleDevice">取 消</el-button> '),s(l,{type:"primary",onClick:Z},{default:d((()=>[G])),_:1})])])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-0b56db22"]]);export{H as default};
