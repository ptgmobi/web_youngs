import{_ as e,d as l,r as a,h as o,I as r,b as t,L as m,q as s,c as i,z as d,e as u,s as n,v as p,x as c,K as f,P as _,o as v,N as b,O as g,A as y,f as F,y as V,g as h}from"./main-0a777472.js";import{u as k,s as x}from"./useUtils-9816d64a.js";import{c as U,d as j,e as w}from"./dsp-adcontrol-3aaea3f8.js";import{A as C}from"./dsp-campaign-e75c5a1e.js";import{m as D}from"./message-d6ce123e.js";import{_ as L}from"./index-1624392f.js";import{d as M,e as q}from"./new-format-7f959bed.js";import{s as A}from"./validate-31aaa08c.js";import{_ as O}from"./lodash-4786ff9c.js";import P from"./list-013b9935.js";import"./index-2575c6ed.js";import"./clipboard-polyfill.text.esm-fc4f7791.js";const I={class:"content-con from-one flex column"},N={class:"content-con from-one flex column"},$={class:"content-con from-one flex column"},z={class:"w100 flex"},E={class:"w100 flex"};var H=e(l({__name:"details",setup(e){const{adv_type:l,ad_type:H}=x,{getRouterData:K,getCommonCountryList:R,goNewUrl:S}=k();let{proxy:B}=h();const G="此项必填";let J=a({campaignList:[],campaignOne:{},dpa:{}}),Q=o("create"),T=o(!1);o(!1);const W={id:void 0,ad_id:"",name:"",ad_group_id:"",descs:"",category_id:void 0,type:1,originality_id:void 0,deeplink:"",is_h5:1,mobilelink:"",click_url:"",impression_url:"",campaign:[],dpa:[],status:1,is_del:0},X=(e,l,a)=>{const{max:o}=e;A(l,o)?a(void 0):a(new Error("值的长度不能大于${}"))},Y=a({ruleForm:W,rules:{adv_series_name:[{required:!0,message:G,trigger:["blur","change"]},{validator:X,max:100,trigger:["blur","change"]}],adv_name:[{required:!0,message:G,trigger:["blur","change"]}],descs:[{validator:X,max:200,trigger:["blur","change"]}],adv_series_type:[{required:!0,message:G,trigger:["blur","change"]}],adv_series_budget:[{required:!0,message:G,trigger:["blur","change"]}]},options:{adv_type:l,adv_series_type:[{value:1,label:"动态商品促销"},{value:2,label:"固定链接推广"}],adv_name:[],ad_num:[{value:"1",label:"1个"},{value:"2-10",label:"2-10个"}],campaign:[],dpa:[],ad_group:[],category:[],type:H}}),Z=()=>{B.$refs.ruleForm.validate((e=>{if(!e)return!1;le()}))},ee=["id","adv_id","adv_series_type","adv_series_budget"],le=async()=>{let e=_(Y.ruleForm);if(e=M(e),e=q(e,ee),"create"===Q.value){delete e.id;const l=await U(e);D(l)&&ae()}if("edit"===Q.value){const l=await j(e);D(l)&&ae()}},ae=()=>{S({url:"/adcontrol/adseries/list"})},oe=r((()=>{let e=Y.ruleForm.type;return Y.options.campaign.filter((l=>l.type===e))})),re=r((()=>({type:Y.ruleForm.type}))),te=()=>{T.value=!0},me=e=>{J.CampaignList=e},se=e=>{J.CampaignOne=e},ie=()=>{"create"===Q.value&&(J.CampaignList,Y.ruleForm.campaign=J.CampaignList.map((e=>e.id))),"edit"===Q.value&&(J.CampaignOne,Y.ruleForm.campaign=J.CampaignOne),T.value=!1},de=()=>{var e,l;let{query:a,params:o}=K();if(Q.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"","create"===Q.value&&(Y.ruleForm=O.cloneDeep(W)),"edit"===Q.value){const{id:e}=o;(async e=>{const l=await w(e),{data:a}=l;Y.ruleForm={...Y.ruleForm,...a},Y.ruleForm})(e)}},ue=r((()=>Y.ruleForm.campaign)),ne=r((()=>Y.ruleForm.campaign));return t((()=>{(async()=>{const e={limit:1e4,page:1};await Promise.all([C(e),C(e)]).then((e=>{let l=e[0].data.data;Y.options.campaign=l.map((e=>(e.value=e.id,e.label=e.name,e))),Y.options.campaign,e[1].data.data,Y.options.dpa=l.map((e=>(e.value=e.id,e.label=e.name,e)))}))})()})),m((()=>{de()})),(e,l)=>{const a=s("el-input"),o=s("el-form-item"),r=s("el-option"),t=s("el-select"),m=s("el-radio"),_=s("el-radio-group"),h=s("el-button"),k=s("el-checkbox"),x=s("el-form"),U=s("el-dialog");return v(),i("div",null,[d(" form "),u(x,{ref:"ruleForm",enctype:"multipart/form-data",rules:p(Y).rules,model:p(Y).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===p(Q)&&2===p(Y).ruleForm.is_del},{default:n((()=>[u(p(L),{title:"基础信息"}),c("div",I,[u(o,{class:"self-el-form-item",label:"广告名称:",prop:"name"},{default:n((()=>[u(a,{modelValue:p(Y).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>p(Y).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(o,{class:"self-el-form-item",label:"所属广告组:",prop:"adv_name"},{default:n((()=>[u(t,{modelValue:p(Y).ruleForm.ad_group_id,"onUpdate:modelValue":l[1]||(l[1]=e=>p(Y).ruleForm.ad_group_id=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:n((()=>[(v(!0),i(b,null,g(p(Y).options.ad_group,(e=>(v(),y(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),u(o,{class:"self-el-form-item",label:"描述:",prop:"descs"},{default:n((()=>[u(a,{modelValue:p(Y).ruleForm.descs,"onUpdate:modelValue":l[2]||(l[2]=e=>p(Y).ruleForm.descs=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),u(p(L),{title:"广告内容"}),c("div",N,[u(o,{class:"self-el-form-item",label:"内容分类:",prop:"category_id"},{default:n((()=>[u(t,{modelValue:p(Y).ruleForm.category_id,"onUpdate:modelValue":l[3]||(l[3]=e=>p(Y).ruleForm.category_id=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:n((()=>[(v(!0),i(b,null,g(p(Y).options.category,(e=>(v(),y(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),u(o,{class:"self-el-form-item",label:"广告样式:",prop:"type"},{default:n((()=>[d(' <el-select\n            v-model="state.ruleForm.type"\n            filterable\n            placeholder="请选择"\n            class="form-one"\n          >\n            <el-option\n              v-for="item in state.options.type"\n              :key="item.value"\n              :label="item.label"\n              :value="item.value"\n            ></el-option>\n          </el-select> '),u(_,{class:"form-one",modelValue:p(Y).ruleForm.type,"onUpdate:modelValue":l[4]||(l[4]=e=>p(Y).ruleForm.type=e)},{default:n((()=>[(v(!0),i(b,null,g(p(Y).options.type,(e=>(v(),y(m,{label:e.value},{default:n((()=>[F(V(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1}),"create"===p(Q)?(v(),y(o,{key:0,class:"self-el-form-item",label:"广告数量:",prop:"marbet_target"},{default:n((()=>[u(_,{class:"form-one",modelValue:p(Y).ruleForm.ad_num,"onUpdate:modelValue":l[5]||(l[5]=e=>p(Y).ruleForm.ad_num=e)},{default:n((()=>[(v(!0),i(b,null,g(p(Y).options.ad_num,(e=>(v(),y(m,{disabled:"edit"===p(Q),label:e.value},{default:n((()=>[F(V(e.label),1)])),_:2},1032,["disabled","label"])))),256))])),_:1},8,["modelValue"])])),_:1})):d("v-if",!0),d(" 选择创意 start "),u(o,{class:"self-el-form-item",label:"选择创意:",prop:"campaign"},{default:n((()=>[c("div",null,[c("div",null,[u(h,{type:"primary",onClick:te},{default:n((()=>[F("选择创意")])),_:1})]),c("div",null,[u(t,{modelValue:p(Y).ruleForm.campaign,"onUpdate:modelValue":l[6]||(l[6]=e=>p(Y).ruleForm.campaign=e),filterable:"",placeholder:"请选择",class:"form-one mt-10",multiple:""},{default:n((()=>[(v(!0),i(b,null,g(p(oe),(e=>(v(),y(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1}),d(" 选择创意 end "),d(" 选择DPA模板 start "),u(o,{class:"self-el-form-item",label:"选择DPA模板:",prop:"campaign"},{default:n((()=>[c("div",null,[c("div",null,[u(h,{type:"primary"},{default:n((()=>[F("选择DPA模板")])),_:1})]),c("div",null,[u(t,{modelValue:p(Y).ruleForm.dpa,"onUpdate:modelValue":l[7]||(l[7]=e=>p(Y).ruleForm.dpa=e),filterable:"",placeholder:"请选择",class:"form-one mt-10",multiple:""},{default:n((()=>[(v(!0),i(b,null,g(p(Y).options.dpa,(e=>(v(),y(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1}),d(" 选择DPA模板 end ")]),u(p(L),{title:"广告内容"}),c("div",$,[u(o,{class:"self-el-form-item",label:"Deeplink:",prop:"deeplink"},{default:n((()=>[u(a,{modelValue:p(Y).ruleForm.deeplink,"onUpdate:modelValue":l[8]||(l[8]=e=>p(Y).ruleForm.deeplink=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(o,{class:"self-el-form-item",label:"落地页跳转方式:",prop:"marbet_target"},{default:n((()=>[u(k,{modelValue:p(Y).ruleForm.is_h5,"onUpdate:modelValue":l[9]||(l[9]=e=>p(Y).ruleForm.is_h5=e),"true-label":"1","false-label":"2",label:"通过H5中间页跳转Deeplink"},null,8,["modelValue"])])),_:1}),u(o,{class:"self-el-form-item",label:"Mobilelink:",prop:"mobilelink"},{default:n((()=>[u(a,{modelValue:p(Y).ruleForm.mobilelink,"onUpdate:modelValue":l[10]||(l[10]=e=>p(Y).ruleForm.mobilelink=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(o,{class:"self-el-form-item",label:"点击监测链接:",prop:"click_url"},{default:n((()=>[u(a,{modelValue:p(Y).ruleForm.click_url,"onUpdate:modelValue":l[11]||(l[11]=e=>p(Y).ruleForm.click_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(o,{class:"self-el-form-item",label:"曝光监测链接:",prop:"impression_url"},{default:n((()=>[u(a,{modelValue:p(Y).ruleForm.impression_url,"onUpdate:modelValue":l[12]||(l[12]=e=>p(Y).ruleForm.impression_url=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),d(" form "),d(" footer "),c("div",z,[u(h,{type:"primary",onClick:Z},{default:n((()=>[F(" 确认 ")])),_:1}),u(h,{type:"primary",onClick:ae},{default:n((()=>[F(" 取消 ")])),_:1}),d(" 选择创意pop "),u(U,{modelValue:p(T),"onUpdate:modelValue":l[13]||(l[13]=e=>f(T)?T.value=e:T=e),title:"创意列表",width:"90%","destroy-on-close":!0},{default:n((()=>[u(P,{class:"mb-10","paga-type":"show","search-data":p(re),"choice-list":p(ue),"choice-one":p(ne),"choice-type":"create"===p(Q)?2:1,onUpdateList:me,onUpdateOne:se},null,8,["search-data","choice-list","choice-one","choice-type"]),c("div",E,[u(h,{class:"cp mr-10",type:"primary",onClick:ie},{default:n((()=>[F("保存")])),_:1})])])),_:1},8,["modelValue"])])])}}}),[["__scopeId","data-v-5175acd1"]]);export{H as default};
