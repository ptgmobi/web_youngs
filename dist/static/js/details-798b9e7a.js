import{_ as e,d as a,h as l,r,L as s,q as t,c as o,z as d,e as m,s as i,v as u,x as n,P as _,o as f,N as c,O as p,A as v,f as b,y as g,g as y}from"./main-ce43ffdd.js";import{u as F,s as h}from"./useUtils-d1805f03.js";import{c as V,d as x,e as j}from"./dsp-adcontrol-f55c30d2.js";import{A as w}from"./dsp-advertiser-ecff19f5.js";import{m as U}from"./message-1c1d9ef1.js";import{_ as q}from"./index-aa162cf4.js";import{d as k,e as C}from"./new-format-368dcfb0.js";import{s as M}from"./validate-31aaa08c.js";import{_ as z}from"./lodash-6b3789ad.js";import{u as A}from"./dsp-5d727e95.js";const D={class:"content-con from-one flex column"},L={class:"content-con from-one flex column"},N={class:"w100 flex"};var P=e(a({__name:"details",setup(e){const a=A().topsearch;let{adv:P,date:$}=a;const{adv_type:E,ind_cla:I,third_party:O,return_mode:R,time_zone:S}=h,{getRouterData:B,getCommonCountryList:G,goNewUrl:H}=F();let{proxy:J}=y();const K="此项必填";let Q=l("create");const T={id:void 0,adv_id:P,adv_series_name:"",descs:"",marbet_target:1,adv_series_type:1,adv_series_budget:void 0,status:1,is_del:0},W=(e,a,l)=>{const{max:r}=e;M(a,r)?l(void 0):l(new Error("值的长度不能大于${}"))},X=r({ruleForm:T,rules:{adv_series_name:[{required:!0,message:K,trigger:["blur","change"]},{validator:W,max:100,trigger:["blur","change"]}],adv_id:[{required:!0,message:K,trigger:["blur","change"]}],descs:[{validator:W,max:200,trigger:["blur","change"]}],adv_series_type:[{required:!0,message:K,trigger:["blur","change"]}],adv_series_budget:[{required:!0,message:K,trigger:["blur","change"]}]},options:{adv_type:E,adv_series_type:[{value:1,label:"动态商品促销"},{value:2,label:"固定链接推广"}],marbet_target:[{value:1,label:"再营销"},{value:2,label:"拉新"}],advertiser:[{adv_id:"",name:""}]}}),Y=()=>{J.$refs.ruleForm.validate((e=>{if(!e)return!1;ee()}))},Z=["id","adv_series_type","adv_series_budget"],ee=async()=>{let e=_(X.ruleForm);if(e=k(e),e=C(e,Z),"create"===Q.value){delete e.id;const a=await V(e);U(a)&&ae()}if("edit"===Q.value){const a=await x(e);U(a)&&ae()}},ae=()=>{H({url:"/adcontrol/adseries/list"})},le=()=>{var e,a;let{query:l,params:r}=B();if(Q.value=null!=(a=null==(e=l.type)?void 0:e.toString())?a:"",(async()=>{Promise.all([w({limit:1e4,page:1})]).then((e=>{let a=e[0];X.options.advertiser=a.data.data}))})(),"create"===Q.value&&(X.ruleForm=z.cloneDeep(T)),"edit"===Q.value){const{id:e}=r;(async e=>{const a=await j(e),{data:l}=a;X.ruleForm={...X.ruleForm,...l},X.ruleForm})(e)}};return s((()=>{le()})),(e,a)=>{const l=t("el-input"),r=t("el-form-item"),s=t("el-option"),_=t("el-select"),y=t("el-radio"),F=t("el-radio-group"),h=t("el-form"),V=t("el-button");return f(),o("div",null,[d(" form "),m(h,{ref:"ruleForm",enctype:"multipart/form-data",rules:u(X).rules,model:u(X).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===u(Q)&&2===u(X).ruleForm.is_del},{default:i((()=>[m(u(q),{title:"基础信息"}),n("div",D,[m(r,{class:"self-el-form-item",label:"广告主系列名称:",prop:"adv_series_name"},{default:i((()=>[m(l,{modelValue:u(X).ruleForm.adv_series_name,"onUpdate:modelValue":a[0]||(a[0]=e=>u(X).ruleForm.adv_series_name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),m(r,{class:"self-el-form-item",label:"广告主名称:",prop:"adv_name"},{default:i((()=>[m(_,{modelValue:u(X).ruleForm.adv_id,"onUpdate:modelValue":a[1]||(a[1]=e=>u(X).ruleForm.adv_id=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:i((()=>[(f(!0),o(c,null,p(u(X).options.advertiser,(e=>(f(),v(s,{key:e.adv_id,label:e.name,value:e.adv_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(r,{class:"self-el-form-item",label:"描述:",prop:"descs"},{default:i((()=>[m(l,{modelValue:u(X).ruleForm.descs,"onUpdate:modelValue":a[2]||(a[2]=e=>u(X).ruleForm.descs=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),m(u(q),{title:"目标与预算"}),n("div",L,[m(r,{class:"self-el-form-item",label:"营销目标:",prop:"marbet_target"},{default:i((()=>[m(F,{class:"form-one",modelValue:u(X).ruleForm.marbet_target,"onUpdate:modelValue":a[3]||(a[3]=e=>u(X).ruleForm.marbet_target=e)},{default:i((()=>[(f(!0),o(c,null,p(u(X).options.marbet_target,(e=>(f(),v(y,{label:e.value},{default:i((()=>[b(g(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1}),m(r,{class:"self-el-form-item",label:"广告类型:",prop:"adv_series_type"},{default:i((()=>[m(_,{modelValue:u(X).ruleForm.adv_series_type,"onUpdate:modelValue":a[4]||(a[4]=e=>u(X).ruleForm.adv_series_type=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:i((()=>[(f(!0),o(c,null,p(u(X).options.adv_series_type,(e=>(f(),v(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),m(r,{class:"self-el-form-item",label:"广告日预算（美元）:",prop:"adv_series_budget"},{default:i((()=>[m(l,{modelValue:u(X).ruleForm.adv_series_budget,"onUpdate:modelValue":a[5]||(a[5]=e=>u(X).ruleForm.adv_series_budget=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number"},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),d(" form "),d(" footer "),n("div",N,[m(V,{type:"primary",onClick:Y},{default:i((()=>[b(" 确认 ")])),_:1}),m(V,{type:"primary",onClick:ae},{default:i((()=>[b(" 取消 ")])),_:1})])])}}}),[["__scopeId","data-v-929e9770"]]);export{P as default};
