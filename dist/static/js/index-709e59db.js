var A=Object.defineProperty;var D=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,S=Object.prototype.propertyIsEnumerable;var y=(t,e,s)=>e in t?A(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,V=(t,e)=>{for(var s in e||(e={}))B.call(e,s)&&y(t,s,e[s]);if(D)for(var s of D(e))S.call(e,s)&&y(t,s,e[s]);return t};import{ai as N,r as n,k as _,c as r,h as a,i as f,x as o,o as d,y as u,t as w,F as C,l as k,v as L}from"./vendor-f1931894.js";import{g as P}from"./role-cb9c3820.js";import{g as R,a as U,s as I,b as z}from"./station-fbc6c5e4.js";import{m as v}from"./message-c1123ca0.js";import{m as G}from"./self-f44b0ce3.js";import{_ as O}from"./index-fafcd2bc.js";const q={components:{},mixins:[G],data(){return{options:{role:[],pid:[],base_url:""},date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{id:"",name:"",pid:"",role:[],base_url:""},choiceData:{}}}},computed:V({},N(["element"])),created(){this.getConfig(),this.getList()},methods:{async getConfig(){const{data:t}=await P();this.options.role=t},async getList(){const{data:t}=await R();this.data=t,this.list=t,this.options.pid=t},handleCreate(){this.dialogType="new",this.busData.item.type="",this.dialogVisible=!0;const t=new Date;this.date=t.getTime()},async handleEdit(t){this.dialogType="edit",this.busData.item.id=t.row.id;const{data:e}=await U(this.busData.item.id);console.log(e.position),this.busData.item.id=e.position.id,this.busData.item.name=e.position.name,e.position.pid&&(this.busData.item.pid=e.position.pid.toString()),this.busData.item.role=e.position_role,this.dialogVisible=!0;const s=new Date;this.date=s.getTime()},handleDelete(t){},roleChangeChoice(t,e){this.busData.choiceData[t]=e},clearBusData(){const t={item:{id:"",name:"",pid:"",role:[]},choiceData:{}};this.busData=t},async submitFn(){if(this.dialogType==="new"){const t={name:this.busData.item.name,pid:this.busData.item.pid,role_id:this.busData.item.role},e=await I(t);e&&v(e),this.getList()}if(this.dialogType==="edit"){const t={id:this.busData.item.id,name:this.busData.item.name,role_id:this.busData.item.role},e=await z(this.busData.item.id,t);e&&v(e)}this.clearBusData(),this.dialogVisible=!1}}},H={class:"app-container"},J=u(" \u65B0\u5EFA "),K=u(" \u4FEE\u6539 "),M=u(" \u5220\u9664 "),Q={slot:"footer",class:"dialog-footer"},W=u(" \u53D6 \u6D88 "),X=u(" \u786E \u5B9A ");function Y(t,e,s,Z,l,c){const m=n("el-button"),p=n("el-table-column"),E=n("el-table"),F=n("el-input"),b=n("el-form-item"),h=n("el-option"),g=n("el-select"),T=n("el-form"),j=n("el-dialog");return d(),_("div",H,[t.judgePermissionElementFn("A-AS-ADD-V")?(d(),r(m,{key:0,type:"primary",onClick:c.handleCreate},{default:a(()=>[J]),_:1},8,["onClick"])):f("v-if",!0),o(E,{data:l.list,style:{width:"100%","margin-top":"30px"},border:""},{default:a(()=>[o(p,{align:"center",label:"ID"},{default:a(i=>[u(w(i.row.id),1)]),_:1}),o(p,{align:"center",label:"Name"},{default:a(i=>[u(w(i.row.name),1)]),_:1}),o(p,{align:"center",label:"Operations"},{default:a(i=>[t.judgePermissionElementFn("A-AS-EDIT-V")?(d(),r(m,{key:0,type:"primary",size:"small",onClick:x=>c.handleEdit(i)},{default:a(()=>[K]),_:2},1032,["onClick"])):f("v-if",!0),t.judgePermissionElementFn("A-AS-DEL-V")?(d(),r(m,{key:1,type:"danger",size:"small",onClick:x=>c.handleDelete(i)},{default:a(()=>[M]),_:2},1032,["onClick"])):f("v-if",!0)]),_:1})]),_:1},8,["data"]),o(j,{modelValue:l.dialogVisible,"onUpdate:modelValue":e[4]||(e[4]=i=>l.dialogVisible=i),title:l.dialogType==="edit"?"Edit Role":"New Role",width:"90%"},{default:a(()=>[o(T,{"label-width":"150px","label-position":"left"},{default:a(()=>[o(b,{label:"Name"},{default:a(()=>[o(F,{modelValue:l.busData.item.name,"onUpdate:modelValue":e[0]||(e[0]=i=>l.busData.item.name=i),disabled:l.dialogType==="edit",placeholder:""},null,8,["modelValue","disabled"])]),_:1}),o(b,{label:"PID"},{default:a(()=>[o(g,{modelValue:l.busData.item.pid,"onUpdate:modelValue":e[1]||(e[1]=i=>l.busData.item.pid=i),disabled:l.dialogType==="edit",filterable:"",class:"w100",placeholder:"\u8BF7\u9009\u62E9"},{default:a(()=>[(d(!0),_(C,null,k(l.options.pid,i=>(d(),r(h,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),_:1}),o(b,{label:"Role"},{default:a(()=>[o(g,{modelValue:l.busData.item.role,"onUpdate:modelValue":e[2]||(e[2]=i=>l.busData.item.role=i),filterable:"",multiple:"",class:"w100",placeholder:"\u652F\u6301\u591A\u9009"},{default:a(()=>[(d(!0),_(C,null,k(l.options.role,i=>(d(),r(h,{key:i.id,label:i.name,value:i.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),L("div",Q,[o(m,{onClick:e[3]||(e[3]=i=>l.dialogVisible=!1)},{default:a(()=>[W]),_:1}),o(m,{type:"primary",onClick:c.submitFn},{default:a(()=>[X]),_:1},8,["onClick"])])]),_:1},8,["modelValue","title"])])}var se=O(q,[["render",Y]]);export{se as default};
