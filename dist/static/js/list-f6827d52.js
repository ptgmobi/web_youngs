import{_ as e,d as a,h as l,r as t,L as o,q as s,a0 as i,c as r,x as d,e as n,v as p,s as u,z as c,U as m,A as _,V as b,K as v,o as f,N as g,O as y,f as h,y as w}from"./main-ce43ffdd.js";import{u as V,s as x}from"./useUtils-d1805f03.js";import{P as k}from"./index-2d86919d.js";import{m as j}from"./message-1c1d9ef1.js";import{_ as U}from"./lodash-6b3789ad.js";import{h as F,g as C}from"./new-format-368dcfb0.js";import{c as Q}from"./clipboard-c9959b6b.js";import{f as D,a as S,g as q,h as z,i as A}from"./dsp-adcontrol-f55c30d2.js";import{A as N}from"./dsp-advertiser-ecff19f5.js";import{_ as I}from"./index-1ba4ede6.js";import"./clipboard-polyfill.text.esm-fc4f7791.js";import"./format-00f0450d.js";import"./moment-56f006b0.js";import"./dsp-5d727e95.js";const O={class:"controlBox w100 mb-10"},P={class:"flex jc-start flex-wrap w100"},$={class:"flex"},L={class:"flex"},R={class:"mb-10 w100"},B=["onClick"],E={class:"flex jc-around"},K={class:"w100 flex"},T=a({name:"adserieslist"});var G=e(a({...T,setup(e){const a=l([{id:""}]),{status:T,adv_type:G,ind_cla:H,third_party:J,return_mode:M}=x,{goNewUrl:W,getRouterData:X,getCommonCountryList:Y,openAlert:Z}=V(),ee=t({adv_series_id:"",status:"",adv_series_type:"",marbet_target:"",is_del:"1",value_type:"adv_group_name",value:""}),ae=l(!1),le=t({report_api:""});let te=t({dialogVisible:!1,cache:{item:{}},searchForm:ee,useData:ee,loading:!0,options:{status:T,adv_series_type:[{value:1,label:"动态商品促销"},{value:2,label:"固定链接推广"}],marbet_target:[{value:1,label:"再营销"},{value:2,label:"拉新"}],value_type:[{value:"adv_group_name",label:"广告组名称"},{value:"id",label:"广告组ID"},{value:"descs",label:"描述"}],promotion_cycle:[{value:1,label:"从现在开始长期有效"},{value:2,label:"限定周期"}],country:[],advertiser:[],adv_series:[],adx:[]},list:[{id:1}],pagination:{pageSizes:[20,50,100,500,1e3],total:1,listQuery:{page:1,limit:50,importance:void 0,title:void 0,type:void 0,sort:"+id"}}}),oe=t({data:{mode:""},options:{mode:[{value:1,label:"开启"},{value:2,label:"暂停"},{value:0,label:"归档"}]}});const se=t({adv_id:"",st:"",et:""}),ie=()=>{te.useData=U.cloneDeep(te.searchForm),ue()},re=e=>{se.adv_id=e.adv,e.date&&(se.st=e.date[0],se.et=e.date[1])};l([]);const de=()=>{W({url:"/adcontrol/adgroup/create",query:{type:"create"}})},ne=async e=>{Z({text:`确认归档${e.row.name}？`,title:"归档操作",buttonText:"确认"},(e=>async()=>{const{row:a,$index:l}=e,t=await A({id:a.id});j(t)&&te.list.splice(l,1)})(e))},pe=async()=>{a.value.map((e=>e.id));let e=oe.data.mode;e.toString(),e.toString(),e.toString()},ue=async()=>{te.loading=!0;let{query:e,params:a}=X(),{adseries:l}=e;l&&(ee.adv_series_id=Number(l));let t={page:te.pagination.listQuery.page,limit:te.pagination.listQuery.limit,...ee,...se};t[t.value_type]=t.value,delete t.value_type,delete t.value,t=F(t);const o=await D(t);if(o){const{data:e}=o;te.list=null==e?void 0:e.data,te.pagination.total=Number(e.count)}te.loading=!1};return o((()=>{(()=>{let e={limit:1e4,page:1};Promise.all([Y(),N(e),S(e),q()]).then((e=>{let a=e[0],l=e[1],t=e[2],o=e[3];te.options.country=a,te.options.advertiser=l.data.data,te.options.adv_series=t.data.data,te.options.adx=o.data.data}))})(),ie()})),(e,a)=>{const l=s("el-option"),t=s("el-select"),o=s("el-form-item"),V=s("el-input"),x=s("el-checkbox"),U=s("el-button"),F=s("el-form"),D=s("el-table-column"),S=s("el-switch"),q=s("el-table"),A=s("el-dialog"),N=i("loading");return f(),r("div",null,[d("div",O,[n(p(I),{onUp:re,arr:["adv","date"]}),n(F,{modelValue:p(te).searchForm,"onUpdate:modelValue":a[5]||(a[5]=e=>p(te).searchForm=e),inline:!0,class:"flex jc-between w100 ai-end"},{default:u((()=>[d("div",P,[n(o,{label:""},{default:u((()=>[n(t,{modelValue:p(te).searchForm.status,"onUpdate:modelValue":a[0]||(a[0]=e=>p(te).searchForm.status=e),filterable:"",clearable:"",placeholder:"全部状态"},{default:u((()=>[(f(!0),r(g,null,y(p(te).options.status,(e=>(f(),_(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(o,{label:""},{default:u((()=>[n(t,{modelValue:p(te).searchForm.adv_series_id,"onUpdate:modelValue":a[1]||(a[1]=e=>p(te).searchForm.adv_series_id=e),filterable:"",clearable:"",placeholder:"广告系列"},{default:u((()=>[(f(!0),r(g,null,y(p(te).options.adv_series,(e=>(f(),_(l,{key:e.id,label:e.adv_series_name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),n(o,{label:""},{default:u((()=>[n(V,{modelValue:p(te).searchForm.value,"onUpdate:modelValue":a[3]||(a[3]=e=>p(te).searchForm.value=e),placeholder:"请输入",class:"input-with-select"},{prepend:u((()=>[n(t,{modelValue:p(te).searchForm.value_type,"onUpdate:modelValue":a[2]||(a[2]=e=>p(te).searchForm.value_type=e),placeholder:"",class:"search-input-select",style:{width:"120px"}},{default:u((()=>[(f(!0),r(g,null,y(p(te).options.value_type,(e=>(f(),_(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1}),n(o,{label:""},{default:u((()=>[n(x,{modelValue:p(te).searchForm.is_del,"onUpdate:modelValue":a[4]||(a[4]=e=>p(te).searchForm.is_del=e),"true-label":"","false-label":"1",label:"包含已归档"},null,8,["modelValue"])])),_:1})]),d("div",$,[n(o,{class:"mr-0",style:{"margin-right":"0px"}},{default:u((()=>[d("div",L,[n(U,{type:"primary",onClick:ie},{default:u((()=>[h(" 查询 ")])),_:1}),c(' <el-button type="primary" @click="handleExportSearch">导出</el-button> ')])])),_:1})])])),_:1},8,["modelValue"]),d("div",R,[n(U,{type:"primary",onClick:de},{default:u((()=>[h("新建广告组")])),_:1}),n(t,{class:"ml-10",modelValue:p(oe).data.mode,"onUpdate:modelValue":a[6]||(a[6]=e=>p(oe).data.mode=e),filterable:"",placeholder:"批量操作",onChange:pe},{default:u((()=>[(f(!0),r(g,null,y(p(oe).options.mode,(e=>(f(),_(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])]),c(" table "),m((f(),_(q,{center:"",data:p(te).list,class:"w100",border:""},{default:u((()=>[n(D,{align:"center",type:"selection",width:"55"}),n(D,{sortable:"",prop:"id",label:"广告组ID",align:"center"}),n(D,{sortable:"",width:"120",prop:"adv_group_name",label:"广告组名称",align:"center"}),n(D,{sortable:"",prop:"status",label:"开关",align:"center"},{default:u((e=>[n(S,{modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-value":1,"inactive-value":2,onClick:a=>(async({row:e})=>{let a={id:e.id,status:e.status},l=await z(a);j(l)})(e)},null,8,["modelValue","onUpdate:modelValue","onClick"]),c(" <span>{{getOptionsValue(scope.row.status, state.options.status)}}</span> ")])),_:1}),n(D,{sortable:"",prop:"status",label:"状态",align:"center"},{default:u((e=>[d("span",null,w(p(C)(e.row.status,p(te).options.status)),1)])),_:1}),n(D,{sortable:"",prop:"ad",label:"广告",align:"center"},{default:u((e=>[c(" <span>{{scope.row.ad}}</span> "),d("span",{class:"color_primary cp",onClick:a=>(({row:e})=>{W({url:"/adcontrol/ad/list",query:{adseries:e.adv_series_id,adgroup:e.id,type:"list"}})})(e)},w(e.row.ad?e.row.ad.length:0),9,B)])),_:1}),n(D,{width:"200",label:"操作",align:"center"},{default:u((e=>[d("div",E,[n(U,{class:"cp",type:"primary",onClick:a=>(({row:e})=>{const{id:a}=e;W({url:`/adcontrol/adgroup/edit/${a}`,query:{type:"edit"}})})(e)},{default:u((()=>[h("编辑")])),_:2},1032,["onClick"]),n(U,{class:"cp",type:"primary"},{default:u((()=>[h("复制")])),_:1}),c(' <el-button\n              v-if="scope.row.is_del === 2"\n              class="cp"\n              type="default"\n              @click="editFn(scope)"\n            >查看</el-button> '),n(U,{class:"cp",type:"danger",onClick:a=>ne(e),disabled:2===e.row.is_del},{default:u((()=>[h("归档")])),_:2},1032,["onClick","disabled"])])])),_:1}),n(D,{sortable:"",width:"120",prop:"country",label:"国家",align:"center"},{default:u((e=>[d("span",null,w(e.row.country),1)])),_:1}),n(D,{sortable:"",width:"120",prop:"promotion_cycle",label:"推广周期",align:"center"},{default:u((e=>[c(" <span>{{getOptionsValue(scope.row.promotion_cycle, state.options.promotion_cycle)}}</span> "),d("span",null,w(e.row.promotion_cycle_st),1),h(" - "),d("span",null,w(e.row.promotion_cycle_et),1)])),_:1}),n(D,{sortable:"",width:"120",prop:"create_email",label:"创建人",align:"center"}),n(D,{sortable:"",width:"160",prop:"create_date",label:"创建时间",align:"center"}),n(D,{sortable:"",width:"160",prop:"update_date",label:"更新时间",align:"center"}),n(D,{sortable:"",width:"160",prop:"imp_number",label:"展示数",align:"center"})])),_:1},8,["data"])),[[N,p(te).loading]]),c(" 分页 "),d("div",K,[m(n(k,{page:p(te).pagination.listQuery.page,"onUpdate:page":a[7]||(a[7]=e=>p(te).pagination.listQuery.page=e),limit:p(te).pagination.listQuery.limit,"onUpdate:limit":a[8]||(a[8]=e=>p(te).pagination.listQuery.limit=e),total:p(te).pagination.total,"page-sizes":p(te).pagination.pageSizes,onPagination:ue},null,8,["page","limit","total","page-sizes"]),[[b,p(te).pagination.total]])]),c(" 复制 "),n(A,{modelValue:p(ae),"onUpdate:modelValue":a[10]||(a[10]=e=>v(ae)?ae.value=e:null),title:"Report Api",width:"90%"},{default:u((()=>[d("p",null,w(p(le).report_api),1),n(U,{class:"cp mr-10",type:"default",onClick:a[9]||(a[9]=e=>{return a=p(le).report_api,void Q(a);var a})},{default:u((()=>[h("复制")])),_:1})])),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-3d91c0cc"]]);export{G as default};
