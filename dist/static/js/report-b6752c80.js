import{_ as e,d as a,r as l,L as t,I as r,q as o,c as s,x as i,e as n,s as u,v as c,z as d,U as m,V as p,o as b,N as f,O as h,A as v,f as g,y}from"./main-0a777472.js";import{P as k}from"./index-2575c6ed.js";import{W as x}from"./index-6f2afb89.js";import{k as V}from"./overview-c0a031d4.js";import{g as C,a as w}from"./format-00f0450d.js";import"./moment-56f006b0.js";const _={class:"search-box"},D={class:"mb-10"},j={class:"flex jc-between ai-start"},U={class:"flex jc-start ai-start flex-wrap"},q={class:"mb-10"},Y={style:{"margin-left":"10px"}},Q={class:"w100 flex"};var z=e(a({__name:"report",setup(e){let a=l({shortcuts:[{text:"今天",value:C(0,"day")},{text:"昨天",value:()=>w(1,1,"day")},{text:"最近7天",value:()=>C(6,"day")}],clumon:{base:[{label:"Impression",value:"impression"},{label:"Click",value:"click"},{label:"CVR",value:"cvr"},{label:"Conversion",value:"conversion"},{label:"Revenue($)",value:"revenue"}],choice:[{label:"Date",value:"date",require:!0,width:"100"},{label:"Hour",value:"hour",require:!1},{label:"Country",value:"country",require:!1},{label:"Platform",value:"platform",require:!1},{label:"PKG",value:"pkg",require:!1},{label:"Offer",value:"offer",require:!1}]},search:{date:C(6,"day"),checkList:["date"],filter:{country:"",platform:"",pkg:"",offer:""}},options:{platform:[{value:"Android",label:"Android"},{value:"iOS",label:"iOS"}]},tableData:{all:[],arr:[]},exportExcel:{buttonName:"导出",tHeader:["日期"],filterVal:["date"],fileName:"test"},pagination:{pageSizes:["10","20","40","100"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}},handleClumon:[],busHandleClumon:[]});t((()=>{}));const z=r((()=>a.handleClumon.map((e=>e.label)))),L=r((()=>a.handleClumon.map((e=>e.value)))),P=async()=>{const e=a.search.checkList,l=H(e).map((e=>e.value)).join(",");let t={page:a.pagination.listQuery.page,page_size:a.pagination.listQuery.limit,st:a.search.date[0],et:a.search.date[1],...a.search.filter};l&&(t.dimension=l);const r=await V(t),{data:o}=r;a.tableData.arr=o.data,a.pagination.total=parseInt(o.count)},H=e=>{const l=[];return a.clumon.choice.map((a=>{e.includes(a.value)&&l.push(a)})),l},I=e=>{const l=H(e);a.busHandleClumon=[...l,...a.clumon.base]},N=()=>{a.handleClumon=a.busHandleClumon,P()};return I(a.search.checkList),N(),(e,l)=>{const t=o("el-checkbox"),r=o("el-checkbox-group"),V=o("el-date-picker"),C=o("el-input"),w=o("el-option"),H=o("el-select"),O=o("el-button"),M=o("el-table-column"),R=o("el-table");return b(),s("div",null,[i("div",_,[i("div",D,[n(r,{modelValue:c(a).search.checkList,"onUpdate:modelValue":l[0]||(l[0]=e=>c(a).search.checkList=e),onChange:I},{default:u((()=>[(b(!0),s(f,null,h(c(a).clumon.choice,(e=>(b(),v(t,{key:e.value,label:e.value,disabled:e.require},{default:u((()=>[g(y(e.label),1)])),_:2},1032,["label","disabled"])))),128))])),_:1},8,["modelValue"])]),i("div",j,[i("div",U,[n(V,{modelValue:c(a).search.date,"onUpdate:modelValue":l[1]||(l[1]=e=>c(a).search.date=e),class:"mr-10 mb-10",type:"daterange","unlink-panels":"",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",shortcuts:c(a).shortcuts},null,8,["modelValue","shortcuts"]),n(C,{modelValue:c(a).search.filter.country,"onUpdate:modelValue":l[2]||(l[2]=e=>c(a).search.filter.country=e),placeholder:"Country",class:"mr-10 mb-10 search-con"},null,8,["modelValue"]),n(H,{modelValue:c(a).search.filter.platform,"onUpdate:modelValue":l[3]||(l[3]=e=>c(a).search.filter.platform=e),clearable:"",filterable:"",placeholder:"Platform",class:"mr-10 search-con"},{default:u((()=>[(b(!0),s(f,null,h(c(a).options.platform,(e=>(b(),v(w,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),n(C,{modelValue:c(a).search.filter.pkg,"onUpdate:modelValue":l[4]||(l[4]=e=>c(a).search.filter.pkg=e),placeholder:"Pkg",class:"mr-10 mb-10 search-con"},null,8,["modelValue"]),n(C,{modelValue:c(a).search.filter.offer,"onUpdate:modelValue":l[5]||(l[5]=e=>c(a).search.filter.offer=e),placeholder:"Offer",class:"mr-10 mb-10 search-con"},null,8,["modelValue"])]),n(O,{type:"primary",onClick:N},{default:u((()=>[g(" Run ")])),_:1})])]),d(" all "),d(' <el-table :data="tableData.all" border style="width: 100%" class="mb-10">\n      <el-table-column prop="impression" label="Impression" />\n      <el-table-column prop="click" label="Click" />\n      <el-table-column prop="revenue" label="Revenue($)" />\n      <el-table-column prop="conversion" label="Conversion" />\n    </el-table> '),i("div",q,[n(x,{"button-name":c(a).exportExcel.buttonName,list:c(a).tableData.arr,"t-header":c(z),"filter-val":c(L),filename:c(a).exportExcel.fileName},null,8,["button-name","list","t-header","filter-val","filename"])]),d(" arr "),n(R,{data:c(a).tableData.arr,border:!0,style:{width:"100%"}},{default:u((()=>[(b(!0),s(f,null,h(c(a).handleClumon,(e=>(b(),v(M,{key:e.value,align:"center",sortable:"",prop:e.value,label:e.label,width:e.width},{default:u((a=>[d(' <i class="el-icon-time"></i> '),i("span",Y,y(a.row[e.value]),1)])),_:2},1032,["prop","label","width"])))),128))])),_:1},8,["data"]),i("div",Q,[m(n(c(k),{page:c(a).pagination.listQuery.page,"onUpdate:page":l[6]||(l[6]=e=>c(a).pagination.listQuery.page=e),limit:c(a).pagination.listQuery.limit,"onUpdate:limit":l[7]||(l[7]=e=>c(a).pagination.listQuery.limit=e),total:c(a).pagination.total,"page-sizes":c(a).pagination.pageSizes,onPagination:P},null,8,["page","limit","total","page-sizes"]),[[p,c(a).pagination.total]])])])}}}),[["__scopeId","data-v-66630144"]]);export{z as default};
