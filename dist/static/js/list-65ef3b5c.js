var ae=Object.defineProperty,te=Object.defineProperties;var le=Object.getOwnPropertyDescriptors;var j=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable;var z=(f,s,u)=>s in f?ae(f,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):f[s]=u,A=(f,s)=>{for(var u in s||(s={}))oe.call(s,u)&&z(f,u,s[u]);if(j)for(var u of j(s))ie.call(s,u)&&z(f,u,s[u]);return f},U=(f,s)=>te(f,le(s));import{d as S,aj as ne,z as O,C as re,af as se,r as v,ak as ce,k as w,v as m,i as h,x as l,h as r,j as o,N as B,c as D,O as de,o as y,F as N,l as E,y as V,t as P}from"./vendor-f1931894.js";import{P as ue}from"./index-7d282953.js";import{A as pe,_ as me,a as fe,b as _e,c as ve,d as be,e as he}from"./device-5be3e080.js";import{m as k}from"./message-c1123ca0.js";import{_ as ge}from"./lodash-43532635.js";import{o as $,a as ye}from"./new-format-e3b038cd.js";import{b as De}from"./format-b76f9697.js";import{_ as Ve}from"./index-482e3000.js";import"./moment-1cf83a0b.js";const ke={class:"controlBox w100 mb-10"},we={class:"mb-10"},xe=V("Offer Create"),Ce={class:"flex jc-start flex-wrap w100"},Fe={class:"flex"},je={class:"flex"},ze=V(" \u67E5\u8BE2 "),Ae={class:"flex jc-around"},Ue={class:"flex jc-around"},Se={class:"flex jc-between"},Oe=["textContent"],Be={class:"flex jc-around"},Ne={class:"w100 flex"},Ee={class:"dialog-footer"},Pe=V("\u786E \u5B9A"),$e=S({name:"old-buzz"}),Qe=S(U(A({},$e),{setup(f){const s=ne({attribute_provider:[],platform:[],package_name:"",channel:"",id:"",offer_title:"",country:"",pid:""}),u=()=>[...new Array(20)].map((t,n)=>{const p=n*5/100;return{value:p,label:`${(Number(p)*100).toFixed(0)}%`}}),Q=()=>[...new Array(20)].map((t,n)=>{const p=(n*5+5)/100;return{value:p,label:`${(Number(p)*100).toFixed(0)}%`}});let c=O({offer:{},index:null,cacheDevice:{},cacheDeviceCount:0}),e=O({dialogVisible:!1,dialogVisibleDevice:!1,cache:{item:{},device:{}},searchForm:s.value,useData:s.value,loading:!0,options:{cutoff_start:u(),cutoff_end:Q(),attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}],platform:[{value:"1",label:"Android"},{value:"2",label:"iOS"}]},list:[],pagination:{pageSizes:["20","50","100","500","1000"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}}});const x=()=>{e.useData=ge.cloneDeep(e.searchForm),C()},L=async i=>{let t={id:i.id,max_clk_num:parseFloat(i.max_clk_num)},n=await fe(t);k(n)},M=async i=>{let t={id:i.id,site_clk_limit:parseFloat(i.site_clk_limit)},n=await _e(t);k(n)},T=async i=>{let t={id:i.id,status:i.status};t=ye(t);const n=await ve(t);k(n)},I=i=>{let t=J(i);$(t)},G=()=>{$("/buzz/old-buzz-create")},J=i=>`/buzz/old-buzz-edit/${i.id}`,C=async()=>{e.loading=!0;let i={page:e.pagination.listQuery.page,page_size:e.pagination.listQuery.limit};e.useData.attribute_provider&&(i.attribute_provider=e.useData.attribute_provider),e.useData.platform&&(i.platform=e.useData.platform),e.useData.package_name&&(i.pkg_name=e.useData.package_name),e.useData.channel&&(i.channel=e.useData.channel),e.useData.id&&(i.offer_id=e.useData.id),e.useData.offer_title&&(i.title=e.useData.offer_title),e.useData.country&&(i.country=e.useData.country),e.useData.pid&&(i.tracking_link=e.useData.pid);const t=await pe(i),{data:n}=t,{page:p}=n;e.list=n==null?void 0:n.data,e.pagination.total=Number(p.count),e.loading=!1},K=async(i,t)=>{console.log("get device"),e.dialogVisibleDevice=!0,c.offer=t,c.index=i;const n={id:t.id,platform:t.platform,country:t.country},{data:p}=await be(n);c.cacheDevice.all=p.all,c.cacheDevice.select=JSON.parse(t.device)},R=i=>{c.cacheDevice.select=i},q=i=>{c.cacheDeviceCount=i},H=async()=>{const i={id:c.offer.id,device:JSON.stringify(c.cacheDevice.select)},t=await he(i);k(t),e.dialogVisibleDevice=!1,c.offer.device_count=c.cacheDeviceCount};return re(()=>{console.log("onMounted"),x()}),se(()=>{console.log("onActivated")}),(i,t)=>{const n=v("el-button"),p=v("el-option"),F=v("el-select"),b=v("el-form-item"),g=v("el-input"),W=v("el-form"),d=v("el-table-column"),X=v("el-switch"),Y=v("el-table"),Z=v("el-dialog"),ee=ce("loading");return y(),w("div",null,[m("div",ke,[m("div",we,[h(` <router-link to="/buzz/old-buzz-create">
          <el-button type="primary">
            Offer Create
          </el-button>
        </router-link> `),l(n,{type:"primary",onClick:G},{default:r(()=>[xe]),_:1})]),l(W,{modelValue:o(e).searchForm,"onUpdate:modelValue":t[8]||(t[8]=a=>o(e).searchForm=a),inline:!0,class:"flex jc-between w100 ai-end"},{default:r(()=>[m("div",Ce,[l(b,{label:""},{default:r(()=>[l(F,{modelValue:o(e).searchForm.attribute_provider,"onUpdate:modelValue":t[0]||(t[0]=a=>o(e).searchForm.attribute_provider=a),clearable:"",class:"search-con",placeholder:"Attribute Provider",style:{"min-width":"140px"}},{default:r(()=>[(y(!0),w(N,null,E(o(e).options.attribute_provider,a=>(y(),D(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(b,{label:""},{default:r(()=>[l(F,{modelValue:o(e).searchForm.platform,"onUpdate:modelValue":t[1]||(t[1]=a=>o(e).searchForm.platform=a),clearable:"",class:"search-con",placeholder:"Platform",style:{"min-width":"95px"}},{default:r(()=>[(y(!0),w(N,null,E(o(e).options.platform,a=>(y(),D(p,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(b,{label:""},{default:r(()=>[l(g,{modelValue:o(e).searchForm.package_name,"onUpdate:modelValue":t[2]||(t[2]=a=>o(e).searchForm.package_name=a),placeholder:"Package Name",class:"search-con",style:{"min-width":"120px"}},null,8,["modelValue"])]),_:1}),l(b,{label:""},{default:r(()=>[l(g,{modelValue:o(e).searchForm.channel,"onUpdate:modelValue":t[3]||(t[3]=a=>o(e).searchForm.channel=a),placeholder:"Channel",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])]),_:1}),l(b,{label:""},{default:r(()=>[l(g,{modelValue:o(e).searchForm.id,"onUpdate:modelValue":t[4]||(t[4]=a=>o(e).searchForm.id=a),placeholder:"ID",class:"search-con"},null,8,["modelValue"])]),_:1}),l(b,{label:""},{default:r(()=>[l(g,{modelValue:o(e).searchForm.offer_title,"onUpdate:modelValue":t[5]||(t[5]=a=>o(e).searchForm.offer_title=a),placeholder:"Offer Title",class:"search-con",style:{"min-width":"90px"}},null,8,["modelValue"])]),_:1}),l(b,{label:""},{default:r(()=>[l(g,{modelValue:o(e).searchForm.country,"onUpdate:modelValue":t[6]||(t[6]=a=>o(e).searchForm.country=a),placeholder:"Country",class:"search-con",style:{"min-width":"80px"}},null,8,["modelValue"])]),_:1}),l(b,{label:""},{default:r(()=>[l(g,{modelValue:o(e).searchForm.pid,"onUpdate:modelValue":t[7]||(t[7]=a=>o(e).searchForm.pid=a),placeholder:"Pid",class:"search-con"},null,8,["modelValue"])]),_:1})]),m("div",Fe,[l(b,{class:"mr-0",style:{"margin-right":"0px"}},{default:r(()=>[m("div",je,[l(n,{type:"primary",onClick:x},{default:r(()=>[ze]),_:1}),h(' <el-button type="primary" @click="handleExportSearch">\u5BFC\u51FA</el-button> ')])]),_:1})])]),_:1},8,["modelValue"]),h(` <el-input placeholder="\u8BF7\u8F93\u5165\u5185\u5BB9" v-model="data.searchForm.data" class='search-input'>
        <el-button slot="append" icon="Search" @click='searchFun'></el-button>
      </el-input> `)]),h(" table "),B((y(),D(Y,{center:"",data:o(e).list,class:"w100",height:"70vh",border:""},{default:r(()=>[l(d,{fixed:"",prop:"offer_id",label:"Offer ID",align:"center",width:"70"}),l(d,{fixed:"",prop:"channel",label:"Channel",align:"center",width:"60"}),l(d,{prop:"pkg_name",label:"Package Name",align:"center",width:"110"}),l(d,{prop:"title",label:"Offer Title",align:"center"}),l(d,{prop:"attribute_provider",label:"Attribute Provider",align:"center",width:"80"}),l(d,{prop:"pid",label:"Pid",align:"center",width:"90"}),l(d,{prop:"platform",label:"Platform",align:"center",width:"65"},{default:r(a=>[V(P(Number(a.row.platform)===1?"Android":"iOS"),1)]),_:1}),l(d,{prop:"country",label:"Country",align:"center",width:"57"}),l(d,{prop:"payout",label:"Payout",align:"center",width:"55"}),l(d,{label:"Click Limitation",width:"150",align:"center"},{default:r(a=>[m("div",Ae,[l(g,{modelValue:a.row.max_clk_num,"onUpdate:modelValue":_=>a.row.max_clk_num=_,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:_=>L(a.row)},null,8,["onClick"])])]),_:1}),l(d,{label:"Site Click Limitation",width:"150",align:"center"},{default:r(a=>[m("div",Ue,[l(g,{modelValue:a.row.site_clk_limit,"onUpdate:modelValue":_=>a.row.site_clk_limit=_,placeholder:""},null,8,["modelValue","onUpdate:modelValue"]),l(n,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:_=>M(a.row)},null,8,["onClick"])])]),_:1}),l(d,{label:"Select Device",width:"120",align:"center"},{default:r(a=>[m("div",Se,[m("span",{textContent:P(o(De)(a.row.device_count))},null,8,Oe),l(n,{class:"cp ml-10 scale-button",type:"primary",icon:"Edit",circle:"",onClick:_=>K(a.$index,a.row)},null,8,["onClick"])])]),_:1}),l(d,{label:"Operation",align:"center"},{default:r(a=>[m("div",Be,[h(` <router-link :to="getEditUrl(scope.row)">
              <el-button
                class="cp mr-10"
                type="primary"
                icon="Edit"
                circle
              ></el-button>
            </router-link> `),l(n,{class:"cp mr-10",type:"primary",icon:"Edit",circle:"",onClick:_=>I(a.row)},null,8,["onClick"]),l(X,{modelValue:a.row.status,"onUpdate:modelValue":_=>a.row.status=_,"active-value":1,"inactive-value":2,onChange:_=>T(a.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])]),_:1})]),_:1},8,["data"])),[[ee,o(e).loading]]),h(" \u5206\u9875 "),m("div",Ne,[B(l(o(ue),{page:o(e).pagination.listQuery.page,"onUpdate:page":t[9]||(t[9]=a=>o(e).pagination.listQuery.page=a),limit:o(e).pagination.listQuery.limit,"onUpdate:limit":t[10]||(t[10]=a=>o(e).pagination.listQuery.limit=a),total:o(e).pagination.total,"page-sizes":o(e).pagination.pageSizes,onPagination:C},null,8,["page","limit","total","page-sizes"]),[[de,o(e).pagination.total]])]),h(" device "),l(Z,{modelValue:o(e).dialogVisibleDevice,"onUpdate:modelValue":t[13]||(t[13]=a=>o(e).dialogVisibleDevice=a),title:"Device"},{default:r(()=>[o(e).dialogVisibleDevice?(y(),D(me,{key:0,all:o(c).cacheDevice.all,"onUpdate:all":t[11]||(t[11]=a=>o(c).cacheDevice.all=a),select:o(c).cacheDevice.select,"onUpdate:select":t[12]||(t[12]=a=>o(c).cacheDevice.select=a),onKk:R,onCount:q},null,8,["all","select"])):h("v-if",!0),m("span",Ee,[h(' <el-button @click="cancleDevice">\u53D6 \u6D88</el-button> '),l(n,{type:"primary",onClick:H},{default:r(()=>[Pe]),_:1})])]),_:1},8,["modelValue"])])}}}));var We=Ve(Qe,[["__scopeId","data-v-0b56db22"]]);export{We as default};
