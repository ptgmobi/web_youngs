import{d as e,o as l,c as a,x as r,y as o,h as t,r as s,L as m,q as d,z as i,e as u,s as n,v as f,P as c,f as p,g as _}from"./main-882d1fc9.js";import{b as v,c as y,d as b}from"./tool-37949571.js";import{m as g}from"./message-eacf81a6.js";import{u as F}from"./useUtils-62d4ff5d.js";import{d as w,e as V,f as x}from"./new-format-91f07c7f.js";import{_ as h}from"./lodash-be4a8a67.js";const j={class:"w100 flex jc-between p10-20"},U={class:"mr-10"},q=r("div",{class:"split-box"},null,-1),C=e({props:{title:{type:String,default:""}},setup(e){const t=e;return(e,s)=>(l(),a("div",j,[r("div",U,o(t.title),1),q]))}}),M={class:"content-con from-one flex column"},D={class:"content-con from-one flex column"},k={class:"w100 flex"},L=p(" 确认 "),S=p(" 取消 "),z=e({setup(e){const{getRouterData:o,getCommonCountryList:p,goNewUrl:j}=F();let{proxy:U}=_();const q="此项必填";let z=t("create");const I={id:"",ad_id:"",ad_name:"",desc:"",flow_rate:""},N=s({ruleForm:I,rules:{ad_name:[{required:!0,message:q,trigger:["blur","change"]}],flow_rate:[{required:!0,message:q,trigger:["blur","change"]}]},options:{}}),P=()=>{U.$refs.ruleForm.validate((e=>{if(!e)return!1;A()}))},R=["flow_rate"],$=[],A=async()=>{let e=c(N.ruleForm);if(e=w(e),e=V(e,R),"create"===z.value){delete e.id;const l=await v(e);g(l)&&B()}if("edit"===z.value){const l=await y(e);g(l)&&B()}},B=()=>{let e="";"create"===z.value&&(e="./list"),"edit"===z.value&&(e="../list"),j({url:e})},E=()=>{var e,l;let{query:a,params:r}=o();if(a.type,z.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",(async()=>{})(),"create"===z.value&&(N.ruleForm=h.cloneDeep(I)),"edit"===z.value){const{id:e}=r;(async e=>{const l=await b(e),{data:a}=l;N.ruleForm=x(a,$)})(e)}};return m((()=>{E()})),(e,o)=>{const t=d("el-input"),s=d("el-form-item"),m=d("el-form"),c=d("el-button");return l(),a("div",null,[i(" form "),u(m,{ref:"ruleForm",enctype:"multipart/form-data",rules:f(N).rules,model:f(N).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===f(z)&&2===f(N).ruleForm.is_del},{default:n((()=>[u(f(C),{title:"基本信息"}),r("div",M,[u(s,{class:"self-el-form-item",label:"广告主名称:",prop:"ad_name"},{default:n((()=>[u(t,{modelValue:f(N).ruleForm.ad_name,"onUpdate:modelValue":o[0]||(o[0]=e=>f(N).ruleForm.ad_name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(s,{class:"self-el-form-item",label:"广告主ID:",prop:"ad_id"},{default:n((()=>[u(t,{modelValue:f(N).ruleForm.ad_id,"onUpdate:modelValue":o[1]||(o[1]=e=>f(N).ruleForm.ad_id=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),u(s,{class:"self-el-form-item",label:"描述:",prop:"desc"},{default:n((()=>[u(t,{modelValue:f(N).ruleForm.desc,"onUpdate:modelValue":o[2]||(o[2]=e=>f(N).ruleForm.desc=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),u(f(C),{title:"广告主配置"}),r("div",D,[u(s,{class:"self-el-form-item",label:"强制流量占比(%):",prop:"flow_rate"},{default:n((()=>[u(t,{modelValue:f(N).ruleForm.flow_rate,"onUpdate:modelValue":o[3]||(o[3]=e=>f(N).ruleForm.flow_rate=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"number"},null,8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),i(" form "),i(" footer "),r("div",k,[u(c,{type:"primary",onClick:P},{default:n((()=>[L])),_:1}),u(c,{type:"primary",onClick:B},{default:n((()=>[S])),_:1})])])}}});export{z as default};
