var Y=Object.defineProperty;var T=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,W=Object.prototype.propertyIsEnumerable;var q=(r,e,o)=>e in r?Y(r,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):r[e]=o,A=(r,e)=>{for(var o in e||(e={}))B.call(e,o)&&q(r,o,e[o]);if(T)for(var o of T(e))W.call(e,o)&&q(r,o,e[o]);return r};import{r as u,o as c,i as b,g as n,v as s,f as m,x as V,t as w,F as y,d as O,y as z,B as I,b as L,s as p,h as t,P as M,Q as R,j as F,c as D}from"./vendor-a4cb0bb5.js";import{P as $}from"./index-aa508353.js";import{_ as S,a as J}from"./index-b990cc85.js";import{f as G}from"./overview-1f6d44f5.js";import{g as E,a as K}from"./format-b76f9697.js";import"./moment-1cf83a0b.js";const X={name:"WwExportExcel",props:{list:{type:Array,requrie:!0,default(){return[]}},tHeader:{type:Array,requrie:!0,default(){return[]}},filterVal:{type:Array,requrie:!0,default(){return[]}},filename:{type:String,requrie:!0,default:""},buttonName:{type:String,requrie:!1,default:"Export"},bookType:{type:String,requrie:!1,default:"xlsx"}},data(){return{searchForm:{options:{bookType:["xlsx","csv"],autoWidth:[!0,!1]},data:{filename:"",autoWidth:!0,bookType:"xlsx"},rules:{}},downloadLoading:!1}},created(){this.searchForm.data.bookType=this.bookType},methods:{handleDownload(){this.downloadLoading=!0,J(()=>import("./Export2Excel-66cc2d93.js"),["static/js/Export2Excel-66cc2d93.js","static/js/vendor-a4cb0bb5.js"]).then(r=>{const e=this.list,o=this.formatJson(this.filterVal,e);r.export_json_to_excel({header:this.tHeader,data:o,filename:this.filename,autoWidth:this.searchForm.data.autoWidth,bookType:this.searchForm.data.bookType}),this.downloadLoading=!1})},formatJson(r,e){return e.map(o=>r.map(h=>o[h]))}}};function Z(r,e,o,h,x,_){const v=u("el-button");return c(),b(y,null,[n(' <el-form :inline="true" :model="searchForm.data" class="flex jc-end"> '),n(' <div class="flex jc-start"> '),n(` <el-form-item label="\u5BFC\u51FA\u6587\u4EF6\u540D">
        <el-input v-model="searchForm.data.filename" placeholder="\u6587\u4EF6\u540D" />
      </el-form-item> `),n(` <el-form-item label="\u81EA\u52A8\u5BBD\u5EA6">
        <el-radio-group v-model="searchForm.data.autoWidth">
          <el-radio :label="true" border>
            True
          </el-radio>
          <el-radio :label="false" border>
            False
          </el-radio>
        </el-radio-group>
      </el-form-item> `),n(` <el-form-item label="\u5BFC\u51FA\u6587\u4EF6\u7C7B\u578B">
        <el-select v-model="searchForm.data.bookType" placeholder="\u6587\u4EF6\u7C7B\u578B">
          <el-option
            v-for="item in searchForm.options.bookType"
            :key="item"
            :label="item"
            :value="item"
          />
        </el-select>
      </el-form-item> `),n(" </div> "),n(` <el-form-item class="mr-0">
      <el-button @click="handleDownload">\u5BFC\u51FA</el-button>
    </el-form-item>
  </el-form> `),s(v,{icon:"Download",type:"primary",onClick:_.handleDownload},{default:m(()=>[V(w(o.buttonName),1)]),_:1},8,["onClick"])],2112)}var ee=S(X,[["render",Z]]);const ae={class:"search-box"},te={class:"mb-10"},le={class:"flex jc-between ai-start"},oe={class:"flex jc-start ai-start flex-wrap"},re=V("Run"),ne={class:"mb-10"},se={style:{"margin-left":"10px"}},ie={class:"w100 flex"},ue=O({setup(r){let e=z({shortcuts:[{text:"\u4ECA\u5929",value:E(0,"day")},{text:"\u6628\u5929",value:()=>K(1,1,"day")},{text:"\u6700\u8FD17\u5929",value:()=>E(6,"day")}],clumon:{base:[{label:"Impression",value:"impression"},{label:"Click",value:"click"},{label:"CVR",value:"cvr"},{label:"Conversion",value:"conversion"},{label:"Revenue($)",value:"revenue"}],choice:[{label:"Date",value:"date",require:!0,width:"100"},{label:"Hour",value:"hour",require:!1},{label:"Country",value:"country",require:!1},{label:"Platform",value:"platform",require:!1},{label:"PKG",value:"pkg",require:!1},{label:"Offer",value:"offer",require:!1}]},search:{date:E(6,"day"),checkList:["date"],filter:{country:"",platform:"",pkg:"",offer:""}},options:{platform:[{value:"Android",label:"Android"},{value:"iOS",label:"iOS"}]},tableData:{all:[],arr:[]},exportExcel:{buttonName:"\u5BFC\u51FA",tHeader:["\u65E5\u671F"],filterVal:["date"],fileName:"test"},pagination:{pageSizes:["10","20","40","100"],total:1,listQuery:{page:1,limit:20,importance:void 0,title:void 0,type:void 0,sort:"+id"}},handleClumon:[],busHandleClumon:[]});I(()=>{console.log("mounted")});const o=L(()=>e.handleClumon.map(i=>i.label)),h=L(()=>e.handleClumon.map(i=>i.value)),x=async()=>{const i=e.search.checkList,d=_(i).map(C=>C.value).join(",");let g=A({page:e.pagination.listQuery.page,page_size:e.pagination.listQuery.limit,st:e.search.date[0],et:e.search.date[1]},e.search.filter);d&&(g.dimension=d);const k=await G(g),{data:f}=k;e.tableData.arr=f.data,e.pagination.total=parseInt(f.count)},_=i=>{const l=[];return e.clumon.choice.map(d=>{i.includes(d.value)&&l.push(d)}),l},v=i=>{const l=_(i);e.busHandleClumon=[...l,...e.clumon.base]},j=()=>{e.handleClumon=e.busHandleClumon,x()};return v(e.search.checkList),j(),(i,l)=>{const d=u("el-checkbox"),g=u("el-checkbox-group"),k=u("el-date-picker"),f=u("el-input"),C=u("el-option"),N=u("el-select"),P=u("el-button"),H=u("el-table-column"),Q=u("el-table");return c(),b("div",null,[p("div",ae,[p("div",te,[s(g,{modelValue:t(e).search.checkList,"onUpdate:modelValue":l[0]||(l[0]=a=>t(e).search.checkList=a),onChange:v},{default:m(()=>[(c(!0),b(y,null,F(t(e).clumon.choice,a=>(c(),D(d,{key:a.value,label:a.value,disabled:a.require},{default:m(()=>[V(w(a.label),1)]),_:2},1032,["label","disabled"]))),128))]),_:1},8,["modelValue"])]),p("div",le,[p("div",oe,[s(k,{class:"mr-10 mb-10",modelValue:t(e).search.date,"onUpdate:modelValue":l[1]||(l[1]=a=>t(e).search.date=a),type:"daterange","unlink-panels":"",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD","range-separator":"\u81F3","start-placeholder":"\u5F00\u59CB\u65E5\u671F","end-placeholder":"\u7ED3\u675F\u65E5\u671F",shortcuts:t(e).shortcuts},null,8,["modelValue","shortcuts"]),s(f,{modelValue:t(e).search.filter.country,"onUpdate:modelValue":l[2]||(l[2]=a=>t(e).search.filter.country=a),placeholder:"Country",class:"mr-10 mb-10 search-con"},null,8,["modelValue"]),s(N,{modelValue:t(e).search.filter.platform,"onUpdate:modelValue":l[3]||(l[3]=a=>t(e).search.filter.platform=a),clearable:"",filterable:"",placeholder:"Platform",class:"mr-10 search-con"},{default:m(()=>[(c(!0),b(y,null,F(t(e).options.platform,a=>(c(),D(C,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),s(f,{modelValue:t(e).search.filter.pkg,"onUpdate:modelValue":l[4]||(l[4]=a=>t(e).search.filter.pkg=a),placeholder:"Pkg",class:"mr-10 mb-10 search-con"},null,8,["modelValue"]),s(f,{modelValue:t(e).search.filter.offer,"onUpdate:modelValue":l[5]||(l[5]=a=>t(e).search.filter.offer=a),placeholder:"Offer",class:"mr-10 mb-10 search-con"},null,8,["modelValue"])]),s(P,{type:"primary",onClick:j},{default:m(()=>[re]),_:1})])]),n(" all "),n(` <el-table :data="tableData.all" border style="width: 100%" class="mb-10">
      <el-table-column prop="impression" label="Impression" />
      <el-table-column prop="click" label="Click" />
      <el-table-column prop="revenue" label="Revenue($)" />
      <el-table-column prop="conversion" label="Conversion" />
    </el-table> `),p("div",ne,[s(ee,{"button-name":t(e).exportExcel.buttonName,list:t(e).tableData.arr,"t-header":t(o),"filter-val":t(h),filename:t(e).exportExcel.fileName},null,8,["button-name","list","t-header","filter-val","filename"])]),n(" arr "),s(Q,{data:t(e).tableData.arr,border:!0,style:{width:"100%"}},{default:m(()=>[(c(!0),b(y,null,F(t(e).handleClumon,a=>(c(),D(H,{align:"center",sortable:"",key:a.value,prop:a.value,label:a.label,width:a.width},{default:m(U=>[n(' <i class="el-icon-time"></i> '),p("span",se,w(U.row[a.value]),1)]),_:2},1032,["prop","label","width"]))),128))]),_:1},8,["data"]),p("div",ie,[M(s(t($),{total:t(e).pagination.total,"page-sizes":t(e).pagination.pageSizes,page:t(e).pagination.listQuery.page,"onUpdate:page":l[6]||(l[6]=a=>t(e).pagination.listQuery.page=a),limit:t(e).pagination.listQuery.limit,"onUpdate:limit":l[7]||(l[7]=a=>t(e).pagination.listQuery.limit=a),onPagination:x},null,8,["total","page-sizes","page","limit"]),[[R,t(e).pagination.total]])])])}}});var _e=S(ue,[["__scopeId","data-v-66630144"]]);export{_e as default};
