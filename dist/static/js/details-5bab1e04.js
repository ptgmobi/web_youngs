var e=Object.defineProperty,l=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,r=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,t=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&r(e,s,t[s]);if(l)for(var s of l(t))o.call(t,s)&&r(e,s,t[s]);return e};import{_ as s,d as u,h as d,r as m,L as i,q as n,o as p,c,z as f,e as v,s as y,v as _,x as b,P as F,N as g,O as V,A as j,f as h,y as w,g as x}from"./main-c289050e.js";import{s as U}from"./setting-3cff26af.js";import{b as O,c as k,d as P}from"./dsp-audience-manage-aac46848.js";import{A as C}from"./dsp-advertiser-d95bf0ce.js";import{m as q}from"./message-7c571a95.js";import{_ as M}from"./index-0855a96e.js";import{u as A}from"./useUtils-034ffd86.js";import{d as D,e as I,i as L}from"./new-format-0cb28217.js";import{_ as N}from"./lodash-6a3426b2.js";const S={class:"content-con from-one flex column"},z={class:"content-con from-one flex column"},E={class:"w100 flex"},R=h(" 确认 "),$=h(" 取消 ");var B=s(u({setup(e){const{adv_type:l,audience_manage_type:a}=U,{getRouterData:o,getCommonCountryList:r,goNewUrl:s}=A();let{proxy:u}=x();d(""),d(""),d(!1);let B=d("create");d([]),d([]),d([]),d([]);const G={id:void 0,name:"",adv_id:"",descs:"",adv_type:void 0,country:[],type:1,build_status:void 0,num_people:void 0,is_del:void 0},H=m({ruleForm:G,rules:{name:[{required:!0,message:"此项必填",trigger:["blur","change"]}]},options:{country:[{value:"",label:"",id:""}],advertiser:[{adv_id:"",name:""}],adv_type:l,audience_manage_type:a}}),J=()=>{u.$refs.ruleForm.validate((e=>{if(!e)return!1;T()}))},K=["id","adv_type","type","build_status","num_people"],Q=["country"],T=async()=>{let e=F(H.ruleForm);if(e=D(e),e=I(e,K),e=L(e,Q),B.value,"create"===B.value){delete e.id;const l=await O(e);q(l)&&W()}if("edit"===B.value){const l=await k(e);q(l)&&W()}},W=()=>{s({url:"/audienceManage/list"})},X=()=>{var e,l;let{query:a,params:s}=o();if(B.value=null!=(l=null==(e=a.type)?void 0:e.toString())?l:"",B.value,(async()=>{Promise.all([r(),C({limit:1e4,page:1})]).then((e=>{let l=e[0];H.options.country=l;let a=e[1];H.options.advertiser=a.data.data}))})(),"create"===B.value&&(H.ruleForm=N.cloneDeep(G)),"edit"===B.value){const{id:e}=s;(async(e,l)=>{const a=await P(e),{data:o}=a;o.country=o.country?o.country.split(","):[],H.ruleForm=t(t({},H.ruleForm),o),H.ruleForm})(e)}};return i((()=>{X()})),(e,l)=>{const a=n("el-input"),o=n("el-form-item"),r=n("el-option"),t=n("el-select"),s=n("el-radio"),u=n("el-radio-group"),d=n("el-form"),m=n("el-button");return p(),c("div",null,[f(" form "),v(d,{ref:"ruleForm",enctype:"multipart/form-data",rules:_(H).rules,model:_(H).ruleForm,"label-width":"150px","label-position":"right",class:"flex column",disabled:"edit"===_(B)&&2===_(H).ruleForm.is_del},{default:y((()=>[v(_(M),{title:"基础信息"}),b("div",S,[f(" 受众包名称 "),v(o,{class:"self-el-form-item",label:"受众包名称:",prop:"name"},{default:y((()=>[v(a,{modelValue:_(H).ruleForm.name,"onUpdate:modelValue":l[0]||(l[0]=e=>_(H).ruleForm.name=e),modelModifiers:{trim:!0},class:"form-one",placeholder:""},null,8,["modelValue"])])),_:1}),f(" 所属广告主 "),v(o,{class:"self-el-form-item",label:"广告主名称:",prop:"adv_name"},{default:y((()=>[v(t,{modelValue:_(H).ruleForm.adv_id,"onUpdate:modelValue":l[1]||(l[1]=e=>_(H).ruleForm.adv_id=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:y((()=>[(p(!0),c(g,null,V(_(H).options.advertiser,(e=>(p(),j(r,{key:e.adv_id,label:e.name,value:e.adv_id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" 描述 "),v(o,{class:"self-el-form-item",label:"描述:",prop:"descs"},{default:y((()=>[v(a,{modelValue:_(H).ruleForm.descs,"onUpdate:modelValue":l[2]||(l[2]=e=>_(H).ruleForm.descs=e),modelModifiers:{trim:!0},class:"form-one",placeholder:"",type:"textarea"},null,8,["modelValue"])])),_:1})]),v(_(M),{title:"数据源"}),b("div",z,[f(" 广告主类型 "),v(o,{class:"self-el-form-item",label:"广告主名称:",prop:"adv_type"},{default:y((()=>[v(t,{modelValue:_(H).ruleForm.adv_type,"onUpdate:modelValue":l[3]||(l[3]=e=>_(H).ruleForm.adv_type=e),filterable:"",placeholder:"请选择",class:"form-one"},{default:y((()=>[(p(!0),c(g,null,V(_(H).options.adv_type,(e=>(p(),j(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" 国家 "),v(o,{label:"受众所在国家/地区",prop:"country",class:"self-el-form-item"},{default:y((()=>[v(t,{modelValue:_(H).ruleForm.country,"onUpdate:modelValue":l[4]||(l[4]=e=>_(H).ruleForm.country=e),filterable:"",clearable:"",placeholder:"",multiple:"",class:"form-one"},{default:y((()=>[(p(!0),c(g,null,V(_(H).options.country,(e=>(p(),j(r,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),f(" 受众包类型 "),v(o,{class:"self-el-form-item",label:"受众包类型:",prop:"type"},{default:y((()=>[v(u,{class:"form-one",modelValue:_(H).ruleForm.type,"onUpdate:modelValue":l[5]||(l[5]=e=>_(H).ruleForm.type=e)},{default:y((()=>[(p(!0),c(g,null,V(_(H).options.audience_manage_type,(e=>(p(),j(s,{label:e.value},{default:y((()=>[h(w(e.label),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])])),_:1})])])),_:1},8,["rules","model","disabled"]),f(" form "),f(" footer "),b("div",E,[v(m,{type:"primary",onClick:J},{default:y((()=>[R])),_:1}),v(m,{type:"primary",onClick:W},{default:y((()=>[$])),_:1})])])}}}),[["__scopeId","data-v-17f66465"]]);export{B as default};
