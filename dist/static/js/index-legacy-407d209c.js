!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function t(t){for(var a=1;a<arguments.length;a++){var i=null!=arguments[a]?arguments[a]:{};a%2?e(Object(i),!0).forEach((function(e){n(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):e(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw o}}}}function i(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||r(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function l(e,t,n,a,i,r,o){try{var l=e[r](o),c=l.value}catch(u){return void n(u)}l.done?t(c):Promise.resolve(c).then(a,i)}function c(e){return function(){var t=this,n=arguments;return new Promise((function(a,i){var r=e.apply(t,n);function o(e){l(r,a,i,o,c,"next",e)}function c(e){l(r,a,i,o,c,"throw",e)}o(void 0)}))}}System.register(["./vendor-legacy-b450b3b1.js","./power-legacy-eb443cab.js","./format-legacy-80917348.js","./lodash-legacy-fefaf296.js","./index-legacy-a4b15707.js","./message-legacy-eb3b59c2.js","./self-legacy-42b17d60.js","./moment-legacy-905ec324.js"],(function(e){"use strict";var n,r,o,l,u,d,s,f,h,p,m,g,b,D,y,v,A,w,C,k;return{setters:[function(e){n=e.K,r=e.r,o=e.o,l=e.c,u=e.h,d=e.x,s=e.v,f=e.k,h=e.i,p=e.y,m=e.t},function(e){g=e.g,b=e.a,D=e.s,y=e.b},function(e){v=e.h},function(e){A=e._},function(e){w=e._},function(e){C=e.m},function(e){k=e.m},function(){}],execute:function(){var j={props:{title:{default:"title",type:String},data:{default:function(){return[]},type:Array},item:{default:function(){return{}},type:Object},choice:{default:function(){return[]},type:Array},name:{default:"name",type:String},date:{default:0,type:Number}},data:function(){return{filterApiText:"",list:[],choiceArr:[],checkStrictly:!1,defaultProps:{children:"children",label:"label"}}},computed:{handleTree:function(){return v(this.list)},handleRef:function(){return"tree".concat(this.name)}},watch:{date:function(){this.init()},choice:{immediate:!0,handler:function(e,t){var n=this;this.$nextTick((function(){n.$refs[n.handleRef].setCheckedKeys([]),e&&e.forEach((function(e){var t=n.$refs[n.handleRef].getNode(e);t&&t.isLeaf&&n.$refs[n.handleRef].setChecked(t,!0)}))}))}},filterApiText:function(e){this.$refs[this.handleRef]&&this.$refs[this.handleRef].filter(e)}},created:function(){this.list=A.cloneDeep(this.data)},methods:{init:function(){var e=this;return c(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.filterApiText="";case 1:case"end":return t.stop()}}),t)})))()},changeOneFn:function(e,t){var n=[].concat(i(this.$refs[this.handleRef].getCheckedKeys()),i(this.$refs[this.handleRef].getHalfCheckedKeys()));this.$emit("changeChoiceData",this.name,n)},filterApiNode:function(e,t){return!e||t[this.defaultProps.label].includes(e)},checkApiTree:function(e,t,n){var a=this.handleChoiceApiDataPermissionID,i=this.dialogData.treeData.choiceApiData.find((function(t){return t.permission_id===e.id})),r=null==i?void 0:i.id;t?(this.dialogData.treeData.choiceApiDataAdd.includes(e.id)||a.includes(e.id)||this.dialogData.treeData.choiceApiDataAdd.push(e.id),this.dialogData.treeData.choiceApiDataAdd.includes(r)&&(this.dialogData.treeData.choiceApiDataDel=this.dialogData.treeData.choiceApiDataDel.filter((function(e){return e!==r})))):(this.dialogData.treeData.choiceApiDataDel.includes(r)||i&&this.dialogData.treeData.choiceApiDataDel.push(r),this.dialogData.treeData.choiceApiDataAdd.includes(e.id)&&(this.dialogData.treeData.choiceApiDataAdd=this.dialogData.treeData.choiceApiDataAdd.filter((function(t){return t!==e.id}))))},generateRoutes:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=[],o=a(e);try{for(o.s();!(t=o.n()).done;){var l=t.value.route;if(!l.hidden){var c=this.onlyOneShowingChild(l.children,l);l.children&&c&&!l.alwaysShow&&(l=c);var u={path:n.resolve(i,l.path),title:l.title,name:l.name};l.children&&(u.children=this.generateRoutes(l.children,u.path)),r.push(u)}}}catch(d){o.e(d)}finally{o.f()}return r},generateArr:function(e){var t=this,n=[];return e.forEach((function(e){if(n.push(e),e.children){var a=t.generateArr(e.children);a.length>0&&(n=[].concat(i(n),i(a)))}})),n},generateTree:function(e){var t,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",r=arguments.length>2?arguments[2]:void 0,o=[],l=a(e);try{for(l.s();!(t=l.n()).done;){var c=t.value,u=n.resolve(i,c.path);c.children&&(c.children=this.generateTree(c.children,u,r)),(r.includes(u)||c.children&&c.children.length>=1)&&o.push(c)}}catch(d){l.e(d)}finally{l.f()}return o},onlyOneShowingChild:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1?arguments[1]:void 0,i=null,r=e.filter((function(e){return!e.hidden}));return 1===r.length?((i=r[0]).path=n.resolve(a.path,i.path),i):0===r.length&&(i=t(t({},a),{},{path:"",noShowingChildren:!0}))}}},x={class:""};var O={element:[],menu:[],operation:[],permission:[]},T={components:{RoleTree:w(j,[["render",function(e,t,n,a,i,c){var f=r("el-input"),h=r("el-tree"),p=r("el-form-item"),m=r("el-form");return o(),l(m,{"label-width":"150px","label-position":"top"},{default:u((function(){return[d(p,{label:n.title},{default:u((function(){return[s("div",x,[d(f,{modelValue:i.filterApiText,"onUpdate:modelValue":t[0]||(t[0]=function(e){return i.filterApiText=e}),class:"w100",placeholder:"输入关键字进行过滤"},null,8,["modelValue"]),d(h,{ref:c.handleRef,data:c.handleTree,props:i.defaultProps,"show-checkbox":"","node-key":"id",class:"permission-tree","default-checked-keys":i.choiceArr,"filter-node-method":c.filterApiNode,"default-expand-all":!0,onCheck:c.changeOneFn},null,8,["data","props","default-checked-keys","filter-node-method","onCheck"])])]})),_:1},8,["label"])]})),_:1})}]])},mixins:[k],data:function(){return{date:"",list:[],data:{},dialogVisible:!1,dialogType:"",busData:{item:{type:""},choiceData:{menu:[],element:[],operation:[]}}}},created:function(){this.getList()},methods:{getList:function(){var e=this;return c(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g();case 2:n=t.sent,a=n.data,e.data=a,e.list=a.permission;case 6:case"end":return t.stop()}}),t)})))()},clearBusData:function(){this.busData.choiceData=A.cloneDeep(O)},handleCreate:function(){this.dialogType="new",this.busData.item.type="",this.clearBusData(),this.dialogVisible=!0;var e=new Date;this.date=e.getTime()},handleEdit:function(e){var t=this;return c(regeneratorRuntime.mark((function n(){var a,i,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.dialogType="edit",t.busData.item=e.row,n.next=4,b(t.busData.item.id);case 4:a=n.sent,i=a.data,t.busData.choiceData=i,t.dialogVisible=!0,r=new Date,t.date=r.getTime();case 10:case"end":return n.stop()}}),n)})))()},handleDelete:function(e){},roleChangeChoice:function(e,t){this.busData.choiceData[e]=t},submitFn:function(){var e=this;return c(regeneratorRuntime.mark((function t(){var n,a,i,r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("new"!==e.dialogType){t.next=7;break}return n={type:e.busData.item.type,menu_id:e.busData.choiceData.menu,element_id:e.busData.choiceData.element,operation_id:e.busData.choiceData.operation},t.next=4,D(n);case 4:(a=t.sent)&&C(a),e.getList();case 7:if("edit"!==e.dialogType){t.next=13;break}return i={permission_id:e.busData.item.id,menu_id:e.busData.choiceData.menu,element_id:e.busData.choiceData.element,operation_id:e.busData.choiceData.operation},t.next=11,y(e.busData.item.id,i);case 11:(r=t.sent)&&C(r);case 13:e.dialogVisible=!1;case 14:case"end":return t.stop()}}),t)})))()}}},_={class:"app-container"},R=p(" 新建 "),P=p(" 修改 "),V=p(" 删除 "),S={class:"flex jc-between ai-start"},E={slot:"footer",class:"dialog-footer"},$=p(" 取 消 "),I=p(" 确 定 ");e("default",w(T,[["render",function(e,t,n,a,i,c){var g=r("el-button"),b=r("el-table-column"),D=r("el-table"),y=r("el-input"),v=r("el-form-item"),A=r("el-form"),w=r("role-tree"),C=r("el-dialog");return o(),f("div",_,[e.judgePermissionElementFn("A-AP-ADD-V")?(o(),l(g,{key:0,type:"primary",onClick:c.handleCreate},{default:u((function(){return[R]})),_:1},8,["onClick"])):h("v-if",!0),d(D,{data:i.list,style:{width:"100%","margin-top":"30px"},border:""},{default:u((function(){return[d(b,{align:"center",label:"ID"},{default:u((function(e){return[p(m(e.row.id),1)]})),_:1}),d(b,{align:"center",label:"Type"},{default:u((function(e){return[p(m(e.row.type),1)]})),_:1}),d(b,{align:"center",label:"Operations"},{default:u((function(t){return[e.judgePermissionElementFn("A-AP-EDIT-V")?(o(),l(g,{key:0,type:"primary",size:"small",onClick:function(e){return c.handleEdit(t)}},{default:u((function(){return[P]})),_:2},1032,["onClick"])):h("v-if",!0),e.judgePermissionElementFn("A-AP-DEL-V")?(o(),l(g,{key:1,type:"danger",size:"small",onClick:function(e){return c.handleDelete(t)}},{default:u((function(){return[V]})),_:2},1032,["onClick"])):h("v-if",!0)]})),_:1})]})),_:1},8,["data"]),d(C,{modelValue:i.dialogVisible,"onUpdate:modelValue":t[2]||(t[2]=function(e){return i.dialogVisible=e}),title:"edit"===i.dialogType?"Edit Role":"New Role",width:"90%"},{default:u((function(){return[d(A,{"label-width":"150px","label-position":"left"},{default:u((function(){return[d(v,{label:"Name"},{default:u((function(){return[d(y,{modelValue:i.busData.item.type,"onUpdate:modelValue":t[0]||(t[0]=function(e){return i.busData.item.type=e}),placeholder:"Role Name",disabled:"edit"===i.dialogType},null,8,["modelValue","disabled"])]})),_:1})]})),_:1}),s("div",S,[d(w,{ref:"roleroute",item:i.busData.item,data:i.data.menu,date:i.date,choice:i.busData.choiceData.menu,title:"路由权限",name:"menu",class:"col-auto-8 m0-10",onChangeChoiceData:c.roleChangeChoice},null,8,["item","data","date","choice","onChangeChoiceData"]),d(w,{ref:"rolebutton",item:i.busData.item,data:i.data.element,date:i.date,choice:i.busData.choiceData.element,title:"按钮权限",name:"element",class:"col-auto-8 m0-10",onChangeChoiceData:c.roleChangeChoice},null,8,["item","data","date","choice","onChangeChoiceData"]),d(w,{ref:"roleapi",item:i.busData.item,data:i.data.operation,date:i.date,choice:i.busData.choiceData.operation,title:"API权限",name:"operation",class:"col-auto-8 m0-10",onChangeChoiceData:c.roleChangeChoice},null,8,["item","data","date","choice","onChangeChoiceData"])]),s("div",E,[d(g,{onClick:t[1]||(t[1]=function(e){return i.dialogVisible=!1})},{default:u((function(){return[$]})),_:1}),d(g,{type:"primary",onClick:c.submitFn},{default:u((function(){return[I]})),_:1},8,["onClick"])])]})),_:1},8,["modelValue","title"])])}]]))}}}))}();
