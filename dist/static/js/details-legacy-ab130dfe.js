!function(){function e(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function r(r){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?e(Object(l),!0).forEach((function(e){t(r,e,l[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(l)):e(Object(l)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(l,e))}))}return r}function t(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function n(e,r,t,n,l,a,u){try{var o=e[a](u),i=o.value}catch(c){return void t(c)}o.done?r(i):Promise.resolve(i).then(n,l)}function l(e){return function(){var r=this,t=arguments;return new Promise((function(l,a){var u=e.apply(r,t);function o(e){n(u,l,a,o,i,"next",e)}function i(e){n(u,l,a,o,i,"throw",e)}o(void 0)}))}}var a=document.createElement("style");a.innerHTML=".search-con[data-v-661f6240]{width:200px}.siteValue[data-v-2659fc52]{height:auto}\n",document.head.appendChild(a),System.register(["./vendor-legacy-9b72e15f.js","./lodash-legacy-08b68016.js","./fenix-legacy-2c8900b9.js","./clipboard-legacy-72f0dd2d.js","./message-legacy-29e0e2d2.js","./new-format-legacy-0800fe3a.js","./index-legacy-29193966.js"],(function(e){"use strict";var t,n,a,u,o,i,c,s,f,d,p,m,_,v,g,b,y,h,F,w,k,V,x,j,U,C,P,q,O,S,R,A,D,T,E,N,L,z,M,I,K,$,B,J,Z;return{setters:[function(e){t=e.d,n=e.z,a=e.w,u=e.C,o=e.r,i=e.o,c=e.k,s=e.v,f=e.x,d=e.h,p=e.F,m=e.l,_=e.c,v=e.j,g=e.i,b=e.y,y=e.a,h=e.b,F=e.aj,w=e.t,k=e.ac,V=e.q,x=e.s,j=e.m,U=e.f,C=e.ae,P=e.ai,q=e.N,O=e.J,S=e.R},function(e){R=e._},function(e){A=e.l,D=e.p,T=e.q,E=e.r,N=e.s,L=e.t,z=e.u,M=e.v,I=e.w},function(e){K=e.c},function(e){$=e.m},function(e){B=e.b,J=e.r},function(e){Z=e._}],execute:function(){var H={class:"flex jc-end"},G=b(" Add "),Q={class:"flex"},W=b(" Copy "),X=t({props:{list:{require:!0,default:function(){return[]},type:Array},offer:{require:!0,default:"",type:String}},emits:["kk","up"],setup:function(e,r){r.emit;var t=e,b=n({pub:[{id:"",pub_name:""}]}),y={55527824:.1,95108831:.1,95846929:.005,59845210:.005},h=n({manage_traffic:[]}),F={pub:"",slotid:"",payout:void 0,cap_daily:void 0,pub_status:1,pub_tracking_link:""},w=function(){h.manage_traffic.push(R.cloneDeep(F))},k=function(){var e=l(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,A();case 3:r=e.sent,t=r.data,b.pub=t;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return a((function(){return t.list}),(function(e,r){h.manage_traffic=e}),{immediate:!0,deep:!0}),a((function(){return h.manage_traffic}),(function(e,r){}),{immediate:!0,deep:!0}),u((function(){k(),w()})),function(e,r){var n=o("el-button"),l=o("el-option"),a=o("el-select"),u=o("el-table-column"),F=o("el-input"),k=o("el-switch"),V=o("el-table");return i(),c("div",null,[s("div",H,[f(n,{type:"primary",onClick:w},{default:d((function(){return[G]})),_:1})]),f(V,{class:"mt-10",data:v(h).manage_traffic,style:{width:"100%"},border:""},{default:d((function(){return[f(u,{label:"Pub Name",align:"center"},{default:d((function(e){return[f(a,{modelValue:e.row.pub,"onUpdate:modelValue":function(r){return e.row.pub=r},filterable:"",clearable:"",placeholder:"",onChange:function(r){return function(e){var r=e.row,n="http://track.adsforward.com/api/track?offer={offer}&mid={slot}&pub_id={siteid}&gaid={gaid}&idfa={idfa}&click_id={clickid}&ip={ip}&ua={ua}&osv={osv}&lang={lang}";r.pub_tracking_link=n;var l=b.pub.find((function(e){return e.pub_name===r.pub}));r.slotid=l.slot_id,r.pub_status=l.status,r.pub_tracking_link=n.replace("{offer}",t.offer).replace("{slot}",l.slot_id),y[l.slot_id]&&(r.payout=y[l.slot_id])}(e)}},{default:d((function(){return[(i(!0),c(p,null,m(v(b).pub,(function(e){var r;return i(),_(l,{key:e.id,label:e.pub_name,value:null!==(r=e.pub_name)&&void 0!==r?r:e.id},null,8,["label","value"])})),128))]})),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]})),_:1}),f(u,{label:"Payout",align:"center"},{default:d((function(e){return[f(F,{modelValue:e.row.payout,"onUpdate:modelValue":function(r){return e.row.payout=r},type:"number",min:"0",step:"0.001",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),f(u,{label:"Cap Daily",align:"center"},{default:d((function(e){return[f(F,{modelValue:e.row.cap_daily,"onUpdate:modelValue":function(r){return e.row.cap_daily=r},type:"number",min:"0",step:"0.001",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue","onUpdate:modelValue"])]})),_:1}),f(u,{label:"Operation",align:"center",width:"180px"},{default:d((function(e){return[s("div",Q,[f(n,{class:"mr-10",type:"danger",icon:"Delete",circle:"",onClick:function(r){return t=e.$index,void h.manage_traffic.splice(t,1);var t}},null,8,["onClick"]),f(k,{modelValue:e.row.pub_status,"onUpdate:modelValue":function(r){return e.row.pub_status=r},"active-value":1,"inactive-value":2,class:"mr-10",onChange:function(r){e.row}},null,8,["modelValue","onUpdate:modelValue","onChange"]),e.row.pub_tracking_link?(i(),_(n,{key:0,class:"cp",type:"primary",onClick:function(r){return t=e.row.pub_tracking_link,void K(t);var t}},{default:d((function(){return[W]})),_:2},1032,["onClick"])):g("v-if",!0)])]})),_:1})]})),_:1},8,["data"])])}}}),Y={class:"w100"},ee={class:"content-con flex column"},re={class:"flex jc-start ai-center form-one"},te={class:"w100 flex mt-10"},ne=b("Save"),le=t({emits:["update:visible","uploadData"],setup:function(e,r){var t=r.emit,l=y(),a=/^[0-9a-z]{8,8}$/,u=h((function(){return B(p.ruleForm.site_list,1,a).data})),p=n({ruleForm:{site_list:""},rules:{site_list:[{required:!0,message:"必填项",trigger:["blur"]},{validator:function(e,r,t){""!==r?t(B(r,1,a).type?void 0:new Error("格式错误！")):t(new Error("必填项"))},trigger:["blur"]}]}}),m=function(){t("uploadData",u.value),p.ruleForm.site_list="",t("update:visible",!1)};return function(e,r){var t=o("el-input"),n=o("el-form-item"),a=o("el-form"),u=o("el-button");return i(),c("div",Y,[f(a,{ref_key:"ruleFormRef",ref:l,enctype:"multipart/form-data",rules:v(p).rules,model:v(p).ruleForm,"label-width":"140px","label-position":"right"},{default:d((function(){return[s("div",ee,[g(" Offer "),f(n,{label:"Site:",prop:"site_list"},{default:d((function(){return[s("div",re,[f(t,{modelValue:v(p).ruleForm.site_list,"onUpdate:modelValue":r[0]||(r[0]=function(e){return v(p).ruleForm.site_list=e}),rows:4,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" end ")])]})),_:1},8,["rules","model"]),s("div",te,[f(u,{type:"primary",onClick:r[1]||(r[1]=function(e){var r;(r=l.value)&&r.validate((function(e){if(!e)return!1;m()}))})},{default:d((function(){return[ne]})),_:1})])])}}}),ae={class:"w100"},ue=function(e){return V("data-v-661f6240"),e=e(),x(),e}((function(){return s("div",{class:"mb-10"},null,-1)})),oe={class:"control-box flex jc-between ai-start w100"},ie=b("增量生成"),ce=b("批量上传"),se=b("清空"),fe={class:"body-box mt-10"},de={class:"flex"},pe=t({props:{msg:{require:!0,default:function(){return""},type:String}},emits:["update:msg"],setup:function(e,r){var t,l=r.emit,a=e,u=y(!1),p=n({ruleForm:{site_num:0,site_value:(t=a.msg,t?t.split(","):[])},rules:{}}),m=h((function(){return p.ruleForm.site_value}));h((function(){return p.ruleForm.site_value.length}));var _=function(){if(p.ruleForm.site_num>0)for(var e=Math.floor(p.ruleForm.site_num),r=0;r<e;r++){var t=J(8);p.ruleForm.site_value.push(t)}p.ruleForm.site_num=0},b=function(){u.value=!0},V=function(){p.ruleForm.site_value=[]},x=function(e){e.map((function(e){p.ruleForm.site_value.push(e[0])}))};return F((function(){var e=p.ruleForm.site_value.join(",");l("update:msg",e)})),function(e,r){var t=o("el-button"),n=o("el-input"),l=o("el-table-column"),a=o("el-table"),y=o("el-dialog");return i(),c("div",ae,[ue,g(" 操作 "),s("div",oe,[f(n,{modelValue:v(p).ruleForm.site_num,"onUpdate:modelValue":r[0]||(r[0]=function(e){return v(p).ruleForm.site_num=e}),placeholder:"Please input",type:"number",max:"1000",class:"input-with-select search-con"},{append:d((function(){return[f(t,{onClick:_},{default:d((function(){return[ie]})),_:1})]})),_:1},8,["modelValue"]),f(t,{class:"cp mb-10",onClick:b,type:"primary"},{default:d((function(){return[ce]})),_:1}),f(t,{class:"cp mb-10",onClick:V,type:"primary"},{default:d((function(){return[se]})),_:1})]),g(" table "),s("div",fe,[f(a,{data:v(m),class:"w100",height:"400px",border:""},{default:d((function(){return[f(l,{label:"site_id",align:"center"},{default:d((function(e){return[s("div",null,[s("span",null,w(e.row),1)])]})),_:1}),f(l,{label:"设置",align:"center"},{default:d((function(e){return[s("div",de,[f(t,{type:"danger",icon:"Delete",circle:"",onClick:function(r){return function(e){var r=e.$index;e.row,p.ruleForm.site_value.splice(r,1)}(e)}},null,8,["onClick"])])]})),_:1})]})),_:1},8,["data"])]),g(" dialog "),f(y,{modelValue:v(u),"onUpdate:modelValue":r[2]||(r[2]=function(e){return k(u)?u.value=e:u=e}),title:"site",width:"60%"},{default:d((function(){return[f(le,{visible:v(u),"onUpdate:visible":r[1]||(r[1]=function(e){return k(u)?u.value=e:u=e}),onUploadData:x},null,8,["visible"])]})),_:1},8,["modelValue"])])}}}),me=Z(pe,[["__scopeId","data-v-661f6240"]]),_e={class:"content-con flex column"},ve={class:"flex jc-start ai-center form-one"},ge=["textContent"],be={class:"flex jc-start ai-center form-one"},ye=["textContent"],he={class:"flex jc-start ai-center form-one"},Fe={class:"ml-10"},we={class:"flex jc-start ai-center form-one"},ke={class:"ml-10"},Ve={class:"flex jc-start ai-center form-one"},xe=b("默认"),je=b("自定义"),Ue={class:"ml-10"},Ce={class:"flex jc-start ai-center form-one"},Pe={class:"flex jc-start ai-center form-one"},qe={class:"ml-10"},Oe={class:"flex jc-start ai-center form-one"},Se={class:"flex jc-start ai-center form-one"},Re={class:"w100 flex"},Ae=b(" 提交 "),De=t({props:{msg:{require:!0,default:function(){return{}},type:Object}},emits:["update:visible","updateData"],setup:function(e,r){var t=r.emit,l=e,u=y(),p="必填项",m=function(e,r,t){r?t(r.split(",").length>1e3?new Error("site value 的值不可大于1000个"):void 0):t(void 0)},F=n({offer_id:[{required:!0,message:p,trigger:["blur","change"]}],adv_offer:[{required:!0,message:p,trigger:["blur","change"]}],status_day:[{required:!0,message:p,trigger:["blur","change"]}],day_limit:[{required:!0,message:p,trigger:["blur","change"]},{validator:function(e,r,t){r?parseInt(r)===parseFloat(r)?Number(r)>5?t(void 0):t(new Error("必须为大于5的整数")):t(new Error("必须为整数")):t(void 0)},trigger:["blur","change"]}],day_limit_type:[{required:!0,message:p,trigger:["blur","change"]}],day_limit_value:[{required:!0,message:p,trigger:["blur","change"]}],status_hour:[{required:!0,message:p,trigger:["blur","change"]}],site_value_required:[{required:!0,message:p,trigger:["blur","change"]},{validator:m,trigger:["blur","change"]}],site_value_no_required:[{required:!1,message:p,trigger:["blur","change"]},{validator:m,trigger:["blur","change"]}]}),V=n({ruleForm:{offer_id:"",adv_offer:"",channel_type:2,status_day:2,day_limit:15,day_limit_type:1,day_limit_value:"",status_hour:2,site_value:""}}),x=h((function(){return V.ruleForm.site_value?V.ruleForm.site_value.split(",").length:0})),U=h((function(){return"rule_value"===l.msg.site_type}));a((function(){return l.msg}),(function(e,r){var t=l.msg.fenix_site,n=t.status_day||2,a=t.status_hour||2;2===l.msg.channel_type&&(n=2,a=2),V.ruleForm={offer_id:t.offer_id||l.msg.offer_id,adv_offer:t.adv_offer||l.msg.adv_offer,channel_type:l.msg.channel_type,status_day:n,day_limit:t.day_limit||15,day_limit_type:t.day_limit_type||1,day_limit_value:t.day_limit_value||"",status_hour:a,site_value:l.msg.site_value}}),{deep:!0,immediate:!0});var C=function(){t("updateData",V.ruleForm),t("update:visible",!1)};return function(e,r){var t=o("el-form-item"),n=o("el-switch"),a=o("info-filled"),p=o("el-icon"),m=o("el-tooltip"),y=o("el-input"),h=o("el-radio"),P=o("el-radio-group"),q=o("el-form"),O=o("el-button");return i(),c("div",null,[f(q,{ref_key:"ruleFormRef",ref:u,enctype:"multipart/form-data",rules:v(F),model:v(V).ruleForm,"label-width":"150px","label-position":"right"},{default:d((function(){return[s("div",_e,[g(" Offer "),f(t,{label:"Offer:",prop:"offer_id"},{default:d((function(){return[s("div",ve,[s("span",{textContent:w(v(V).ruleForm.offer_id)},null,8,ge)])]})),_:1}),g(" Offer "),f(t,{label:"Adv Offer:",prop:"adv_offer"},{default:d((function(){return[s("div",be,[s("span",{textContent:w(v(V).ruleForm.adv_offer)},null,8,ye)])]})),_:1}),g(" Offer "),f(t,{label:"分天优选:",prop:"status_day"},{default:d((function(){return[s("div",he,[f(n,{disabled:2==l.msg.channel_type,modelValue:v(V).ruleForm.status_day,"onUpdate:modelValue":r[0]||(r[0]=function(e){return v(V).ruleForm.status_day=e}),"active-value":1,"inactive-value":2},null,8,["disabled","modelValue"]),s("span",Fe,[f(m,{content:"根据昨天数据筛选符合条件的site_id使用",placement:"right-start"},{default:d((function(){return[f(p,null,{default:d((function(){return[f(a)]})),_:1})]})),_:1})])])]})),_:1}),f(t,{label:"分天优选启动条件:",prop:"day_limit"},{default:d((function(){return[s("div",we,[f(y,{modelValue:v(V).ruleForm.day_limit,"onUpdate:modelValue":r[1]||(r[1]=function(e){return v(V).ruleForm.day_limit=e}),placeholder:"默认值为15",min:"5",step:"1",class:"input-with-select",type:"number"},null,8,["modelValue"]),s("span",ke,[f(m,{content:"当昨天site_id的平均install数大于等于设定值时才启动自动优选，默认设置为15",placement:"bottom"},{default:d((function(){return[f(p,null,{default:d((function(){return[f(a)]})),_:1})]})),_:1})])])]})),_:1}),f(t,{label:"分天优选install限制:",prop:"day_limit_type"},{default:d((function(){return[s("div",Ve,[f(P,{class:"flex",modelValue:v(V).ruleForm.day_limit_type,"onUpdate:modelValue":r[2]||(r[2]=function(e){return v(V).ruleForm.day_limit_type=e})},{default:d((function(){return[f(h,{label:1},{default:d((function(){return[xe]})),_:1}),f(h,{label:2},{default:d((function(){return[je]})),_:1})]})),_:1},8,["modelValue"]),s("span",Ue,[f(m,{content:"根据site_id的install数筛选，仅使用大于等于设定值的site_id，默认值为昨天均值除以5",placement:"right-start"},{default:d((function(){return[f(p,null,{default:d((function(){return[f(a)]})),_:1})]})),_:1})])])]})),_:1}),2===v(V).ruleForm.day_limit_type?(i(),_(t,{key:0,label:"分天优选install限制值:",prop:"day_limit_value"},{default:d((function(){return[s("div",Ce,[f(y,{type:"number",modelValue:v(V).ruleForm.day_limit_value,"onUpdate:modelValue":r[3]||(r[3]=function(e){return v(V).ruleForm.day_limit_value=e}),placeholder:"",class:"input-with-select"},null,8,["modelValue"])])]})),_:1})):g("v-if",!0),f(t,{label:"分时优选:",prop:"status_hour"},{default:d((function(){return[s("div",Pe,[f(n,{disabled:2==l.msg.channel_type,modelValue:v(V).ruleForm.status_hour,"onUpdate:modelValue":r[4]||(r[4]=function(e){return v(V).ruleForm.status_hour=e}),"active-value":1,"inactive-value":2},null,8,["disabled","modelValue"]),s("span",qe,[f(m,{content:"根据前6小时和前2小时数据筛选符合条件的site_id使用，暂不支持自定义",placement:"right-start"},{default:d((function(){return[f(p,null,{default:d((function(){return[f(a)]})),_:1})]})),_:1})])])]})),_:1}),f(t,{label:"当前渠道数:",prop:"site_value",rules:v(U)?v(F).site_value_required:v(F).site_value_no_required},{default:d((function(){return[s("div",Oe,[f(y,{type:"hidden",modelValue:v(x),"onUpdate:modelValue":r[5]||(r[5]=function(e){return k(x)?x.value=e:null}),disabled:""},null,8,["modelValue"]),b(" "+w(v(x)),1)])]})),_:1},8,["rules"]),f(t,{label:""},{default:d((function(){return[s("div",Se,[f(me,{msg:v(V).ruleForm.site_value,"onUpdate:msg":r[6]||(r[6]=function(e){return v(V).ruleForm.site_value=e})},null,8,["msg"])])]})),_:1}),g(" end ")])]})),_:1},8,["rules","model"]),g(" form "),g(" footer "),s("div",Re,[f(O,{type:"primary",onClick:r[7]||(r[7]=j((function(e){var r;(r=u.value)&&r.validate((function(e){if(!e)return!1;C()}))}),["prevent"]))},{default:d((function(){return[Ae]})),_:1})])])}}}),Te={class:"content-con flex column"},Ee={class:"flex jc-start ai-center form-one"},Ne=["textContent"],Le={class:"flex jc-start ai-center form-one"},ze=b(" BUZZ "),Me=b(" SDK "),Ie={class:"flex jc-start ai-center form-one"},Ke={key:0},$e={key:1},Be={class:"flex jc-start ai-center form-one"},Je={class:"flex jc-start ai-center form-one"},Ze={class:"flex jc-start ai-center form-one"},He={class:"flex jc-start ai-center form-one"},Ge={class:"flex jc-start ai-center form-one"},Qe={class:"form-one"},We={class:"flex jc-start ai-center form-one"},Xe={class:"flex jc-start ai-center form-one"},Ye={class:"flex jc-start ai-center form-one"},er={class:"form-one"},rr={class:"flex ai-center jc-start mb-10"},tr={class:"text-wrap"},nr={class:"flex jc-start ai-center form-one"},lr={class:"flex jc-start ai-center form-one"},ar={class:"flex jc-start ai-center form-one"},ur={class:"flex jc-start ai-center form-one"},or={class:"w100 flex"},ir=b(" Save "),cr=t({setup:function(e){var t=S().proxy,b=U(),F="此项必填",V={id:void 0,offer_id:"",adv_offer:"",create_type:1,channel:"",channel_type:1,adv_status:1,conversion_flow:void 0,status:1,title:"",pkg:"",attribute_provider:"",pid:"",platform:1,country:[],revenue:void 0,traffic:[],adtype:38,update_date:"",adv_tracking_link:"",target_cvr:void 0,cvr_status:2,is_s2s:2,s2s_tracking_link:"",app_url:"",site_type:"rule_value",site_value:"",description:"",fenix_site:{}},x=y(!1),A=n({options:{channel:[{id:"",short_name:""}],country:[{id:"",short_name:"",zh_cn:""}],conversion_flow:[{value:1,label:"CPI"},{value:2,label:"CPA"},{value:9,label:"SDK"}],platform:[{value:1,label:"Android"},{value:2,label:"iOS"}],site_type:[{value:"rule_sdkindex",label:"匹配SDK自定义"},{value:"rule_pubredirect",label:"透传渠道ID"},{value:"rule_slotid",label:"渠道slotid"},{value:"rule_value",label:"固定值"}],attribute_provider:[{value:"AppsFlyer",label:"AppsFlyer"},{value:"Branch",label:"Branch"},{value:"Adjust",label:"Adjust"},{value:"Singular",label:"Singular"},{value:"AppMetrica",label:"AppMetrica"}]},rules:{no_required:[{required:!1}],channel:[{required:!0,message:F,trigger:["blur","change"]}],channel_type:[{required:!0,message:F,trigger:["blur","change"]}],status:[{required:!0,message:F,trigger:["blur","change"]}],title:[{required:!0,message:F,trigger:["blur","change"]}],pkg:[{required:!0,message:F,trigger:["blur","change"]}],platform:[{required:!0,message:F,trigger:["blur","change"]}],country:[{required:!0,message:F,trigger:["blur","change"]},{validator:function(e,r,t){0!==r.length?r.length>1?t(new Error("只能填选一个国家")):t(void 0):t(new Error(F))},trigger:["blur","change"]}],revenue:[{required:!0,message:F,trigger:["blur","change"]}],traffic:[{required:!1,validator:function(e,r,t){var n;0!==r.length?(n=!0,r.map((function(e){for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){var t=e[r];if((""===t||void 0===t)&&0!==t){n=!1;break}}})),t(n?void 0:new Error("不允许有空值"))):t(void 0)},trigger:["blur","change"]}],adv_tracking_link:[{required:!0,message:F,trigger:["blur","change"]}],site_type:[{required:!0,message:F,trigger:["blur","change"]}],site_value:[{required:!0,message:F,trigger:["blur","change"]},{validator:function(e,r,t){r?t(r.split(",").length>1e3?new Error("site value 的值不可大于1000个"):void 0):t(void 0)},trigger:["blur","change"]}],is_s2s:[{required:!0,message:F,trigger:["blur","change"]}],s2s_tracking_link:[{required:!0,message:F,trigger:["blur","change"]}],app_url:[{required:!0,message:F,trigger:["blur","change"]}]},ruleForm:V,search:{adv_offer:""}}),K=y(""),B=y(""),J=y(""),Z=y(!1),H=function(e){var t=[];return e.map((function(e){var n=r({},e);return e.payout&&(n.payout=Number(e.payout)),e.cap_daily&&(n.cap_daily=Number(e.cap_daily)),t.push(n),e})),t},G=function(){var e=l(regeneratorRuntime.mark((function e(){var t,n,l,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(x.value=!0,t=R.cloneDeep(A.ruleForm),n=r({},t),t.conversion_flow&&(n.conversion_flow=t.conversion_flow),n.country=t.country[0],n.revenue=parseFloat(n.revenue),n.target_cvr=parseFloat(n.target_cvr),n.fenix_site.day_limit&&(n.fenix_site.day_limit=parseFloat(n.fenix_site.day_limit)),n.fenix_site.day_limit_value?n.fenix_site.day_limit_value=parseFloat(n.fenix_site.day_limit_value):delete n.fenix_site.day_limit_value,0!==t.traffic.length?(l=H(t.traffic),n.traffic=JSON.stringify(l)):delete n.traffic,"create"!==J.value){e.next=14;break}return e.next=13,M(n);case 13:a=e.sent;case 14:if("edit"!==J.value){e.next=18;break}return e.next=17,I(n);case 17:a=e.sent;case 18:x.value=!1,$(a)&&window.close();case 20:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q=function(){Z.value=!0},W=function(){t.$refs.ruleForm.validate((function(e){if(!e)return!1;G()}))},Y=function(){var e=l(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T();case 2:200===(r=e.sent).code?(t=r.offer_id,A.ruleForm.offer_id=t.toString()):Y();case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ee=function(){var e=l(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([te(),ne()]);case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=h((function(){return A.ruleForm.site_value?A.ruleForm.site_value.split(",").length:0})),te=function(){var e=l(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E();case 2:return r=e.sent,t=r.data,A.options.channel=t,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=l(regeneratorRuntime.mark((function e(){var r,t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N();case 2:return r=e.sent,t=r.data,A.options.country=t,e.abrupt("return",t);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();n({ruleForm:V}),u(l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:le();case 1:case"end":return e.stop()}}),e)}))));var le=function(){var e=l(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return K.value=b.currentRoute.value.name,B.value=b.currentRoute.value.params.id,"fenix-offer-create"===K.value&&(Y(),J.value="create"),"fenix-offer-edit"===K.value&&(B.value=b.currentRoute.value.params.id,J.value="edit",ae()),e.next=6,ee();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=l(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(B.value);case 2:t=e.sent,n=t.data,A.ruleForm=r({},n),A.ruleForm.country=[n.country],A.search.adv_offer=n.adv_offer,A.ruleForm.traffic=n.traffic?JSON.parse(n.traffic):[],C(A.ruleForm);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ue=h((function(){return"rule_value"===A.ruleForm.site_type}));a((function(){return A.ruleForm.traffic}),(function(e,r){}),{immediate:!0,deep:!0}),a((function(){return A.ruleForm.adv_offer}),(function(e,r){A.ruleForm.create_type=e?2:1}),{immediate:!0,deep:!0});var oe=function(e){},ie=function(){var e=l(regeneratorRuntime.mark((function e(){var r,t,n,l,a,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("edit"!==J.value){e.next=2;break}return e.abrupt("return",!1);case 2:if(A.ruleForm.adv_offer=A.search.adv_offer,r=A.ruleForm.adv_offer){e.next=7;break}return e.abrupt("return",!1);case 7:if(t={adv_offer:r,platform:A.ruleForm.platform},!r||!r.includes("_")){e.next=19;break}return A.ruleForm.channel_type=2,A.ruleForm.adtype=39,e.next=14,L(t);case 14:n=e.sent,l=n.data,200===n.status?(A.ruleForm.adv_status=1,se(l)):A.ruleForm.adv_status=2,e.next=29;break;case 19:return A.ruleForm.channel_type=1,A.ruleForm.adtype=38,e.next=24,z(t);case 24:a=e.sent,u=a.data,A.ruleForm.adv_status=u.status,ce(u);case 29:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ce=function(e){A.ruleForm.channel=e.channel,A.ruleForm.attribute_provider=e.attribute_provider,A.ruleForm.conversion_flow=e.conversion_flow,A.ruleForm.title=e.title,A.ruleForm.pkg=e.pkg_name,A.ruleForm.pid=e.pid,A.ruleForm.platform=e.platform,A.ruleForm.revenue=e.payout,A.ruleForm.adv_tracking_link=e.tracking_link,fe(e.country)},se=function(e){var r;A.ruleForm.pkg=e.app_pkg_name,A.ruleForm.channel=e.channel,A.ruleForm.country=e.country;var t=null===(r=A.options.platform.find((function(r){return r.label===e.platform})))||void 0===r?void 0:r.value;A.ruleForm.platform=t||1,A.ruleForm.revenue=e.revenue,A.ruleForm.title=e.title,A.ruleForm.adv_tracking_link=e.tracking_link,A.ruleForm.conversion_flow=9},fe=function(e){Array.isArray(e)?A.ruleForm.country=e:A.ruleForm.country=[e]},de=function(e){e.site_value.length,A.ruleForm.site_value=e.site_value,A.ruleForm.fenix_site=C(e)};return function(e,r){var t=o("el-form-item"),n=o("el-button"),l=o("el-input"),a=o("el-option"),u=o("el-select"),b=o("el-radio"),y=o("el-radio-group"),h=o("el-switch"),F=o("el-form"),V=o("el-dialog"),U=P("loading");return q((i(),c("div",null,[g(" form "),f(F,{ref:"ruleForm",enctype:"multipart/form-data",rules:v(A).rules,model:v(A).ruleForm,"label-width":"240px","label-position":"right"},{default:d((function(){return[s("div",Te,[g(" Offer "),f(t,{label:"Offer:",prop:"offer"},{default:d((function(){return[s("div",Ee,[s("span",{textContent:w(v(A).ruleForm.offer_id)},null,8,Ne)])]})),_:1}),g(" Adv Offer "),f(t,{label:"Adv Offer:",prop:"adv_offer"},{default:d((function(){return[s("div",Le,[f(l,{modelValue:v(A).search.adv_offer,"onUpdate:modelValue":r[0]||(r[0]=function(e){return v(A).search.adv_offer=e}),placeholder:"Please input",class:"input-with-select",disabled:"edit"===v(J)},O({_:2},["create"===v(J)?{name:"append",fn:d((function(){return[f(n,{type:"primary",icon:"Search",onClick:ie})]}))}:void 0]),1032,["modelValue","disabled"])])]})),_:1}),g(" Channel "),f(t,{label:"Channel:",prop:"channel"},{default:d((function(){return[f(u,{modelValue:v(A).ruleForm.channel,"onUpdate:modelValue":r[1]||(r[1]=function(e){return v(A).ruleForm.channel=e}),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:d((function(){return[(i(!0),c(p,null,m(v(A).options.channel,(function(e){return i(),_(a,{key:e.id,label:e.short_name,value:e.short_name},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),g(" Channel Type "),f(t,{label:"Channel Type:",prop:"channel_type"},{default:d((function(){return[f(y,{modelValue:v(A).ruleForm.channel_type,"onUpdate:modelValue":r[2]||(r[2]=function(e){return v(A).ruleForm.channel_type=e}),class:"form-one"},{default:d((function(){return[f(b,{label:1},{default:d((function(){return[ze]})),_:1}),f(b,{label:2},{default:d((function(){return[Me]})),_:1})]})),_:1},8,["modelValue"])]})),_:1}),g(" Adv Status "),f(t,{label:"Adv Status:",prop:"adv_status"},{default:d((function(){return[s("div",Ie,[1===v(A).ruleForm.adv_status?(i(),c("span",Ke,"开")):g("v-if",!0),2===v(A).ruleForm.adv_status?(i(),c("span",$e,"关")):g("v-if",!0)])]})),_:1}),g(" conversion_flow "),f(t,{label:"Conversion Flow:",prop:"conversion_flow"},{default:d((function(){return[f(u,{modelValue:v(A).ruleForm.conversion_flow,"onUpdate:modelValue":r[3]||(r[3]=function(e){return v(A).ruleForm.conversion_flow=e}),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:d((function(){return[(i(!0),c(p,null,m(v(A).options.conversion_flow,(function(e){return i(),_(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),g(" Status "),f(t,{label:"Status:",prop:"status"},{default:d((function(){return[s("div",Be,[f(h,{modelValue:v(A).ruleForm.status,"onUpdate:modelValue":r[4]||(r[4]=function(e){return v(A).ruleForm.status=e}),"active-value":1,"inactive-value":2},null,8,["modelValue"])])]})),_:1}),g(" Offer Title "),f(t,{label:"Offer Title:",prop:"title"},{default:d((function(){return[s("div",Je,[f(l,{modelValue:v(A).ruleForm.title,"onUpdate:modelValue":r[5]||(r[5]=function(e){return v(A).ruleForm.title=e}),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" Package Name "),f(t,{label:"Package Name:",prop:"pkg"},{default:d((function(){return[s("div",Ze,[f(l,{modelValue:v(A).ruleForm.pkg,"onUpdate:modelValue":r[6]||(r[6]=function(e){return v(A).ruleForm.pkg=e}),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" Attribute Provider "),f(t,{label:"Attribute Provider:",prop:"attribute_provider"},{default:d((function(){return[f(u,{modelValue:v(A).ruleForm.attribute_provider,"onUpdate:modelValue":r[7]||(r[7]=function(e){return v(A).ruleForm.attribute_provider=e}),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:d((function(){return[(i(!0),c(p,null,m(v(A).options.attribute_provider,(function(e){return i(),_(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),g(" Pid "),f(t,{label:"Pid:",prop:"pid"},{default:d((function(){return[s("div",He,[f(l,{modelValue:v(A).ruleForm.pid,"onUpdate:modelValue":r[8]||(r[8]=function(e){return v(A).ruleForm.pid=e}),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" Platform "),f(t,{label:"Platform:",prop:"platform"},{default:d((function(){return[f(u,{modelValue:v(A).ruleForm.platform,"onUpdate:modelValue":r[9]||(r[9]=function(e){return v(A).ruleForm.platform=e}),filterable:"",class:"form-one",placeholder:""},{default:d((function(){return[(i(!0),c(p,null,m(v(A).options.platform,(function(e){return i(),_(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),g(" Country "),f(t,{label:"Country:",prop:"country"},{default:d((function(){return[f(u,{modelValue:v(A).ruleForm.country,"onUpdate:modelValue":r[10]||(r[10]=function(e){return v(A).ruleForm.country=e}),filterable:"",class:"form-one",multiple:"",clearable:"",placeholder:""},{default:d((function(){return[(i(!0),c(p,null,m(v(A).options.country,(function(e){return i(),_(a,{key:e.id,label:e.short_name+"-"+e.zh_cn,value:e.short_name},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),g(" Revenue "),f(t,{label:"Revenue:",prop:"revenue"},{default:d((function(){return[s("div",Ge,[f(l,{modelValue:v(A).ruleForm.revenue,"onUpdate:modelValue":r[11]||(r[11]=function(e){return v(A).ruleForm.revenue=e}),placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" Manage Traffic "),f(t,{label:"Manage Traffic:",prop:"traffic"},{default:d((function(){return[s("div",Qe,[f(v(X),{ref:"traffic",list:v(A).ruleForm.traffic,"onUpdate:list":r[12]||(r[12]=function(e){return v(A).ruleForm.traffic=e}),offer:v(A).ruleForm.offer_id,onKk:oe},null,8,["list","offer"])])]})),_:1}),g(" Adv Tracking Link "),f(t,{label:"Adv Tracking Link:",prop:"adv_tracking_link"},{default:d((function(){return[s("div",We,[f(l,{modelValue:v(A).ruleForm.adv_tracking_link,"onUpdate:modelValue":r[13]||(r[13]=function(e){return v(A).ruleForm.adv_tracking_link=e}),rows:4,autosize:"",type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" Target CVR "),f(t,{label:"Target CVR:",prop:"target_cvr"},{default:d((function(){return[s("div",Xe,[f(l,{modelValue:v(A).ruleForm.target_cvr,"onUpdate:modelValue":r[14]||(r[14]=function(e){return v(A).ruleForm.target_cvr=e}),type:"number",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" CVR Status "),f(t,{label:"CVR Status:",prop:"cvr_status"},{default:d((function(){return[s("div",Ye,[f(h,{modelValue:v(A).ruleForm.cvr_status,"onUpdate:modelValue":r[15]||(r[15]=function(e){return v(A).ruleForm.cvr_status=e}),"active-value":1,"inactive-value":2},null,8,["modelValue"])])]})),_:1}),g(" Site Type "),f(t,{label:"Site Type:",prop:"site_type"},{default:d((function(){return[f(u,{modelValue:v(A).ruleForm.site_type,"onUpdate:modelValue":r[16]||(r[16]=function(e){return v(A).ruleForm.site_type=e}),filterable:"",class:"form-one",clearable:"",placeholder:""},{default:d((function(){return[(i(!0),c(p,null,m(v(A).options.site_type,(function(e){return i(),_(a,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])})),128))]})),_:1},8,["modelValue"])]})),_:1}),g(" Site Value "),f(t,{label:"Site Value:",prop:"site_value",rules:v(ue)?v(A).rules.site_value:v(A).rules.no_required},{default:d((function(){return[s("div",er,[s("div",rr,[f(n,{class:"cp mr-10",icon:"Tools",circle:"",onClick:Q}),s("span",null,w(v(re)),1)]),s("div",null,[g(' <el-input\n                v-model="state.ruleForm.site_value"\n                type="textarea"\n                autosize\n                :rows="4"\n                placeholder="Please input"\n                class="input-with-select siteValue"\n              /> '),s("p",tr,w(v(A).ruleForm.site_value),1)])])]})),_:1},8,["rules"]),g(" S2S Async "),f(t,{label:"S2S Async:",prop:"is_s2s"},{default:d((function(){return[s("div",nr,[f(h,{modelValue:v(A).ruleForm.is_s2s,"onUpdate:modelValue":r[17]||(r[17]=function(e){return v(A).ruleForm.is_s2s=e}),"active-value":1,"inactive-value":2},null,8,["modelValue"])])]})),_:1}),g(" S2S Tracking Link "),f(t,{label:"S2S Tracking Link:",prop:"s2s_tracking_link",rules:1===v(A).ruleForm.is_s2s?v(A).rules.s2s_tracking_link:v(A).rules.no_required},{default:d((function(){return[s("div",lr,[f(l,{modelValue:v(A).ruleForm.s2s_tracking_link,"onUpdate:modelValue":r[18]||(r[18]=function(e){return v(A).ruleForm.s2s_tracking_link=e}),rows:2,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1},8,["rules"]),g(" Preview URL "),f(t,{label:"Preview URL:",prop:"app_url",rules:1===v(A).ruleForm.is_s2s?v(A).rules.app_url:v(A).rules.no_required},{default:d((function(){return[s("div",ar,[f(l,{modelValue:v(A).ruleForm.app_url,"onUpdate:modelValue":r[19]||(r[19]=function(e){return v(A).ruleForm.app_url=e}),rows:2,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1},8,["rules"]),g(" Description "),f(t,{label:"Description:",prop:"description"},{default:d((function(){return[s("div",ur,[f(l,{modelValue:v(A).ruleForm.description,"onUpdate:modelValue":r[20]||(r[20]=function(e){return v(A).ruleForm.description=e}),rows:2,type:"textarea",placeholder:"Please input",class:"input-with-select"},null,8,["modelValue"])])]})),_:1}),g(" end ")])]})),_:1},8,["rules","model"]),g(" form "),g(" footer "),s("div",or,[f(n,{type:"primary",onClick:j(W,["prevent"])},{default:d((function(){return[ir]})),_:1},8,["onClick"])]),g(" dialog "),f(V,{modelValue:v(Z),"onUpdate:modelValue":r[22]||(r[22]=function(e){return k(Z)?Z.value=e:Z=e}),title:"site",width:"70%"},{default:d((function(){return[f(De,{msg:v(A).ruleForm,onUpdateData:de,visible:v(Z),"onUpdate:visible":r[21]||(r[21]=function(e){return k(Z)?Z.value=e:Z=e})},null,8,["msg","visible"])]})),_:1},8,["modelValue"])])),[[U,v(x)]])}}});e("default",Z(cr,[["__scopeId","data-v-2659fc52"]]))}}}))}();
